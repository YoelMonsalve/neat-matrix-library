<!DOCTYPE html>
<!-- saved from url=(0087)https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c -->
<html lang="en" class=" js "><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style>
    

<!-- begin _includes/seo.html --><title>Writing your own linear algebra matrix library in C | andreinc</title>
<meta name="description" content="A step-by-step guide on how to implement a matrix library in pure C.">


  <meta name="author" content="Andrei Ciobanu">
  
  <meta property="article:author" content="Andrei Ciobanu">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="andreinc">
<meta property="og:title" content="Writing your own linear algebra matrix library in C">
<meta property="og:url" content="/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c">


  <meta property="og:description" content="A step-by-step guide on how to implement a matrix library in pure C.">







  <meta property="article:published_time" content="2021-01-20T00:00:00+00:00">






<link rel="canonical" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="https://www.andreinc.net/feed.xml" type="application/atom+xml" rel="alternate" title="andreinc Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="./Writing your own linear algebra matrix library in C _ andreinc_files/main.css">
<link rel="stylesheet" href="./Writing your own linear algebra matrix library in C _ andreinc_files/all.min.css" as="style" onload="this.onload=null;this.rel=&#39;stylesheet&#39;">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    
<script src="./Writing your own linear algebra matrix library in C _ andreinc_files/MathJax.js" id="">
</script>


<!-- Default Statcounter code for Andreinc.net
http://www.andreinc.net -->
<script type="text/javascript">
var sc_project=7153286;
var sc_invisible=0;
var sc_security="b3053c1d";
var scJsHost = "https://";
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script><script type="text/javascript" src="./Writing your own linear algebra matrix library in C _ andreinc_files/counter.js"></script><span class="statcounter"><a id="sc_counter_7153286" class="statcounter" href="https://www.statcounter.com/" target="_blank"><img src="data:image/gif;base64,R0lGODlhAQABAJH/AP///wAAAMDAwAAAACH5BAEAAAIALAAAAAABAAEAAAICVAEAOw==" alt="StatCounter - Free Web Tracker and Counter" border="0" undefined=""></a></span>
<noscript><div class="statcounter"><a title="Web Analytics"
                                      href="https://statcounter.com/" target="_blank"><img
        class="statcounter"
        src="https://c.statcounter.com/7153286/0/b3053c1d/0/"
        alt="Web Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->
  <style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.mjx-chtml {display: inline-block; line-height: 0; text-indent: 0; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; margin: 0; padding: 1px 0}
.MJXc-display {display: block; text-align: center; margin: 1em 0; padding: 0}
.mjx-chtml[tabindex]:focus, body :focus .mjx-chtml[tabindex] {display: inline-table}
.mjx-full-width {text-align: center; display: table-cell!important; width: 10000em}
.mjx-math {display: inline-block; border-collapse: separate; border-spacing: 0}
.mjx-math * {display: inline-block; -webkit-box-sizing: content-box!important; -moz-box-sizing: content-box!important; box-sizing: content-box!important; text-align: left}
.mjx-numerator {display: block; text-align: center}
.mjx-denominator {display: block; text-align: center}
.MJXc-stacked {height: 0; position: relative}
.MJXc-stacked > * {position: absolute}
.MJXc-bevelled > * {display: inline-block}
.mjx-stack {display: inline-block}
.mjx-op {display: block}
.mjx-under {display: table-cell}
.mjx-over {display: block}
.mjx-over > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-under > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-stack > .mjx-sup {display: block}
.mjx-stack > .mjx-sub {display: block}
.mjx-prestack > .mjx-presup {display: block}
.mjx-prestack > .mjx-presub {display: block}
.mjx-delim-h > .mjx-char {display: inline-block}
.mjx-surd {vertical-align: top}
.mjx-mphantom * {visibility: hidden}
.mjx-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 2px 3px; font-style: normal; font-size: 90%}
.mjx-annotation-xml {line-height: normal}
.mjx-menclose > svg {fill: none; stroke: currentColor}
.mjx-mtr {display: table-row}
.mjx-mlabeledtr {display: table-row}
.mjx-mtd {display: table-cell; text-align: center}
.mjx-label {display: table-row}
.mjx-box {display: inline-block}
.mjx-block {display: block}
.mjx-span {display: inline}
.mjx-char {display: block; white-space: pre}
.mjx-itable {display: inline-table; width: auto}
.mjx-row {display: table-row}
.mjx-cell {display: table-cell}
.mjx-table {display: table; width: 100%}
.mjx-line {display: block; height: 0}
.mjx-strut {width: 0; padding-top: 1em}
.mjx-vsize {width: 0}
.MJXc-space1 {margin-left: .167em}
.MJXc-space2 {margin-left: .222em}
.MJXc-space3 {margin-left: .278em}
.mjx-chartest {display: block; visibility: hidden; position: absolute; top: 0; line-height: normal; font-size: 500%}
.mjx-chartest .mjx-char {display: inline}
.mjx-chartest .mjx-box {padding-top: 1000px}
.MJXc-processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MJXc-processed {display: none}
.mjx-test {display: block; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.mjx-ex-box-test {position: absolute; width: 1px; height: 60ex}
.mjx-line-box-test {display: table!important}
.mjx-line-box-test span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
#MathJax_CHTML_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.mjx-chtml .mjx-noError {line-height: 1.2; vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
.MJXc-TeX-unknown-R {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: normal}
.MJXc-TeX-unknown-I {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: normal}
.MJXc-TeX-unknown-B {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: bold}
.MJXc-TeX-unknown-BI {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: bold}
.MJXc-TeX-ams-R {font-family: MJXc-TeX-ams-R,MJXc-TeX-ams-Rw}
.MJXc-TeX-cal-B {font-family: MJXc-TeX-cal-B,MJXc-TeX-cal-Bx,MJXc-TeX-cal-Bw}
.MJXc-TeX-frak-R {font-family: MJXc-TeX-frak-R,MJXc-TeX-frak-Rw}
.MJXc-TeX-frak-B {font-family: MJXc-TeX-frak-B,MJXc-TeX-frak-Bx,MJXc-TeX-frak-Bw}
.MJXc-TeX-math-BI {font-family: MJXc-TeX-math-BI,MJXc-TeX-math-BIx,MJXc-TeX-math-BIw}
.MJXc-TeX-sans-R {font-family: MJXc-TeX-sans-R,MJXc-TeX-sans-Rw}
.MJXc-TeX-sans-B {font-family: MJXc-TeX-sans-B,MJXc-TeX-sans-Bx,MJXc-TeX-sans-Bw}
.MJXc-TeX-sans-I {font-family: MJXc-TeX-sans-I,MJXc-TeX-sans-Ix,MJXc-TeX-sans-Iw}
.MJXc-TeX-script-R {font-family: MJXc-TeX-script-R,MJXc-TeX-script-Rw}
.MJXc-TeX-type-R {font-family: MJXc-TeX-type-R,MJXc-TeX-type-Rw}
.MJXc-TeX-cal-R {font-family: MJXc-TeX-cal-R,MJXc-TeX-cal-Rw}
.MJXc-TeX-main-B {font-family: MJXc-TeX-main-B,MJXc-TeX-main-Bx,MJXc-TeX-main-Bw}
.MJXc-TeX-main-I {font-family: MJXc-TeX-main-I,MJXc-TeX-main-Ix,MJXc-TeX-main-Iw}
.MJXc-TeX-main-R {font-family: MJXc-TeX-main-R,MJXc-TeX-main-Rw}
.MJXc-TeX-math-I {font-family: MJXc-TeX-math-I,MJXc-TeX-math-Ix,MJXc-TeX-math-Iw}
.MJXc-TeX-size1-R {font-family: MJXc-TeX-size1-R,MJXc-TeX-size1-Rw}
.MJXc-TeX-size2-R {font-family: MJXc-TeX-size2-R,MJXc-TeX-size2-Rw}
.MJXc-TeX-size3-R {font-family: MJXc-TeX-size3-R,MJXc-TeX-size3-Rw}
.MJXc-TeX-size4-R {font-family: MJXc-TeX-size4-R,MJXc-TeX-size4-Rw}
@font-face {font-family: MJXc-TeX-ams-R; src: local('MathJax_AMS'), local('MathJax_AMS-Regular')}
@font-face {font-family: MJXc-TeX-ams-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_AMS-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-B; src: local('MathJax_Caligraphic Bold'), local('MathJax_Caligraphic-Bold')}
@font-face {font-family: MJXc-TeX-cal-Bx; src: local('MathJax_Caligraphic'); font-weight: bold}
@font-face {font-family: MJXc-TeX-cal-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-R; src: local('MathJax_Fraktur'), local('MathJax_Fraktur-Regular')}
@font-face {font-family: MJXc-TeX-frak-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-B; src: local('MathJax_Fraktur Bold'), local('MathJax_Fraktur-Bold')}
@font-face {font-family: MJXc-TeX-frak-Bx; src: local('MathJax_Fraktur'); font-weight: bold}
@font-face {font-family: MJXc-TeX-frak-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-BI; src: local('MathJax_Math BoldItalic'), local('MathJax_Math-BoldItalic')}
@font-face {font-family: MJXc-TeX-math-BIx; src: local('MathJax_Math'); font-weight: bold; font-style: italic}
@font-face {font-family: MJXc-TeX-math-BIw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Math-BoldItalic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-R; src: local('MathJax_SansSerif'), local('MathJax_SansSerif-Regular')}
@font-face {font-family: MJXc-TeX-sans-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-B; src: local('MathJax_SansSerif Bold'), local('MathJax_SansSerif-Bold')}
@font-face {font-family: MJXc-TeX-sans-Bx; src: local('MathJax_SansSerif'); font-weight: bold}
@font-face {font-family: MJXc-TeX-sans-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-I; src: local('MathJax_SansSerif Italic'), local('MathJax_SansSerif-Italic')}
@font-face {font-family: MJXc-TeX-sans-Ix; src: local('MathJax_SansSerif'); font-style: italic}
@font-face {font-family: MJXc-TeX-sans-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-script-R; src: local('MathJax_Script'), local('MathJax_Script-Regular')}
@font-face {font-family: MJXc-TeX-script-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Script-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-type-R; src: local('MathJax_Typewriter'), local('MathJax_Typewriter-Regular')}
@font-face {font-family: MJXc-TeX-type-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Typewriter-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Typewriter-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Typewriter-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-R; src: local('MathJax_Caligraphic'), local('MathJax_Caligraphic-Regular')}
@font-face {font-family: MJXc-TeX-cal-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-B; src: local('MathJax_Main Bold'), local('MathJax_Main-Bold')}
@font-face {font-family: MJXc-TeX-main-Bx; src: local('MathJax_Main'); font-weight: bold}
@font-face {font-family: MJXc-TeX-main-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-I; src: local('MathJax_Main Italic'), local('MathJax_Main-Italic')}
@font-face {font-family: MJXc-TeX-main-Ix; src: local('MathJax_Main'); font-style: italic}
@font-face {font-family: MJXc-TeX-main-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-R; src: local('MathJax_Main'), local('MathJax_Main-Regular')}
@font-face {font-family: MJXc-TeX-main-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-I; src: local('MathJax_Math Italic'), local('MathJax_Math-Italic')}
@font-face {font-family: MJXc-TeX-math-Ix; src: local('MathJax_Math'); font-style: italic}
@font-face {font-family: MJXc-TeX-math-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size1-R; src: local('MathJax_Size1'), local('MathJax_Size1-Regular')}
@font-face {font-family: MJXc-TeX-size1-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size1-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size2-R; src: local('MathJax_Size2'), local('MathJax_Size2-Regular')}
@font-face {font-family: MJXc-TeX-size2-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size2-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size3-R; src: local('MathJax_Size3'), local('MathJax_Size3-Regular')}
@font-face {font-family: MJXc-TeX-size3-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size3-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size4-R; src: local('MathJax_Size4'), local('MathJax_Size4-Regular')}
@font-face {font-family: MJXc-TeX-size4-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size4-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf') format('opentype')}
</style></head>

  <body class="layout--single wide"><div id="MathJax_Message" style="display: none;"></div>
    <nav class="skip-links">
  <ul>
    <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="https://www.andreinc.net/">
          andreinc
          <span class="site-subtitle">Personal blog of Andrei N. Ciobanu</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="https://www.andreinc.net/">Blog</a>
            </li><li class="masthead__menu-item">
              <a href="https://www.andreinc.net/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="https://www.andreinc.net/favs/">Favs</a>
            </li><li class="masthead__menu-item">
              <a href="https://www.andreinc.net/portfolio/">Portfolio</a>
            </li><li class="masthead__menu-item">
              <a href="https://www.linkedin.com/in/andrei-n-ciobanu-50708611/">CV</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button" count="0">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope="" itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="./Writing your own linear algebra matrix library in C _ andreinc_files/me.jpg" alt="Andrei Ciobanu" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Andrei Ciobanu</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>A random software engineer from Eastern Europe.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope="" itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Bucharest, Romania</span>
        </li>
      

      
        
          
            <li><a href="https://github.com/nomemory" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/andrei-n-ciobanu-50708611/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://open.spotify.com/user/a3dud6s6igdiphj760chzhpxv?si=haRc0m-YQEqrPQVNbGxAEA" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-spotify" aria-hidden="true"></i><span class="label">Spotify</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope="" itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Writing your own linear algebra matrix library in C">
    <meta itemprop="description" content="A step-by-step guide on how to implement a matrix library in pure C.">
    <meta itemprop="datePublished" content="2021-01-20T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Writing your own linear algebra matrix library in C
</h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2021-01-20T00:00:00+00:00">January 20, 2021</time>
      </span>
    

    

    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <h1 id="table-of-contents">Table of Contents<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#table-of-contents" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h1>

<ul>
  <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#disclaimer">Disclaimer</a></li>
  <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#math-math">Math, math</a></li>
  <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#the-library">The library</a></li>
  <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#the-data-nml_matrix">The data: nml_matrix</a>
    <ul>
      <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#allocating--de-allocating-memory-for-the-nml_mat-matrix">Allocating / De-allocating memory for the nml_mat matrix</a>
        <ul>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#creating-a-random-matrix">Creating a random matrix</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#creating-a-square-matrix">Creating a square matrix</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#creating-an-identity-matrix">Creating an identity matrix</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#creating-a-matrix-from-a-file">Creating a matrix from a FILE</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#matrix-methods">Matrix methods</a>
    <ul>
      <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#checking-for-equality">Checking for equality</a></li>
      <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#printing-the-matrix">Printing the matrix</a></li>
      <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#accessing-and-modifying-matrix-elements">Accessing and modifying matrix elements</a>
        <ul>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#retrieving--selecting-a-column">Retrieving / Selecting a column</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#retrieving--selecting-a-row">Retrieving / Selecting a row</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#setting-values">Setting values</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#multiplying-a-row-with-a-scalar">Multiplying a row with a scalar</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#multiplying-a-column-with-a-scalar">Multiplying a column with a scalar</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#adding-two-rows">Adding two rows</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#multiplying-the-matrix-with-a-scalar">Multiplying the matrix with a scalar</a></li>
        </ul>
      </li>
      <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#modifying-the-nml_mat-internal-structure">Modifying the nml_mat internal structure</a>
        <ul>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#removing-a-column">Removing a column</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#removing-a-row">Removing a row</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#swapping-rows">Swapping Rows</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#swapping-columns">Swapping columns</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#horizontal-concatenation-of-two-matrices">Horizontal Concatenation of two matrices</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#vertical-concatenation">Vertical concatenation</a></li>
        </ul>
      </li>
      <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#basic-matrix-operations">Basic Matrix Operations</a>
        <ul>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#add-two-matrices">Add two matrices</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#subtracting-two-matrices">Subtracting two matrices</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#multiplying-two-matrices">Multiplying two matrices</a></li>
        </ul>
      </li>
      <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#row-echelon-form">Row Echelon Form</a>
        <ul>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#example">Example</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#code-implementation">Code implementation</a></li>
        </ul>
      </li>
      <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#reduced-row-echelon-form">Reduced Row Echelon Form</a>
        <ul>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#code-implementation-1">Code Implementation</a></li>
        </ul>
      </li>
      <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#lup-decomposition">LU(P) Decomposition</a>
        <ul>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#the-lup-algorithm-as-an-example">The LU(P) algorithm as an example</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#code-implementation-2">Code implementation</a></li>
        </ul>
      </li>
      <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#solving-linear-systems-of-equations">Solving linear systems of equations</a>
        <ul>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#forward-substitution">Forward substitution</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#backward-substitution">Backward substitution</a></li>
          <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#solving-linear-systems-using-lup-decomposition">Solving linear systems using LU(P) decomposition</a></li>
        </ul>
      </li>
      <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#calculating-the-inverse-of-the-matrix-using-lup-decomposition">Calculating the inverse of the matrix using LU(P) decomposition</a></li>
      <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#calculating-the-determinant-of-the-matrix-using-lup-decomposition">Calculating the determinant of the matrix using LU(P) decomposition</a></li>
      <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#qr-decomposition">QR Decomposition</a></li>
    </ul>
  </li>
  <li><a href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#references">References</a></li>
</ul>

<h1 id="disclaimer">Disclaimer<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#disclaimer" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h1>

<blockquote>
  <p>This article is in an early stage. 
If you see any error in the code or in the mathematical formulas, don’t hesitate to contact me or to create a PR directly.
The article source is on github, link <a href="https://github.com/nomemory/andreinc-site/blob/main/_posts/2021-01-20-writing-your-own-linear-algebra-matrix-library-in-c.md">here</a>.</p>
</blockquote>

<h1 id="math-math">Math, math<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#math-math" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h1>

<p>Linear algebra is the branch of mathematics focused on:</p>
<ul>
  <li>linear equations: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-1-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2" class="mjx-mrow"><span id="MJXc-Node-3" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5" class="mjx-texatom" style=""><span id="MJXc-Node-6" class="mjx-mrow"><span id="MJXc-Node-7" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-8" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-9" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-10" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-11" class="mjx-texatom" style=""><span id="MJXc-Node-12" class="mjx-mrow"><span id="MJXc-Node-13" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-14" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-15" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-16" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-17" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-18" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-19" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-20" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-21" class="mjx-texatom" style=""><span id="MJXc-Node-22" class="mjx-mrow"><span id="MJXc-Node-23" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span id="MJXc-Node-24" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-25" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-26" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-27" class="mjx-texatom" style=""><span id="MJXc-Node-28" class="mjx-mrow"><span id="MJXc-Node-29" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span id="MJXc-Node-30" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-31" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>∗</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>+</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>+</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub><mo>∗</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub><mo>=</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">a_{1}*x_{1} + ... + a_{n}*x_{n} = b</script></li>
  <li>linear maps: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-2-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-32" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-33" class="mjx-mrow"><span id="MJXc-Node-34" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-35" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-36" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-37" class="mjx-texatom" style=""><span id="MJXc-Node-38" class="mjx-mrow"><span id="MJXc-Node-39" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-40" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-41" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-42" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-43" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-44" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-45" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-46" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-47" class="mjx-texatom" style=""><span id="MJXc-Node-48" class="mjx-mrow"><span id="MJXc-Node-49" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span id="MJXc-Node-50" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span><span id="MJXc-Node-51" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.212em; padding-bottom: 0.338em;">→</span></span><span id="MJXc-Node-52" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-53" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-54" class="mjx-texatom" style=""><span id="MJXc-Node-55" class="mjx-mrow"><span id="MJXc-Node-56" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-57" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-58" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-59" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-60" class="mjx-texatom" style=""><span id="MJXc-Node-61" class="mjx-mrow"><span id="MJXc-Node-62" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-63" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-64" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-65" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-66" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-67" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-68" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-69" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-70" class="mjx-texatom" style=""><span id="MJXc-Node-71" class="mjx-mrow"><span id="MJXc-Node-72" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span id="MJXc-Node-73" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-74" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-75" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-76" class="mjx-texatom" style=""><span id="MJXc-Node-77" class="mjx-mrow"><span id="MJXc-Node-78" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">→</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>∗</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>+</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>+</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub><mo>∗</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2">(x_{1},...,x_{n}) \rightarrow a_{1}*x_{1} + ... + a_{n}*x_{n}</script>
    <ul>
      <li>and their representation in <em>vector spaces</em> through matrices;</li>
    </ul>
  </li>
</ul>

<p>A finite set of linear equations with a finite set of variables is called a <strong>system of linear equations</strong> or a <strong>linear system</strong>.</p>

<p>Linear systems are a fundamental part of linear algebra. Historically speaking, the math behind matrix theory has been developed for solving such systems. In the modern context, many real-world problems may be interpreted in terms of matrices and linear systems.</p>

<p>To see the connection between matrices and linear systems of equations, let’s look at the following example:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-3-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; min-width: 9.161em; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;18&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-79" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-80" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -2.632em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-81" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span id="MJXc-Node-82" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-83" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-84" class="mjx-texatom" style=""><span id="MJXc-Node-85" class="mjx-mrow"><span id="MJXc-Node-86" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-87" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-88" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-89" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-90" class="mjx-texatom" style=""><span id="MJXc-Node-91" class="mjx-mrow"><span id="MJXc-Node-92" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-93" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-94" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span id="MJXc-Node-95" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-96" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-97" class="mjx-texatom" style=""><span id="MJXc-Node-98" class="mjx-mrow"><span id="MJXc-Node-99" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-100" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-101" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-102" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-103" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span id="MJXc-Node-104" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-105" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-106" class="mjx-texatom" style=""><span id="MJXc-Node-107" class="mjx-mrow"><span id="MJXc-Node-108" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-109" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-110" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">6</span></span><span id="MJXc-Node-111" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-112" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-113" class="mjx-texatom" style=""><span id="MJXc-Node-114" class="mjx-mrow"><span id="MJXc-Node-115" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-116" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-117" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">8</span></span><span id="MJXc-Node-118" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-119" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-120" class="mjx-texatom" style=""><span id="MJXc-Node-121" class="mjx-mrow"><span id="MJXc-Node-122" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-123" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-124" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-125" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-126" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">6</span></span><span id="MJXc-Node-127" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-128" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-129" class="mjx-texatom" style=""><span id="MJXc-Node-130" class="mjx-mrow"><span id="MJXc-Node-131" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-132" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-133" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">8</span></span><span id="MJXc-Node-134" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-135" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-136" class="mjx-texatom" style=""><span id="MJXc-Node-137" class="mjx-mrow"><span id="MJXc-Node-138" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-139" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-140" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">18</span></span><span id="MJXc-Node-141" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-142" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-143" class="mjx-texatom" style=""><span id="MJXc-Node-144" class="mjx-mrow"><span id="MJXc-Node-145" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-146" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-147" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>2</mn><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>+</mo><mn>3</mn><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>=</mo><mn>1</mn><mspace linebreak="newline"></mspace><mn>2</mn><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>+</mo><mn>6</mn><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>+</mo><mn>8</mn><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>=</mo><mn>3</mn><mspace linebreak="newline"></mspace><mn>6</mn><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>+</mo><mn>8</mn><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>+</mo><mn>18</mn><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>=</mo><mn>5</mn></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-3">2x_{1} + x_{2} + 3x_{3} = 1 \\
2x_{1} + 6x_{2} + 8x_{3} = 3 \\
6x_{1} + 8x_{3} + 18x_{3} = 5</script>

<p>For this linear system composed of 3 linear equations we can associate the matrix <code class="language-plaintext highlighter-rouge">A[3x3]</code>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-4-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;18&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-148" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-149" class="mjx-mrow"><span id="MJXc-Node-150" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-151" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-152" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-153" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-154" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-155" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-156" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-157" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-158" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-159" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-160" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-161" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-162" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1em;"><span id="MJXc-Node-163" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-164" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-165" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-166" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-167" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-168" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-169" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-170" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-171" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">6</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-172" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-173" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-174" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">8</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-175" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-176" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-177" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-178" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">6</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-179" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-180" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-181" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">8</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-182" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-183" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-184" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">18</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-185" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>A</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>3</mn></mtd></mtr><mtr><mtd><mn>2</mn></mtd><mtd><mn>6</mn></mtd><mtd><mn>8</mn></mtd></mtr><mtr><mtd><mn>6</mn></mtd><mtd><mn>8</mn></mtd><mtd><mn>18</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-4">A=
\begin{bmatrix}
2 & 1 & 3\\
2 & 6 & 8\\
6 & 8 & 18
\end{bmatrix}</script>

<p>And the vector of solutions <code class="language-plaintext highlighter-rouge">B[3x1]</code>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-5-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-186" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-187" class="mjx-mrow"><span id="MJXc-Node-188" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span><span id="MJXc-Node-189" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-190" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-191" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-192" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-193" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-194" class="mjx-mtd" style="padding: 0px; width: 0.5em;"><span id="MJXc-Node-195" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-196" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-197" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-198" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-199" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-200" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-201" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-202" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-203" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-204" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-205" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>B</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>3</mn></mtd></mtr><mtr><mtd><mn>5</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-5">B=
\begin{bmatrix}
1 \\
3 \\
5 \\
\end{bmatrix}</script>

<p>We can now define our system in terms of matrices as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-6-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-206" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-207" class="mjx-mrow"><span id="MJXc-Node-208" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-209" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-210" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span><span id="MJXc-Node-211" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-212" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>∗</mo><mi>x</mi><mo>=</mo><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">A * x = B</script>, or:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-7-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;18&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-213" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-214" class="mjx-mrow"><span id="MJXc-Node-215" class="mjx-mrow"><span id="MJXc-Node-216" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-217" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-218" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-219" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-220" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-221" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-222" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-223" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-224" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-225" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1em;"><span id="MJXc-Node-226" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-227" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-228" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-229" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-230" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-231" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-232" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-233" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-234" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">6</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-235" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-236" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-237" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">8</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-238" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-239" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-240" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-241" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">6</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-242" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-243" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-244" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">8</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-245" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-246" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-247" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">18</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-248" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-249" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-250" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-251" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-252" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-253" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-254" class="mjx-mtd" style="padding: 0px; width: 0.961em;"><span id="MJXc-Node-255" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-256" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-257" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-258" class="mjx-texatom" style=""><span id="MJXc-Node-259" class="mjx-mrow"><span id="MJXc-Node-260" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-261" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-262" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-263" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-264" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-265" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-266" class="mjx-texatom" style=""><span id="MJXc-Node-267" class="mjx-mrow"><span id="MJXc-Node-268" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-269" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-270" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-271" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-272" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-273" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-274" class="mjx-texatom" style=""><span id="MJXc-Node-275" class="mjx-mrow"><span id="MJXc-Node-276" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-277" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-278" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-279" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-280" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-281" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-282" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-283" class="mjx-mtd" style="padding: 0px; width: 0.5em;"><span id="MJXc-Node-284" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-285" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-286" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-287" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-288" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-289" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-290" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-291" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-292" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-293" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-294" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>3</mn></mtd></mtr><mtr><mtd><mn>2</mn></mtd><mtd><mn>6</mn></mtd><mtd><mn>8</mn></mtd></mtr><mtr><mtd><mn>6</mn></mtd><mtd><mn>8</mn></mtd><mtd><mn>18</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>∗</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>3</mn></mtd></mtr><mtr><mtd><mn>5</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-7">\begin{bmatrix}
2 & 1 & 3\\
2 & 6 & 8\\
6 & 8 & 18
\end{bmatrix}
*
\begin{bmatrix}
x_{1}\\
x_{2}\\
x_{3}
\end{bmatrix}
=
\begin{bmatrix}
1 \\
3 \\
5 \\
\end{bmatrix}</script>

<p>Or, we can use this notation, S:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-8-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mtable columnalign=&quot;center center center center&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot; columnlines=&quot;none none solid&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;18&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-295" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-296" class="mjx-mrow"><span id="MJXc-Node-297" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.032em;">S</span></span><span id="MJXc-Node-298" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-299" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-300" class="mjx-mo" style="vertical-align: -1.202em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎛</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.312em; margin-bottom: -0.1em; margin-top: 0px;">⎜
⎜</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎝</span></span></span><span id="MJXc-Node-301" class="mjx-mtable" style="vertical-align: -1.871em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-302" class="mjx-mtr" style="height: 1.421em;"><span id="MJXc-Node-303" class="mjx-mtd" style="padding: 0.221em 0.5em 0px 0.4em; width: 0.5em;"><span id="MJXc-Node-304" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-305" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-306" class="mjx-mtd" style="padding: 0.221em 0.5em 0px; width: 0.5em;"><span id="MJXc-Node-307" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-308" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-309" class="mjx-mtd" style="border-right: 1.3px solid; padding: 0.221em 0.479em 0px 0.5em; width: 1em;"><span id="MJXc-Node-310" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-311" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-312" class="mjx-mtd" style="padding: 0.221em 0.4em 0px 0.479em; width: 0.5em;"><span id="MJXc-Node-313" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-314" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-315" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-316" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0.4em;"><span id="MJXc-Node-317" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-318" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-319" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-320" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-321" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">6</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-322" class="mjx-mtd" style="border-right: 1.3px solid; padding: 0.2em 0.479em 0px 0.5em;"><span id="MJXc-Node-323" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-324" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">8</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-325" class="mjx-mtd" style="padding: 0.2em 0.4em 0px 0.479em;"><span id="MJXc-Node-326" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-327" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-328" class="mjx-mtr" style="height: 1.421em;"><span id="MJXc-Node-329" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0.4em;"><span id="MJXc-Node-330" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-331" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">6</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-332" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-333" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-334" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">8</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-335" class="mjx-mtd" style="border-right: 1.3px solid; padding: 0.2em 0.479em 0px 0.5em;"><span id="MJXc-Node-336" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-337" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">18</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-338" class="mjx-mtd" style="padding: 0.2em 0.4em 0px 0.479em;"><span id="MJXc-Node-339" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-340" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-341" class="mjx-mo" style="vertical-align: -1.202em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎞</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.312em; margin-bottom: -0.1em; margin-top: 0px;">⎟
⎟</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎠</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>S</mi><mo>=</mo><mrow><mo>(</mo><mtable columnalign="center center center center" rowspacing="4pt" columnspacing="1em" columnlines="none none solid"><mtr><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>2</mn></mtd><mtd><mn>6</mn></mtd><mtd><mn>8</mn></mtd><mtd><mn>3</mn></mtd></mtr><mtr><mtd><mn>6</mn></mtd><mtd><mn>8</mn></mtd><mtd><mn>18</mn></mtd><mtd><mn>5</mn></mtd></mtr></mtable><mo>)</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-8">S=
\left(\begin{array}{@{}ccc|c@{}}
2 & 1 & 3 & 1 \\
2 & 6 & 8 & 3 \\
6 & 8 & 18 & 5
\end{array}\right)</script>

<p>The interesting aspect is that performing simple row operations (swap rows, add rows, multiply rows with scalars) on <code class="language-plaintext highlighter-rouge">S</code> we can transform the system into an equivalent form:</p>

<p>For example, after applying the following row operations on S:</p>

<blockquote>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-9-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-342" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-343" class="mjx-mrow"><span id="MJXc-Node-344" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-345" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-346" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-347" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-348" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-349" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span><span id="MJXc-Node-350" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-351" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-352" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-353" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-354" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span><span id="MJXc-Node-355" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>−</mo><mn>1</mn><mo>∗</mo><mi>R</mi><mi>o</mi><mi>w</mi><mn>1</mn><mo>+</mo><mi>R</mi><mi>o</mi><mi>w</mi><mn>2</mn></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-9">-1*Row1 + Row2</script>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-10-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-356" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-357" class="mjx-mrow"><span id="MJXc-Node-358" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-359" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span id="MJXc-Node-360" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-361" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-362" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-363" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span><span id="MJXc-Node-364" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-365" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-366" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-367" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-368" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span><span id="MJXc-Node-369" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>−</mo><mn>3</mn><mo>∗</mo><mi>R</mi><mi>o</mi><mi>w</mi><mn>1</mn><mo>+</mo><mi>R</mi><mi>o</mi><mi>w</mi><mn>3</mn></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-10">-3*Row1 + Row3</script>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-11-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-370" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-371" class="mjx-mrow"><span id="MJXc-Node-372" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-373" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-374" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-375" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-376" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-377" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span><span id="MJXc-Node-378" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-379" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-380" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-381" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-382" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span><span id="MJXc-Node-383" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>−</mo><mn>1</mn><mo>∗</mo><mi>R</mi><mi>o</mi><mi>w</mi><mn>1</mn><mo>+</mo><mi>R</mi><mi>o</mi><mi>w</mi><mn>3</mn></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-11">-1*Row1 + Row3</script>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-12-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-384" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-385" class="mjx-mrow"><span id="MJXc-Node-386" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.368em;"><span id="MJXc-Node-387" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.711em;"><span id="MJXc-Node-388" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.7em;"></span></span><span class="mjx-vsize" style="height: 2.078em; vertical-align: -0.711em;"></span></span><span id="MJXc-Node-389" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-390" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-391" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-392" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span><span id="MJXc-Node-393" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mn>1</mn><mn>4</mn></mfrac><mo>∗</mo><mi>R</mi><mi>o</mi><mi>w</mi><mn>3</mn></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-12">\frac{1}{4}*Row3</script>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-13-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-394" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-395" class="mjx-mrow"><span id="MJXc-Node-396" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.368em;"><span id="MJXc-Node-397" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.711em;"><span id="MJXc-Node-398" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.7em;"></span></span><span class="mjx-vsize" style="height: 2.078em; vertical-align: -0.711em;"></span></span><span id="MJXc-Node-399" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-400" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-401" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-402" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span><span id="MJXc-Node-403" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>∗</mo><mi>R</mi><mi>o</mi><mi>w</mi><mn>1</mn></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-13">\frac{1}{2}*Row1</script>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-14-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-404" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-405" class="mjx-mrow"><span id="MJXc-Node-406" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.368em;"><span id="MJXc-Node-407" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.733em;"><span id="MJXc-Node-408" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.7em;"></span></span><span class="mjx-vsize" style="height: 2.1em; vertical-align: -0.733em;"></span></span><span id="MJXc-Node-409" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-410" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-411" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-412" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span><span id="MJXc-Node-413" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mn>1</mn><mn>5</mn></mfrac><mo>∗</mo><mi>R</mi><mi>o</mi><mi>w</mi><mn>2</mn></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-14">\frac{1}{5}*Row2</script>
</blockquote>

<p><code class="language-plaintext highlighter-rouge">S</code> becomes:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-15-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mtable columnalign=&quot;center center center center&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot; columnlines=&quot;none none solid&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-414" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-415" class="mjx-mrow"><span id="MJXc-Node-416" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.032em;">S</span></span><span id="MJXc-Node-417" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-418" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-419" class="mjx-mo" style="vertical-align: -1.507em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎛</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.412em; margin-bottom: -0.1em; margin-top: 0px;">⎜
⎜
⎜</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎝</span></span></span><span id="MJXc-Node-420" class="mjx-mtable" style="vertical-align: -2.176em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-421" class="mjx-mtr" style="height: 1.726em;"><span id="MJXc-Node-422" class="mjx-mtd" style="padding: 0.221em 0.5em 0px 0.4em; width: 0.5em;"><span id="MJXc-Node-423" class="mjx-mrow" style="margin-top: -0.09em;"><span id="MJXc-Node-424" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-425" class="mjx-mtd" style="padding: 0.221em 0.5em 0px; width: 0.735em;"><span id="MJXc-Node-426" class="mjx-mrow" style="margin-top: -0.09em;"><span id="MJXc-Node-427" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-428" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.559em;"><span id="MJXc-Node-429" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.29em; vertical-align: -0.395em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-430" class="mjx-mtd" style="border-right: 1.3px solid; padding: 0.221em 0.479em 0px 0.5em; width: 0.735em;"><span id="MJXc-Node-431" class="mjx-mrow" style="margin-top: -0.09em;"><span id="MJXc-Node-432" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.287em;"><span id="MJXc-Node-433" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.559em;"><span id="MJXc-Node-434" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.305em; vertical-align: -0.395em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-435" class="mjx-mtd" style="padding: 0.221em 0.4em 0px 0.479em; width: 0.735em;"><span id="MJXc-Node-436" class="mjx-mrow" style="margin-top: -0.09em;"><span id="MJXc-Node-437" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-438" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.559em;"><span id="MJXc-Node-439" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.29em; vertical-align: -0.395em;"></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-440" class="mjx-mtr" style="height: 1.706em;"><span id="MJXc-Node-441" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0.4em;"><span id="MJXc-Node-442" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-443" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-444" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-445" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-446" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-447" class="mjx-mtd" style="border-right: 1.3px solid; padding: 0.2em 0.479em 0px 0.5em;"><span id="MJXc-Node-448" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-449" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-450" class="mjx-mtd" style="padding: 0.2em 0.4em 0px 0.479em;"><span id="MJXc-Node-451" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-452" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-453" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.581em;"><span id="MJXc-Node-454" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.306em; vertical-align: -0.411em;"></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-455" class="mjx-mtr" style="height: 1.421em;"><span id="MJXc-Node-456" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0.4em;"><span id="MJXc-Node-457" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-458" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-459" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-460" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-461" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-462" class="mjx-mtd" style="border-right: 1.3px solid; padding: 0.2em 0.479em 0px 0.5em;"><span id="MJXc-Node-463" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-464" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-465" class="mjx-mtd" style="padding: 0.2em 0.4em 0px 0.479em;"><span id="MJXc-Node-466" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-467" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-468" class="mjx-mo" style="vertical-align: -1.507em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎞</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.412em; margin-bottom: -0.1em; margin-top: 0px;">⎟
⎟
⎟</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎠</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>S</mi><mo>=</mo><mrow><mo>(</mo><mtable columnalign="center center center center" rowspacing="4pt" columnspacing="1em" columnlines="none none solid"><mtr><mtd><mn>1</mn></mtd><mtd><mfrac><mn>1</mn><mn>2</mn></mfrac></mtd><mtd><mfrac><mn>3</mn><mn>2</mn></mfrac></mtd><mtd><mfrac><mn>1</mn><mn>2</mn></mfrac></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>1</mn></mtd><mtd><mfrac><mn>2</mn><mn>5</mn></mfrac></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>)</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-15">S=
\left(\begin{array}{@{}ccc|c@{}}
1 & \frac{1}{2} & \frac{3}{2} & \frac{1}{2} \\
0 & 1 & 1 & \frac{2}{5} \\
0 & 0 & 1 & 0
\end{array}\right)</script>

<p>Notice how our <code class="language-plaintext highlighter-rouge">M</code> matrix became an upper diagonal matrix (all elements under the first diagonal are <code class="language-plaintext highlighter-rouge">0</code>). The more advanced algorithms we will implement in our C library are all about creating equivalent matrices that are upper or lower diagonal.</p>

<p>After all the basic row transformations on <code class="language-plaintext highlighter-rouge">S</code> matrix are performed, our initial linear system “morphs” into an equivalent system that is trivial to solve by means of substitution:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-16-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; min-width: 9.481em; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mfrac&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-469" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-470" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -4.386em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-471" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-472" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-473" class="mjx-texatom" style=""><span id="MJXc-Node-474" class="mjx-mrow"><span id="MJXc-Node-475" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-476" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-477" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.368em;"><span id="MJXc-Node-478" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.711em;"><span id="MJXc-Node-479" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.7em;"></span></span><span class="mjx-vsize" style="height: 2.078em; vertical-align: -0.711em;"></span></span><span id="MJXc-Node-480" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-481" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-482" class="mjx-texatom" style=""><span id="MJXc-Node-483" class="mjx-mrow"><span id="MJXc-Node-484" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-485" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-486" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.367em;"><span id="MJXc-Node-487" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.711em;"><span id="MJXc-Node-488" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.7em;"></span></span><span class="mjx-vsize" style="height: 2.077em; vertical-align: -0.711em;"></span></span><span id="MJXc-Node-489" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-490" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-491" class="mjx-texatom" style=""><span id="MJXc-Node-492" class="mjx-mrow"><span id="MJXc-Node-493" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-494" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-495" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.368em;"><span id="MJXc-Node-496" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.711em;"><span id="MJXc-Node-497" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.7em;"></span></span><span class="mjx-vsize" style="height: 2.078em; vertical-align: -0.711em;"></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-498" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-499" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-500" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-501" class="mjx-texatom" style=""><span id="MJXc-Node-502" class="mjx-mrow"><span id="MJXc-Node-503" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-504" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-505" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-506" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-507" class="mjx-texatom" style=""><span id="MJXc-Node-508" class="mjx-mrow"><span id="MJXc-Node-509" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-510" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-511" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.368em;"><span id="MJXc-Node-512" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.733em;"><span id="MJXc-Node-513" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.7em;"></span></span><span class="mjx-vsize" style="height: 2.1em; vertical-align: -0.733em;"></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-514" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-515" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-516" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-517" class="mjx-texatom" style=""><span id="MJXc-Node-518" class="mjx-mrow"><span id="MJXc-Node-519" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-520" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-521" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>+</mo><mfrac><mn>3</mn><mn>2</mn></mfrac><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mspace linebreak="newline"></mspace><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>=</mo><mfrac><mn>2</mn><mn>5</mn></mfrac><mspace linebreak="newline"></mspace><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>=</mo><mn>0</mn></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-16">x_{1} + \frac{1}{2}x_{2} + \frac{3}{2}x_{3} = \frac{1}{2} \\
x_{2} + x_{3} = \frac{2}{5} \\
x_{3} = 0</script>

<p>Because <code class="language-plaintext highlighter-rouge">M</code> is an upper diagonal matrix, we can instantly determine the value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-17-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-522" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-523" class="mjx-mrow"><span id="MJXc-Node-524" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-525" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-526" class="mjx-texatom" style=""><span id="MJXc-Node-527" class="mjx-mrow"><span id="MJXc-Node-528" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-529" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-530" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-17">x_{3}=0</script>; then we substitute <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-18-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-531" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-532" class="mjx-mrow"><span id="MJXc-Node-533" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-534" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-535" class="mjx-texatom" style=""><span id="MJXc-Node-536" class="mjx-mrow"><span id="MJXc-Node-537" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-18">x_{3}</script> in the second equation to find <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-19-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-538" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-539" class="mjx-mrow"><span id="MJXc-Node-540" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-541" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-542" class="mjx-texatom" style=""><span id="MJXc-Node-543" class="mjx-mrow"><span id="MJXc-Node-544" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-545" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-546" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-547" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.581em;"><span id="MJXc-Node-548" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.306em; vertical-align: -0.411em;"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>=</mo><mfrac><mn>2</mn><mn>5</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-19">x_{2}=\frac{2}{5}</script> and so on.</p>

<p>From a computational perspective, solving linear systems of equations and having around upper/lower diagonal matrices in place is essential.</p>

<h1 id="the-library">The library<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#the-library" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h1>

<p>Now, let’s say you are one of the few Engineering/Computer Science students that are passionate about <a href="https://en.wikipedia.org/wiki/Linear_algebra">linear algebra</a>, <a href="https://en.wikipedia.org/wiki/Numerical_analysis">numerical analysis</a> and writing code in a low-level language. Or you are just curious about what’s behind the <a href="https://www.mathworks.com/help/matlab/ref/lu.html"><code class="language-plaintext highlighter-rouge">lu(A)</code></a> method in Matlab. Or you are passionate about A.I., and you know you cannot learn A.I. algorithms without a good foundation in linear algebra.</p>

<p>I believe the best exercise you can do is to try to write your (own) Matrix library in a low-level programming language (like <a href="https://en.wikipedia.org/wiki/C_(programming_language)">C</a>, <a href="https://en.wikipedia.org/wiki/C%2B%2B">C++</a> or even <a href="https://dlang.org/">D</a>).</p>

<p>This tutorial is precisely this, a step-by-step explanation of writing a C Matrix library that implements the “basic” and “not-so-basic” numerical analysis algorithms that will allow us in the end to solve linear systems of equations.</p>

<p>All code in this tutorial is available on GitHub in the repository called <a href="https://github.com/nomemory/neat-matrix-library">neat-matrix-library</a>.</p>

<p>To clone it (using GitHub CLI):</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gh repo clone nomemory/neat-matrix-library
</code></pre></div></div>

<p>The code is not meant to be “efficient”, but relatively easy to follow and understand.</p>

<p>The tutorial assumes that the reader can write C code, understand pointers and dynamic memory allocation, and is familiar with the C standard library.</p>

<h1 id="the-data-nml_matrix">The data: <code class="language-plaintext highlighter-rouge">nml_matrix</code><a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#the-data-nml_matrix" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h1>

<p>The first step is to model the data our library will work with: “matrices”. So we are going to define our first <code class="language-plaintext highlighter-rouge">struct</code>, called <code class="language-plaintext highlighter-rouge">nml_mat</code> which models a matrix:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">typedef</span> <span class="k">struct</span> <span class="n">nml_mat_s</span> <span class="p">{</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_rows</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_cols</span><span class="p">;</span>
  <span class="kt">double</span> <span class="o">**</span><span class="n">data</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">is_square</span><span class="p">;</span>
<span class="p">}</span> <span class="n">nml_mat</span><span class="p">;</span>
</code></pre></div></div>

<p>The properties of this <code class="language-plaintext highlighter-rouge">struct</code> have self-explanatory names:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">unsigned int num_rows</code> - represents the number of rows of the matrix. <code class="language-plaintext highlighter-rouge">0</code> is not an acceptable value;</li>
  <li><code class="language-plaintext highlighter-rouge">unsigned int num_cols</code> - represents the number of columns of the matrix. <code class="language-plaintext highlighter-rouge">0</code> is not an acceptable value;</li>
  <li><code class="language-plaintext highlighter-rouge">double **data</code> - is “multi-dimensional array” that stores data in rows and columns;</li>
  <li><code class="language-plaintext highlighter-rouge">int is_square</code> - is a <code class="language-plaintext highlighter-rouge">"boolean"</code> value that determines if the matrix is square (has the same number of rows and columns) or not.</li>
</ul>

<p>From a performance perspective, it’s better to keep the matrix elements in a <code class="language-plaintext highlighter-rouge">double*</code> using the conversion:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=&gt;</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span>
</code></pre></div></div>

<p>To better understand how to store multi-dimensional arrays in <em>linear storage</em> please refer to <a href="https://stackoverflow.com/questions/14015556/how-to-map-the-indexes-of-a-matrix-to-a-1-dimensional-array-c">this StackOverflow question</a>, or read the <a href="https://en.wikipedia.org/wiki/Row-_and_column-major_order">wikipedia article</a> on the topic.</p>

<p>Even if it might sound like a “controversial” decision, for the sake of simplicity, we will use the <code class="language-plaintext highlighter-rouge">double **</code> multi-dimensional storage.</p>

<h2 id="allocating--de-allocating-memory-for-the-nml_mat-matrix">Allocating / De-allocating memory for the <code class="language-plaintext highlighter-rouge">nml_mat</code> matrix<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#allocating--de-allocating-memory-for-the-nml_mat-matrix" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<p>Unlike “higher-level” programming languages (Java, Python, etc.), that manage memory allocation for you, in C, you need to explicitly ask for memory and explicitly free the memory once you no longer need it.</p>

<p>In this regard, the next step is to create “constructor-like” and “destructor-like” functions for the <code class="language-plaintext highlighter-rouge">nml_mat</code> struct defined above. There’s an unwritten rule that says: “Every <a href="https://www.cplusplus.com/reference/cstdlib/malloc/">malloc()</a> has its <em>personal</em> <a href="https://www.cplusplus.com/reference/cstdlib/free/">free()</a>”.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Constructor-like </span>
<span class="c1">// Allocates memory for a new matrix</span>
<span class="c1">// All elements in the matrix are 0.0</span>
<span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_new</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_rows</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_cols</span><span class="p">);</span>

<span class="c1">// Destructor-like</span>
<span class="c1">// De-allocates the memory for the matrix</span>
<span class="kt">void</span> <span class="nf">nml_mat_free</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">matrix</span><span class="p">);</span>
</code></pre></div></div>

<p>Implementing the <code class="language-plaintext highlighter-rouge">nml_mat_new()</code> is quite straightforward:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_new</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_rows</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_cols</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">num_rows</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_ERROR</span><span class="p">(</span><span class="n">INVALID_ROWS</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">num_cols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_ERROR</span><span class="p">(</span><span class="n">INVALID_COLS</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span> <span class="o">=</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">));</span>
  <span class="n">NP_CHECK</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span> <span class="o">=</span> <span class="n">num_rows</span><span class="p">;</span>
  <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span> <span class="o">=</span> <span class="n">num_cols</span><span class="p">;</span>
  <span class="n">m</span><span class="o">-&gt;</span><span class="n">is_square</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_rows</span> <span class="o">==</span> <span class="n">num_cols</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span> <span class="o">=</span> <span class="n">calloc</span><span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">));</span>
  <span class="n">NP_CHECK</span><span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">calloc</span><span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">**</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">));</span>
    <span class="n">NP_CHECK</span><span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">m</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><em>Notes:</em></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">NML_ERROR</code>, <code class="language-plaintext highlighter-rouge">NP_CHECK</code> are macros defined in <a href="https://github.com/nomemory/neat-matrix-library/blob/main/nml_util.h">nml_util.h</a>.</li>
  <li><code class="language-plaintext highlighter-rouge">NML_ERROR()</code> or <code class="language-plaintext highlighter-rouge">NML_FERROR()</code> are logging utils, that helps us print error message on <code class="language-plaintext highlighter-rouge">stderr</code>;</li>
  <li><code class="language-plaintext highlighter-rouge">NP_CHECK</code> checks if the newly allocated memory chunk is not <code class="language-plaintext highlighter-rouge">NULL</code>. In case it’s <code class="language-plaintext highlighter-rouge">NULL</code> it aborts the program.</li>
</ul>

<p>Explanation:</p>
<ol>
  <li>First step is to check if <code class="language-plaintext highlighter-rouge">num_rows == 0</code> or <code class="language-plaintext highlighter-rouge">num_cols == 0</code>. If they are, we consider the input as invalid, and we print on <code class="language-plaintext highlighter-rouge">stderr</code> an error. Afterwards <code class="language-plaintext highlighter-rouge">NULL</code> is returned;</li>
  <li>This line: <code class="language-plaintext highlighter-rouge">nml_mat *m = calloc(1, sizeof(*m))</code> allocates memory for <code class="language-plaintext highlighter-rouge">1</code> (one) <code class="language-plaintext highlighter-rouge">nml_mat</code> structure;</li>
  <li>For a multi-dimensional array (<code class="language-plaintext highlighter-rouge">double**</code>), we allocate memory in two steps:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">m-&gt;data = calloc(m-&gt;num_rows, sizeof(*m-&gt;data))</code> - this allocates memory for the <code class="language-plaintext highlighter-rouge">column</code> array;</li>
      <li>Then, we allocate memory for each row. By using <a href="https://www.cplusplus.com/reference/cstdlib/calloc/"><code class="language-plaintext highlighter-rouge">calloc()</code></a> the data is initialized with <code class="language-plaintext highlighter-rouge">0.0</code>.</li>
    </ul>
  </li>
</ol>

<p>Freeing the matrix is even more straightforward. The implementation for <code class="language-plaintext highlighter-rouge">nml_mat_free()</code>:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">nml_mat_free</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">matrix</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">matrix</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">free</span><span class="p">(</span><span class="n">matrix</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
  <span class="p">}</span>
  <span class="n">free</span><span class="p">(</span><span class="n">matrix</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span>
  <span class="n">free</span><span class="p">(</span><span class="n">matrix</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>It’s important to note, that given the multidimensional nature of <code class="language-plaintext highlighter-rouge">double** data</code>, we need to:</p>
<ul>
  <li>de-allocate each row individually: <code class="language-plaintext highlighter-rouge">free(matrix-&gt;data[i])</code>;</li>
  <li>then the column vector: <code class="language-plaintext highlighter-rouge">free(matrix-&gt;data)</code>;</li>
  <li>and lastly the actual struct: <code class="language-plaintext highlighter-rouge">free(matrix)</code>.</li>
</ul>

<p>At this point, it’s a good idea to add more methods to help the potential user of the library to create various <code class="language-plaintext highlighter-rouge">nml_mat</code> structs, with various properties.</p>

<table>
  <thead>
    <tr>
      <th>Method</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">nml_mat_rnd()</code></td>
      <td>A method to create a random matrix.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">nml_mat_sqr()</code></td>
      <td>A method to create a square matrix with elements <code class="language-plaintext highlighter-rouge">0.0</code>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">nml_mat_eye()</code></td>
      <td>A method to create an identity matrix.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">nml_mat_cp()</code></td>
      <td>A method to copy the content of a matrix into another matrix.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">nml_mat_fromfile()</code></td>
      <td>A method to read the matrix from a <code class="language-plaintext highlighter-rouge">FILE</code>.</td>
    </tr>
  </tbody>
</table>

<h3 id="creating-a-random-matrix">Creating a random matrix<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#creating-a-random-matrix" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>Writing a method like <code class="language-plaintext highlighter-rouge">nml_mat_rnd()</code> it’s easy, once we have <code class="language-plaintext highlighter-rouge">nml_mat_new()</code> in place:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_rnd</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_rows</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_cols</span><span class="p">,</span> <span class="kt">double</span> <span class="n">min</span><span class="p">,</span> <span class="kt">double</span> <span class="n">max</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">nml_rand_interval</span><span class="p">(</span><span class="n">min</span><span class="p">,</span> <span class="n">max</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The input params <code class="language-plaintext highlighter-rouge">min</code> and <code class="language-plaintext highlighter-rouge">max</code> represent the interval boundaries in which the random numbers are being generated.</p>

<p>The <code class="language-plaintext highlighter-rouge">nml_rand_interval(min, max)</code>, the method responsible for generating the random value, looks like this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define	RAND_MAX	0x7fffffff
</span><span class="kt">double</span> <span class="nf">nml_rand_interval</span><span class="p">(</span><span class="kt">double</span> <span class="n">min</span><span class="p">,</span> <span class="kt">double</span> <span class="n">max</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">double</span> <span class="n">d</span><span class="p">;</span>
  <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="n">rand</span><span class="p">()</span> <span class="o">/</span> <span class="p">((</span><span class="kt">double</span><span class="p">)</span> <span class="n">RAND_MAX</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">min</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="n">max</span> <span class="o">-</span> <span class="n">min</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="creating-a-square-matrix">Creating a square matrix<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#creating-a-square-matrix" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>A square matrix has the same number of columns and rows.</p>

<p>For example, <code class="language-plaintext highlighter-rouge">A</code> is square <code class="language-plaintext highlighter-rouge">3x3</code> matrix:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-20-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-549" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-550" class="mjx-mrow"><span id="MJXc-Node-551" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-552" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-553" class="mjx-mtable MJXc-space3 MJXc-space3" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-554" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-555" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-556" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-557" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-558" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-559" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-560" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-561" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-562" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-563" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-564" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-565" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-566" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-567" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-568" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-569" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-570" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-571" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-572" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-573" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-574" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-575" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-576" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-577" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-578" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-579" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-580" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-581" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-582" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-583" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>A</mi><mo>=</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-20">A =
\begin{matrix}
1.0 & 2.0 & 3.0\\
0.0 & 2.0 & 3.0\\
2.0 & 1.0 & 9.0
\end{matrix}</script>

<p>B is <strong>not</strong> a square matrix:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-21-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-584" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-585" class="mjx-mrow"><span id="MJXc-Node-586" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span><span id="MJXc-Node-587" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-588" class="mjx-mtable MJXc-space3 MJXc-space3" style="vertical-align: -0.95em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-589" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-590" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-591" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-592" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-593" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-594" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-595" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-596" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-597" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-598" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-599" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-600" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-601" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-602" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-603" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-604" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-605" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-606" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-607" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-608" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>B</mi><mo>=</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-21">B =
\begin{matrix}
1.0 & 2.0 & 3.0\\
0.0 & 2.0 & 3.0
\end{matrix}</script>

<p>Implementing this is as simple as calling the existing <code class="language-plaintext highlighter-rouge">nml_mat_new()</code> function with <code class="language-plaintext highlighter-rouge">rows=cols</code>:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_sqr</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">size</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Similarly, you can write a method that is generating a random square matrix:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_sqr_rnd</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">size</span><span class="p">,</span> <span class="kt">double</span> <span class="n">min</span><span class="p">,</span> <span class="kt">double</span> <span class="n">max</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">nml_mat_rnd</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">min</span><span class="p">,</span> <span class="n">max</span><span class="p">);</span>
<span class="p">}</span> 
</code></pre></div></div>

<h3 id="creating-an-identity-matrix">Creating an identity matrix<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#creating-an-identity-matrix" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>An identity matrix is square (<code class="language-plaintext highlighter-rouge">NxN</code>) matrix that has <code class="language-plaintext highlighter-rouge">1.0</code> on the first diagonal, and <code class="language-plaintext highlighter-rouge">0.0</code> elsewhere:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-22-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;I&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mpadded width=&quot;0&quot;&gt;&lt;mphantom&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mphantom&gt;&lt;/mpadded&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mpadded height=&quot;0&quot; depth=&quot;0&quot;&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;munder&gt;&lt;mtable columnalign=&quot;center center center center center&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x22EE;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x22F1;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;columns&lt;/mtext&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;/mpadded&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;rows&lt;/mtext&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-609" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-610" class="mjx-mrow"><span id="MJXc-Node-611" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-612" class="mjx-texatom"><span id="MJXc-Node-613" class="mjx-mrow"><span id="MJXc-Node-614" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.38em; padding-bottom: 0.38em;">I</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-615" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span><span id="MJXc-Node-616" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-617" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-618" class="mjx-mo" style="width: 0.12em;"></span><span id="MJXc-Node-619" class="mjx-mrow"><span id="MJXc-Node-620" class="mjx-mo" style="vertical-align: -2.381em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎛</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.497em; margin-bottom: -0.1em; margin-top: 0px;">⎜
⎜
⎜
⎜
⎜
⎜</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎝</span></span></span><span id="MJXc-Node-621" class="mjx-mrow"><span id="MJXc-Node-622" class="mjx-texatom"><span id="MJXc-Node-623" class="mjx-mrow"><span id="MJXc-Node-624" class="mjx-mpadded"><span class="mjx-block" style="width: 0px; margin-top: 2.55em; padding: 0px 0px 3.05em;"><span class="mjx-box" style="width: 0px; margin: -3.55em 0px -3.05em;"><span id="MJXc-Node-625" class="mjx-mrow"><span id="MJXc-Node-626" class="mjx-mphantom"><span id="MJXc-Node-627" class="mjx-mrow"><span id="MJXc-Node-628" class="mjx-mtable" style="vertical-align: -3.05em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-629" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-630" class="mjx-mtd" style="padding: 0px; width: 0.5em;"><span id="MJXc-Node-631" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-632" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-633" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-634" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-635" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-636" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-637" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-638" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-639" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-640" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-641" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-642" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-643" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-644" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-645" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-646" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-647" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-648" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span><span id="MJXc-Node-649" class="mjx-texatom"><span id="MJXc-Node-650" class="mjx-mrow"><span id="MJXc-Node-651" class="mjx-mpadded"><span class="mjx-block" style="width: 0px; margin-top: -1em; padding: 0px 7.615em 0px 0px;"><span class="mjx-box" style="width: 0px; margin: -3.922em 0px -4.939em;"><span id="MJXc-Node-652" class="mjx-mrow"><span id="MJXc-Node-653" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-654" class="mjx-texatom"><span id="MJXc-Node-655" class="mjx-mrow"><span id="MJXc-Node-656" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-657" class="mjx-mtable" style="vertical-align: -3.422em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-658" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-659" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-660" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-661" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-662" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-663" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-664" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-665" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-666" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-667" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-668" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.282em;"><span id="MJXc-Node-669" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-670" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.002em; padding-bottom: 0.296em;">⋯</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-671" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-672" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-673" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-674" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-675" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-676" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-677" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-678" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-679" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-680" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-681" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-682" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-683" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-684" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-685" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-686" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.002em; padding-bottom: 0.296em;">⋯</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-687" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-688" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-689" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-690" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-691" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-692" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-693" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-694" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-695" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-696" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-697" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-698" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-699" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-700" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-701" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-702" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.002em; padding-bottom: 0.296em;">⋯</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-703" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-704" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-705" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-706" class="mjx-mtr" style="height: 2.145em;"><span id="MJXc-Node-707" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-708" class="mjx-mrow" style="margin-top: 0.22em;"><span id="MJXc-Node-709" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 1.011em; padding-bottom: 0.38em;">⋮</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-710" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-711" class="mjx-mrow" style="margin-top: 0.545em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-712" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-713" class="mjx-mrow" style="margin-top: 0.545em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-714" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-715" class="mjx-mrow"><span id="MJXc-Node-716" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 1.221em; padding-bottom: 0.296em;">⋱</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-717" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-718" class="mjx-mrow" style="margin-top: 0.545em;"><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-719" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-720" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-721" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-722" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-723" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-724" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-725" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-726" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-727" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-728" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-729" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-730" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-731" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.002em; padding-bottom: 0.296em;">⋯</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-732" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-733" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-734" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="padding-top: 0.12em;"><span id="MJXc-Node-735" class="mjx-mo"><span class="mjx-delim-h"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.108em; padding-bottom: 0.488em; margin: 0px 0.01em 0px 0.024em;"></span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.108em; padding-bottom: 0.488em; margin: 0px 0.086em 0px -0.066em; letter-spacing: -0.082em;"></span><span class="mjx-char MJXc-TeX-size4-R" style="margin-top: 0px; padding-bottom: 0.488em; margin-right: 0.01em; padding-top: 0.108em; margin-bottom: 0px;"></span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.108em; padding-bottom: 0.488em; margin: 0px 0.086em 0px -0.066em; letter-spacing: -0.082em;"></span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.108em; padding-bottom: 0.488em; margin-right: 0.024em; margin-bottom: 0px; margin-top: 0px;"></span></span></span></span></span></span></span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 3.179em;"><span id="MJXc-Node-736" class="mjx-texatom" style=""><span id="MJXc-Node-737" class="mjx-mrow"><span id="MJXc-Node-738" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span><span id="MJXc-Node-739" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.422em; padding-bottom: 0.338em;">&nbsp;columns</span></span></span></span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-740" class="mjx-mo" style="vertical-align: -2.381em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎞</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.497em; margin-bottom: -0.1em; margin-top: 0px;">⎟
⎟
⎟
⎟
⎟
⎟</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎠</span></span></span></span><span id="MJXc-Node-741" class="mjx-mo" style="vertical-align: -2.126em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.674em; padding-bottom: 0.296em;">⎫</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.243em; margin-bottom: 0.087em; margin-top: -0.137em;">⎪
⎪
⎪
⎪
⎪
⎪</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎬</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.243em; margin-bottom: 0.087em; margin-top: -0.137em;">⎪
⎪
⎪
⎪
⎪
⎪</span><span class="mjx-char MJXc-TeX-size4-R" style="margin-top: -0.208em; padding-bottom: 1.179em;">⎭</span></span></span></span><span id="MJXc-Node-742" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-743" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span><span id="MJXc-Node-744" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.338em;">&nbsp;rows</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">I</mi></mrow><mi>n</mi></msub><mo>=</mo><mrow><mo fence="true" stretchy="true" symmetric="true"></mo><mrow><mo>(</mo><mrow><mrow class="MJX-TeXAtom-ORD"><mpadded width="0"><mphantom><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable></mphantom></mpadded></mrow><mrow class="MJX-TeXAtom-ORD"><mpadded height="0" depth="0"><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mtable columnalign="center center center center center" rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>⋯</mo></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>⋯</mo></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mo>⋯</mo></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mo>⋮</mo></mtd><mtd></mtd><mtd></mtd><mtd><mo>⋱</mo></mtd><mtd></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>⋯</mo></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>⏟</mo></munder></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mtext>&nbsp;columns</mtext></mrow></munder></mpadded></mrow></mrow><mo>)</mo></mrow><mo>}</mo></mrow><mspace width="thinmathspace"></mspace><mi>n</mi><mtext>&nbsp;rows</mtext></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-22">\mathbf{I}_n = \left.\left(
\vphantom{\begin{array}{c}1\\1\\1\\1\\1\end{array}}
\smash{\underbrace{
\begin{array}{ccccc}
1&0&0&\cdots &0\\
0&1&0&\cdots &0\\
0&0&1&\cdots &0\\
\vdots&&&\ddots&\\
0&0&0&\cdots &1
\end{array}
}_{n\text{ columns}}}
\right)\right\}
\,n\text{ rows}</script>

<p><br></p>

<p>A matrix multiplied with its inverse is equal to the identity matrix: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-23-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-745" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-746" class="mjx-mrow"><span id="MJXc-Node-747" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-748" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-749" class="mjx-texatom" style=""><span id="MJXc-Node-750" class="mjx-mrow"><span id="MJXc-Node-751" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-752" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-753" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-754" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-755" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-756" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-757" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-758" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-759" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-760" class="mjx-texatom" style=""><span id="MJXc-Node-761" class="mjx-mrow"><span id="MJXc-Node-762" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-763" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-764" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-765" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.064em;">I</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>∗</mo><mi>A</mi><mo>=</mo><mi>A</mi><mo>∗</mo><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">A^{-1} * A = A * A^{-1} = I</script></p>

<p>From a programming perspective, the first diagonal represents the series of matrix elements for which the indexes <code class="language-plaintext highlighter-rouge">i</code> and <code class="language-plaintext highlighter-rouge">j</code> are equal (<code class="language-plaintext highlighter-rouge">i</code>==<code class="language-plaintext highlighter-rouge">j</code>).</p>

<p><code class="language-plaintext highlighter-rouge">i</code> represents the row index, while <code class="language-plaintext highlighter-rouge">j</code> represents the column index.</p>

<p>Having said this, our method looks like this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_eye</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">size</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>To find out the reasons why the identity method is named <code class="language-plaintext highlighter-rouge">eye()</code> please read this <a href="https://math.stackexchange.com/questions/3028394/what-is-the-motivation-behind-naming-identity-matrix-as-eye/3028999">math exchange post</a>.</p>

<h3 id="creating-a-matrix-from-a-file">Creating a matrix from a <code class="language-plaintext highlighter-rouge">FILE</code><a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#creating-a-matrix-from-a-file" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>Instead of having to write something like the code bellow to set the elements of the matrix:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span> <span class="o">=</span> <span class="p">...</span>
<span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
<span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
<span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
<span class="c1">// etc. </span>
</code></pre></div></div>

<p>It’s more convenient to allow the user of our library to be able to read the matrix elements from an input text file.</p>

<p>The input file should be formatted in a certain way, e.g.:</p>

<p><code class="language-plaintext highlighter-rouge">matrix01.data</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4 5
0.0     1.0     2.0     5.0     3.0
3.0     8.0     9.0     1.0     4.0
2.0     3.0     7.0     1.0     1.0
0.0     0.0     4.0     3.0     8.0
</code></pre></div></div>

<ul>
  <li>The first row of the file <code class="language-plaintext highlighter-rouge">4 5</code> represents the numbers of rows (<code class="language-plaintext highlighter-rouge">=4</code>) and columns (<code class="language-plaintext highlighter-rouge">=5</code>);</li>
  <li>The rest of the rows are the elements (<code class="language-plaintext highlighter-rouge">20</code>) of the matrix.</li>
</ul>

<p>The C code that is able to read this file is:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_fromfilef</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">f</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_rows</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">num_cols</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">fscanf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">num_rows</span><span class="p">);</span>
  <span class="n">fscanf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">num_cols</span><span class="p">);</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">fscanf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">"%lf</span><span class="se">\t</span><span class="s">"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<p>Where:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">fscanf(f, "%d", &amp;num_rows)</code> and <code class="language-plaintext highlighter-rouge">fscanf(f, "%d", &amp;num_cols)</code> reads the first line;</li>
  <li>The <code class="language-plaintext highlighter-rouge">fscanf(f, "%lf\t", &amp;r-&gt;data[i][j])</code> line inside the <code class="language-plaintext highlighter-rouge">for</code> loops read the remaining elements of the matrix.</li>
</ul>

<p>This method can also be used to read user input from the keyboard, by calling the method like this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat_fromfilef</span><span class="p">(</span><span class="n">stdin</span><span class="p">);</span>
</code></pre></div></div>

<h1 id="matrix-methods">Matrix methods<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#matrix-methods" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h1>

<h2 id="checking-for-equality">Checking for equality<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#checking-for-equality" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<p>It will be nice for the users of our library to be able to compare two matrices and see if they are equal, meaning they have the same number of rows and columns and identical elements.</p>

<p>In practice, it’s good to be able to check if two matrices are “almost equal”, meaning that their elements are “almost equal” within an accpetable tolerance.</p>

<p>Writing a method like this it’s trivial. We basically have to iterate over all the elements and check for their equality:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Checks if two matrices have the same dimesions</span>
<span class="kt">int</span> <span class="nf">nml_mat_eqdim</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m1</span><span class="p">,</span> <span class="n">nml_mat</span> <span class="o">*</span><span class="n">m2</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">m1</span><span class="o">-&gt;</span><span class="n">num_cols</span> <span class="o">==</span> <span class="n">m2</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
          <span class="p">(</span><span class="n">m1</span><span class="o">-&gt;</span><span class="n">num_rows</span> <span class="o">==</span> <span class="n">m2</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Checks if two matrices have the same dimensions, and the elements</span>
<span class="c1">// are all equal to each other with a given tolerance;</span>
<span class="c1">// For exact equality use tolerance = 0.0</span>
<span class="kt">int</span> <span class="nf">nml_mat_eq</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m1</span><span class="p">,</span> <span class="n">nml_mat</span> <span class="o">*</span><span class="n">m2</span><span class="p">,</span> <span class="kt">double</span> <span class="n">tolerance</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nml_mat_eqdim</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m1</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m1</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">m1</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">m2</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">tolerance</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><a href="https://www.cplusplus.com/reference/cmath/fabs/"><code class="language-plaintext highlighter-rouge">fabs(x)</code></a> returns the <a href="https://en.wikipedia.org/wiki/Absolute_value">absolute value</a> of <code class="language-plaintext highlighter-rouge">x</code>: <code class="language-plaintext highlighter-rouge">|x|</code>.</p>

<h2 id="printing-the-matrix">Printing the matrix<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#printing-the-matrix" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<p>Printing the matrix is <em>trivial</em>.</p>

<p>We just need to iterate through all the elements and use <code class="language-plaintext highlighter-rouge">fprintf()</code> to show the matrix in <code class="language-plaintext highlighter-rouge">stdout</code>:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">nml_mat_print</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">matrix</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat_printf</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="s">"%lf</span><span class="se">\t\t</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Prints the matrix on the stdout (with a custom formatting for elements)</span>
<span class="kt">void</span> <span class="nf">nml_mat_printf</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">matrix</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">d_fmt</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
  <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">matrix</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">matrix</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="n">d_fmt</span><span class="p">,</span> <span class="n">matrix</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span> 
</code></pre></div></div>

<h2 id="accessing-and-modifying-matrix-elements">Accessing and modifying matrix elements<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#accessing-and-modifying-matrix-elements" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<h3 id="retrieving--selecting-a-column">Retrieving / Selecting a column<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#retrieving--selecting-a-column" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>Some advanced numerical analysis algorithms (e.g.: QR decomposition) are working extensively on columns, so it’s a good idea to be pro-active about it and create a method that selects/retrieves a column from a given matrix.</p>

<p>We will define this method as:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="n">nml_mat_col_get</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">col</span><span class="p">)</span>
</code></pre></div></div>

<p>From a mathematical perspective calling our method on given matrix retrieves another column matrix:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-24-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;nml_mat_col_get(&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;,1)=&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-766" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-767" class="mjx-mrow"><span id="MJXc-Node-768" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">nml_mat_col_get(</span></span><span id="MJXc-Node-769" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-770" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-771" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-772" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-773" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-774" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-775" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-776" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-777" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-778" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-779" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-780" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-781" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-782" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-783" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-784" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-785" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-786" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-787" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-788" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-789" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-790" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-791" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-792" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-793" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-794" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-795" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-796" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-797" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-798" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-799" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-800" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-801" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-802" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-803" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">,1)=</span></span><span id="MJXc-Node-804" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-805" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-806" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-807" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-808" class="mjx-mtd" style="padding: 0px; width: 1.278em;"><span id="MJXc-Node-809" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-810" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-811" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-812" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-813" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-814" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-815" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-816" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-817" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-818" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-819" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>nml_mat_col_get(</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mtext>,1)=</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>2.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd></mtr><mtr><mtd><mn>1.0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-24">\text{nml_mat_col_get(}
\begin{bmatrix}
1.0 & 2.0 & 3.0\\
0.0 & 2.0 & 3.0\\
2.0 & 1.0 & 9.0
\end{bmatrix}
 \text{,1)=}
\begin{bmatrix}
2.0\\
2.0\\
1.0
\end{bmatrix}</script>

<p>The C code for <code class="language-plaintext highlighter-rouge">nml_mat_col_get</code> looks like this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_col_get</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">col</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">col</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_GET_COLUMN</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">col</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<p>Observations:</p>
<ul>
  <li>The resulting matrix has only one column: <code class="language-plaintext highlighter-rouge">nml_mat *r = nml_mat_new(m-&gt;num_rows, 1)</code>;</li>
  <li>We copy all elements from column <code class="language-plaintext highlighter-rouge">[col]</code> to the only column of the resulting matrix <code class="language-plaintext highlighter-rouge">[0]</code>: <code class="language-plaintext highlighter-rouge">r-&gt;data[j][0] = m-&gt;data[j][col]</code>.</li>
</ul>

<h3 id="retrieving--selecting-a-row">Retrieving / Selecting a row<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#retrieving--selecting-a-row" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>To keep the API “consistent” we can write a similar method for retrieving a row:</p>

<p><code class="language-plaintext highlighter-rouge">nml_mat *nml_mat_row_get(nml_mat *m, unsigned int row)</code></p>

<p>This will work similar to the <code class="language-plaintext highlighter-rouge">nml_mat_col_get(...)</code>, but instead of retrieving a column we will retrieve a row:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-25-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;nml_mat_row_get(&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;,1)=&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-820" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-821" class="mjx-mrow"><span id="MJXc-Node-822" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">nml_mat_row_get(</span></span><span id="MJXc-Node-823" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-824" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-825" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-826" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-827" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-828" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-829" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-830" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-831" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-832" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-833" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-834" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-835" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-836" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-837" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-838" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-839" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-840" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-841" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-842" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-843" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-844" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-845" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-846" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-847" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-848" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-849" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-850" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-851" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-852" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-853" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-854" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-855" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-856" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-857" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">,1)=</span></span><span id="MJXc-Node-858" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-859" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">[</span></span><span id="MJXc-Node-860" class="mjx-mtable" style="vertical-align: -0.25em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-861" class="mjx-mtr" style="height: 1em;"><span id="MJXc-Node-862" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-863" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-864" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-865" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-866" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-867" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-868" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-869" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-870" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-871" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">]</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>nml_mat_row_get(</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mtext>,1)=</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-25">\text{nml_mat_row_get(}
\begin{bmatrix}
1.0 & 2.0 & 3.0\\
0.0 & 2.0 & 3.0\\
2.0 & 1.0 & 9.0
\end{bmatrix}
\text{,1)=}
\begin{bmatrix}
0.0 & 2.0 & 3.0
\end{bmatrix}</script>

<p>The C implementation for this method looks like this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_row_get</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">row</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_GET_ROW</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">);</span>
  <span class="n">memcpy</span><span class="p">(</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">row</span><span class="p">],</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<p>This time we write the code differently. Given the fact the memory per row is contiguous we can make use of <a href="https://www.cplusplus.com/reference/cstring/memcpy/">memcpy()</a>.</p>

<p>No loops are needed this time. This line of code is enough to achieve what we want:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">memcpy</span><span class="p">(</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">row</span><span class="p">],</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span> <span class="o">*</span> <span class="nf">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
</code></pre></div></div>

<p>At this point we’ve created a new row matrix from the initial one (<code class="language-plaintext highlighter-rouge">m</code>).</p>

<h3 id="setting-values">Setting values<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#setting-values" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>To set the element of the matrix to a given value, we can simply access the <code class="language-plaintext highlighter-rouge">data</code> field of the <code class="language-plaintext highlighter-rouge">nml_mat*</code> struct:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span> <span class="o">=</span> <span class="p">...</span>
<span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span> 
</code></pre></div></div>

<p>In addition, we can write helper methods to:</p>
<ul>
  <li>Set all the elements to a given value: <code class="language-plaintext highlighter-rouge">void nml_mat_all_set(nml_mat *matrix, double value)</code></li>
  <li>Set all the elements of the fist diagonal to a given value: <code class="language-plaintext highlighter-rouge">int nml_mat_diag_set(nml_mat *m, double value)</code></li>
</ul>

<p>The C code for those two is somewhat trivial:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Sets all elements of a matrix to a given value</span>
<span class="kt">void</span> <span class="nf">nml_mat_all_set</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">matrix</span><span class="p">,</span> <span class="kt">double</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">matrix</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">matrix</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">matrix</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Sets all elements of the matrix to given value</span>
<span class="kt">int</span> <span class="nf">nml_mat_diag_set</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">double</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">is_square</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_SET_DIAG</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<h3 id="multiplying-a-row-with-a-scalar">Multiplying a row with a scalar<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#multiplying-a-row-with-a-scalar" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>Multiplying a row in the matrix (<code class="language-plaintext highlighter-rouge">nml_mat</code>) can be useful when implementing more numerical analysis advanced algorithms.</p>

<p>The idea is simple, we will define a method with the following signature:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">nml_mat_row_mult_r</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row</span><span class="p">,</span> <span class="kt">double</span> <span class="n">num</span><span class="p">);</span> 
</code></pre></div></div>

<p>This method will work directly through reference on the matrix <code class="language-plaintext highlighter-rouge">m</code>. That’s where the <code class="language-plaintext highlighter-rouge">_r</code> stands for.</p>

<p>From a mathematical perspective this method will do the following:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-26-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;nml_mat_row_mult_r(&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;,1, 2.0)=&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;0.0&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;4.0&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;6.0&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-872" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-873" class="mjx-mrow"><span id="MJXc-Node-874" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">nml_mat_row_mult_r(</span></span><span id="MJXc-Node-875" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-876" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-877" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-878" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-879" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-880" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-881" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-882" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-883" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-884" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-885" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-886" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-887" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-888" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-889" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-890" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-891" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-892" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-893" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-894" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-895" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-896" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-897" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-898" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-899" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-900" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-901" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-902" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-903" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-904" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-905" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-906" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-907" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-908" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-909" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">,1, 2.0)=</span></span><span id="MJXc-Node-910" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-911" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-912" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-913" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-914" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.469em;"><span id="MJXc-Node-915" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-916" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-917" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.469em;"><span id="MJXc-Node-918" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-919" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-920" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.469em;"><span id="MJXc-Node-921" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-922" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-923" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-924" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-925" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-926" class="mjx-texatom"><span id="MJXc-Node-927" class="mjx-mrow"><span id="MJXc-Node-928" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.338em; padding-bottom: 0.38em;">0.0</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-929" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-930" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-931" class="mjx-texatom"><span id="MJXc-Node-932" class="mjx-mrow"><span id="MJXc-Node-933" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.338em; padding-bottom: 0.38em;">4.0</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-934" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-935" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-936" class="mjx-texatom"><span id="MJXc-Node-937" class="mjx-mrow"><span id="MJXc-Node-938" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.338em; padding-bottom: 0.38em;">6.0</span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-939" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-940" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-941" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-942" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-943" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-944" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-945" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-946" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-947" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-948" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-949" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>nml_mat_row_mult_r(</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mtext>,1, 2.0)=</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">0.0</mtext></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">4.0</mtext></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">6.0</mtext></mrow></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-26">\text{nml_mat_row_mult_r(}
\begin{bmatrix}
1.0 & 2.0 & 3.0\\
0.0 & 2.0 & 3.0\\
2.0 & 1.0 & 9.0
\end{bmatrix}
\text{,1, 2.0)=}
\begin{bmatrix}
1.0 & 2.0 & 3.0\\
\textbf{0.0} & \textbf{4.0} & \textbf{6.0}\\
2.0 & 1.0 & 9.0
\end{bmatrix}</script>

<p>The code implementation looks like this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">nml_mat_row_mult_r</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row</span><span class="p">,</span> <span class="kt">double</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="o">&gt;=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_ROW_MULTIPLY</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="n">num</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Notice how we select the row: <code class="language-plaintext highlighter-rouge">m-&gt;data[row][i] *= num</code>, where <code class="language-plaintext highlighter-rouge">i = 0 .. m-&gt;num_cols</code>.</p>

<p>An alternative method, that instead of referencing <code class="language-plaintext highlighter-rouge">m</code> will retrieve a new <code class="language-plaintext highlighter-rouge">nml_mat *r</code>, can be written like this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_row_mult</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row</span><span class="p">,</span> <span class="kt">double</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_cp</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nml_mat_row_mult_r</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">num</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<p>Notice how the <code class="language-plaintext highlighter-rouge">_r</code> ending has dropped. This is a common pattern in C.</p>

<h3 id="multiplying-a-column-with-a-scalar">Multiplying a column with a scalar<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#multiplying-a-column-with-a-scalar" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>Multiplying a column is also quite similar with what we described above.</p>

<p>We are going to end-up with two methods:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">int nml_mat_col_mult_r(nml_mat *m, unsigned int col, double num)</code>
    <ul>
      <li>This will modify the matrix <code class="language-plaintext highlighter-rouge">m</code> through reference;</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">nml_mat *nml_mat_col_mult(nml_mat *m, unsigned int col, double num)</code>
    <ul>
      <li>This will return a new <code class="language-plaintext highlighter-rouge">nml_mat *r</code> matrix</li>
    </ul>
  </li>
</ul>

<p>From a math perspective:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-27-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;nml_mat_col_mult_r(&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;,0, 2.0)=&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;2.0&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;0.0&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;4.0&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-950" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-951" class="mjx-mrow"><span id="MJXc-Node-952" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">nml_mat_col_mult_r(</span></span><span id="MJXc-Node-953" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-954" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-955" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-956" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-957" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-958" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-959" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-960" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-961" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-962" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-963" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-964" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-965" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-966" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-967" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-968" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-969" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-970" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-971" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-972" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-973" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-974" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-975" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-976" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-977" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-978" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-979" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-980" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-981" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-982" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-983" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-984" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-985" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-986" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-987" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">,0, 2.0)=</span></span><span id="MJXc-Node-988" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-989" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-990" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-991" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-992" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.469em;"><span id="MJXc-Node-993" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-994" class="mjx-texatom"><span id="MJXc-Node-995" class="mjx-mrow"><span id="MJXc-Node-996" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.338em; padding-bottom: 0.38em;">2.0</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-997" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-998" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-999" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1000" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1001" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1002" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1003" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1004" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1005" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1006" class="mjx-texatom"><span id="MJXc-Node-1007" class="mjx-mrow"><span id="MJXc-Node-1008" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.338em; padding-bottom: 0.38em;">0.0</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1009" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1010" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1011" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1012" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1013" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1014" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1015" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1016" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1017" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1018" class="mjx-texatom"><span id="MJXc-Node-1019" class="mjx-mrow"><span id="MJXc-Node-1020" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.338em; padding-bottom: 0.38em;">4.0</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1021" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1022" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1023" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1024" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1025" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1026" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1027" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>nml_mat_col_mult_r(</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mtext>,0, 2.0)=</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">2.0</mtext></mrow></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">0.0</mtext></mrow></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">4.0</mtext></mrow></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-27">\text{nml_mat_col_mult_r(}
\begin{bmatrix}
1.0 & 2.0 & 3.0\\
0.0 & 2.0 & 3.0\\
2.0 & 1.0 & 9.0
\end{bmatrix}
\text{,0, 2.0)=}
\begin{bmatrix}
\textbf{2.0} & 2.0 & 3.0\\
\textbf{0.0} & 2.0 & 3.0\\
\textbf{4.0} & 1.0 & 9.0
\end{bmatrix}</script>

<p>The C code for both of the methods looks like this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_col_mult</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">col</span><span class="p">,</span> <span class="kt">double</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_cp</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nml_mat_col_mult_r</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">num</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">nml_mat_col_mult_r</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">col</span><span class="p">,</span> <span class="kt">double</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">col</span><span class="o">&gt;=</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_COL_MULTIPLY</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">*=</span> <span class="n">num</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<p>Notice how we select the column: <code class="language-plaintext highlighter-rouge">m-&gt;data[i][col] *= num</code> , where <code class="language-plaintext highlighter-rouge">i = 0 .. m-&gt;num_rows</code>.</p>

<h3 id="adding-two-rows">Adding two rows<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#adding-two-rows" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>The ability to add one row to another, is am important method used later for the implementation of more advanced algorithms: LUP Decomposition, Row Echelon Form, Reduced Row Echelon Form, etc.</p>

<p>In addition, before adding one row to another we should also offer the possibility to multiply the row with a given scalar.</p>

<p>We define the following method(s):</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// We add all elements from row 'row' to row 'where'. </span>
<span class="c1">// The elements from row 'row' are muliplied using the 'multiplier'</span>
<span class="c1">//</span>
<span class="c1">// This one works through reference, modifying the `m` matrix; </span>
<span class="kt">int</span> <span class="nf">nml_mat_row_addrow_r</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">where</span><span class="p">,</span> 
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row</span><span class="p">,</span> <span class="kt">double</span> <span class="n">multiplier</span><span class="p">);</span>

<span class="c1">// We add all elements from row 'row' to row 'where'. </span>
<span class="c1">// The elements from row 'row' are muliplied using the 'multiplier'</span>
<span class="c1">//</span>
<span class="c1">// This one returns a new matrix, `nml_mat *r`, after the row addition is performed    </span>
<span class="o">*</span> <span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_row_addrow</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">where</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row</span><span class="p">,</span> 
<span class="kt">double</span> <span class="n">multiplier</span><span class="p">);</span>
</code></pre></div></div>

<p>To better visualise:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-28-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;nml_mat_row_addrow_r(&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;, 0, 1, 0.5)=&lt;/mtext&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;0.5&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;0.5&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;0.5&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;=&lt;/mtext&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;5.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 23.874em; position: relative;"><span id="MJXc-Node-1028" class="mjx-math" aria-hidden="true" style="width: 100%;"><span id="MJXc-Node-1029" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -8.484em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-1030" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">nml_mat_row_addrow_r(</span></span><span id="MJXc-Node-1031" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-1032" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-1033" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1034" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1035" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1036" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1037" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1038" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1039" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1040" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1041" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1042" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1043" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1044" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1045" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1046" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1047" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1048" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1049" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1050" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1051" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1052" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1053" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1054" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1055" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1056" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1057" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1058" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1059" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1060" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1061" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1062" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1063" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1064" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-1065" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">, 0, 1, 0.5)=</span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1066" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1067" class="mjx-mrow"><span id="MJXc-Node-1068" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-1069" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1070" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1071" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 5.223em;"><span id="MJXc-Node-1072" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1073" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span id="MJXc-Node-1074" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-1075" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span id="MJXc-Node-1076" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-1077" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.5</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1078" class="mjx-mtd" style="padding: 0px 0.5em; width: 6.001em;"><span id="MJXc-Node-1079" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1080" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span id="MJXc-Node-1081" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-1082" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span id="MJXc-Node-1083" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-1084" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.5</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1085" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 5.223em;"><span id="MJXc-Node-1086" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1087" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span id="MJXc-Node-1088" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-1089" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span id="MJXc-Node-1090" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-1091" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.5</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1092" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1093" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1094" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1095" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1096" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1097" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1098" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1099" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1100" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1101" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1102" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1103" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1104" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1105" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1106" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1107" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1108" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1109" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1110" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1111" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1112" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-1113" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1114" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1115" class="mjx-mrow"><span id="MJXc-Node-1116" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-1117" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1118" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1119" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1120" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1121" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1122" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1123" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1124" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1125" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1126" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1127" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1128" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1129" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1130" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1131" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1132" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1133" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1134" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1135" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1136" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1137" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1138" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1139" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1140" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1141" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1142" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1143" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1144" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1145" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1146" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1147" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1148" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>nml_mat_row_addrow_r(</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>4.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mtext>, 0, 1, 0.5)=</mtext><mspace linebreak="newline"></mspace><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn><mo>+</mo><mn>0</mn><mo>∗</mo><mn>0.5</mn></mtd><mtd><mn>2.0</mn><mo>+</mo><mn>2.0</mn><mo>∗</mo><mn>0.5</mn></mtd><mtd><mn>3</mn><mo>+</mo><mn>4.0</mn><mo>∗</mo><mn>0.5</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>4.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mtext>=</mtext><mspace linebreak="newline"></mspace><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>3.0</mn></mtd><mtd><mn>5.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>4.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-28">\text{nml_mat_row_addrow_r(}
\begin{bmatrix}
1.0 & 2.0 & 3.0\\
0.0 & 2.0 & 4.0\\
2.0 & 1.0 & 9.0
\end{bmatrix}
\text{, 0, 1, 0.5)=}
\\
\begin{bmatrix}
1.0 + 0 * 0.5 & 2.0 + 2.0 * 0.5 & 3 + 4.0 * 0.5\\
0.0 & 2.0 & 3.0\\
4.0 & 1.0 & 9.0
\end{bmatrix}
\text{=}
\\
\begin{bmatrix}
1.0 & 3.0 & 5.0\\
0.0 & 2.0 & 3.0\\
4.0 & 1.0 & 9.0
\end{bmatrix}</script>

<p>The corresponding C code for the two methods is:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_row_addrow</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">where</span><span class="p">,</span> 
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row</span><span class="p">,</span> <span class="kt">double</span> <span class="n">multiplier</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_cp</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nml_mat_row_addrow_r</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">where</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">nml_mat_row_addrow_r</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">where</span><span class="p">,</span> 
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row</span><span class="p">,</span> <span class="kt">double</span> <span class="n">multiplier</span><span class="p">)</span> <span class="p">{</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">where</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span> <span class="o">||</span> <span class="n">row</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_ADD_TO_ROW</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">where</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">where</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">multiplier</span> <span class="o">*</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<p>Notice how we are selecting the rows:  <code class="language-plaintext highlighter-rouge">m-&gt;data[where][i] += multiplier * m-&gt;data[row][i]</code> , where <code class="language-plaintext highlighter-rouge">i = 0 .. i &lt; m-&gt;num_cols</code>.</p>

<p>In case it’s not obvious, if the user simply wants to add two rows, without any multiplication, the multiplier should be kept as <code class="language-plaintext highlighter-rouge">1.0</code>.</p>

<h3 id="multiplying-the-matrix-with-a-scalar">Multiplying the matrix with a scalar<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#multiplying-the-matrix-with-a-scalar" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>The mathematical formula for multiplying the matrix with a scalar is simple:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-29-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;01&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;02&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;01&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;02&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-1149" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1150" class="mjx-mrow"><span id="MJXc-Node-1151" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">s</span></span><span id="MJXc-Node-1152" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-1153" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-1154" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-1155" class="mjx-mtable" style="vertical-align: -2.35em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1156" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1157" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.539em;"><span id="MJXc-Node-1158" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1159" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1160" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1161" class="mjx-texatom" style=""><span id="MJXc-Node-1162" class="mjx-mrow"><span id="MJXc-Node-1163" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">01</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1164" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.539em;"><span id="MJXc-Node-1165" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1166" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1167" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1168" class="mjx-texatom" style=""><span id="MJXc-Node-1169" class="mjx-mrow"><span id="MJXc-Node-1170" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">02</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1171" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.167em;"><span id="MJXc-Node-1172" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1173" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1174" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1175" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1176" class="mjx-mtd" style="padding: 0px 0.5em; width: 0px;"><span id="MJXc-Node-1177" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1178" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.609em;"><span id="MJXc-Node-1179" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1180" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1181" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1182" class="mjx-texatom" style=""><span id="MJXc-Node-1183" class="mjx-mrow"><span id="MJXc-Node-1184" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span id="MJXc-Node-1185" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1186" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1187" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1188" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1189" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1190" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1191" class="mjx-texatom" style=""><span id="MJXc-Node-1192" class="mjx-mrow"><span id="MJXc-Node-1193" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1194" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1195" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1196" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1197" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1198" class="mjx-texatom" style=""><span id="MJXc-Node-1199" class="mjx-mrow"><span id="MJXc-Node-1200" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1201" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1202" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1203" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1204" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1205" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1206" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1207" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1208" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1209" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1210" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1211" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1212" class="mjx-texatom" style=""><span id="MJXc-Node-1213" class="mjx-mrow"><span id="MJXc-Node-1214" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-1215" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1216" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1217" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1218" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1219" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1220" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1221" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1222" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1223" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1224" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1225" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1226" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1227" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1228" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1229" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1230" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1231" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1232" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1233" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1234" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1235" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1236" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1237" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1238" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1239" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1240" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1241" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1242" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1243" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1244" class="mjx-texatom" style=""><span id="MJXc-Node-1245" class="mjx-mrow"><span id="MJXc-Node-1246" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-1247" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1248" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1249" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1250" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1251" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1252" class="mjx-texatom" style=""><span id="MJXc-Node-1253" class="mjx-mrow"><span id="MJXc-Node-1254" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-1255" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1256" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1257" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1258" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1259" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1260" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1261" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1262" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1263" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1264" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1265" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1266" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1267" class="mjx-texatom" style=""><span id="MJXc-Node-1268" class="mjx-mrow"><span id="MJXc-Node-1269" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-1270" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1271" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-1272" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-1273" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-1274" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-1275" class="mjx-mtable" style="vertical-align: -2.35em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1276" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1277" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 2.952em;"><span id="MJXc-Node-1278" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1279" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">s</span></span><span id="MJXc-Node-1280" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-1281" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1282" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1283" class="mjx-texatom" style=""><span id="MJXc-Node-1284" class="mjx-mrow"><span id="MJXc-Node-1285" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">01</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1286" class="mjx-mtd" style="padding: 0px 0.5em; width: 2.952em;"><span id="MJXc-Node-1287" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1288" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">s</span></span><span id="MJXc-Node-1289" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-1290" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1291" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1292" class="mjx-texatom" style=""><span id="MJXc-Node-1293" class="mjx-mrow"><span id="MJXc-Node-1294" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">02</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1295" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.167em;"><span id="MJXc-Node-1296" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1297" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1298" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1299" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1300" class="mjx-mtd" style="padding: 0px 0.5em; width: 0px;"><span id="MJXc-Node-1301" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1302" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 3.023em;"><span id="MJXc-Node-1303" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1304" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">s</span></span><span id="MJXc-Node-1305" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-1306" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1307" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1308" class="mjx-texatom" style=""><span id="MJXc-Node-1309" class="mjx-mrow"><span id="MJXc-Node-1310" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span id="MJXc-Node-1311" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1312" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1313" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1314" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1315" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">s</span></span><span id="MJXc-Node-1316" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-1317" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1318" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1319" class="mjx-texatom" style=""><span id="MJXc-Node-1320" class="mjx-mrow"><span id="MJXc-Node-1321" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1322" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1323" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1324" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">s</span></span><span id="MJXc-Node-1325" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-1326" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1327" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1328" class="mjx-texatom" style=""><span id="MJXc-Node-1329" class="mjx-mrow"><span id="MJXc-Node-1330" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1331" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1332" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1333" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1334" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1335" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1336" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1337" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1338" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1339" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1340" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">s</span></span><span id="MJXc-Node-1341" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-1342" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1343" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1344" class="mjx-texatom" style=""><span id="MJXc-Node-1345" class="mjx-mrow"><span id="MJXc-Node-1346" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-1347" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1348" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1349" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1350" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1351" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1352" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1353" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1354" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1355" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1356" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1357" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1358" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1359" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1360" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1361" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1362" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1363" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1364" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1365" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1366" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1367" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1368" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1369" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1370" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1371" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1372" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1373" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1374" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">s</span></span><span id="MJXc-Node-1375" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-1376" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1377" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1378" class="mjx-texatom" style=""><span id="MJXc-Node-1379" class="mjx-mrow"><span id="MJXc-Node-1380" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-1381" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1382" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1383" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1384" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">s</span></span><span id="MJXc-Node-1385" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-1386" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1387" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1388" class="mjx-texatom" style=""><span id="MJXc-Node-1389" class="mjx-mrow"><span id="MJXc-Node-1390" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-1391" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1392" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1393" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1394" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1395" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1396" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1397" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1398" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1399" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1400" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1401" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">s</span></span><span id="MJXc-Node-1402" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-1403" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1404" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1405" class="mjx-texatom" style=""><span id="MJXc-Node-1406" class="mjx-mrow"><span id="MJXc-Node-1407" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-1408" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1409" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>s</mi><mo>∗</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>01</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>02</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>2</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>n</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>s</mi><mo>∗</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>01</mn></mrow></msub></mtd><mtd><mi>s</mi><mo>∗</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>02</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><mi>s</mi><mo>∗</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><mi>s</mi><mo>∗</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><mi>s</mi><mo>∗</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><mi>s</mi><mo>∗</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><mi>s</mi><mo>∗</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>1</mn></mrow></msub></mtd><mtd><mi>s</mi><mo>∗</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>2</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><mi>s</mi><mo>∗</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>n</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-29">s * 
\begin{bmatrix}
a_{01} & a_{02} & ... && a_{0n}\\
a_{11} & a_{12} & ... && a_{1n}\\
... & ... & ... && ...\\
a_{m1} & a_{m2} & ... && a_{mn}\\
\end{bmatrix}
=
\begin{bmatrix}
s * a_{01} & s * a_{02} & ... && s * a_{0n}\\
s * a_{11} & s * a_{12} & ... && s * a_{1n}\\
... & ... & ... && ...\\
s * a_{m1} & s * a_{m2} & ... && s * a_{mn}\\
\end{bmatrix}</script>

<p>So, just like the formula, the code equivalent is simple:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_smult</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">double</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_cp</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="n">nml_mat_smult_r</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">num</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">nml_mat_smult_r</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">double</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="n">num</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<p>For each element <code class="language-plaintext highlighter-rouge">m-&gt;data[i][j]</code> we perform the multiplication with the scalar <code class="language-plaintext highlighter-rouge">num</code>:  <code class="language-plaintext highlighter-rouge">m-&gt;data[i][j] *= num</code> where <code class="language-plaintext highlighter-rouge">i = 0 .. num_rows</code> and <code class="language-plaintext highlighter-rouge">j = 0 .. num_cols</code>.</p>

<h2 id="modifying-the-nml_mat-internal-structure">Modifying the <code class="language-plaintext highlighter-rouge">nml_mat</code> internal structure<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#modifying-the-nml_mat-internal-structure" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<p>The next set of functionalities we can write to help our ~potential~ library users to modify the <code class="language-plaintext highlighter-rouge">nml_mat</code> matrix structure are:</p>
<ul>
  <li>Remove a columns and rows and return a new matrix;</li>
  <li>Swap rows inside a given matrix;</li>
  <li>Swap columns inside a given matrix;</li>
  <li>Concatenate vertically and horizontally two matrices;</li>
</ul>

<h3 id="removing-a-column">Removing a column<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#removing-a-column" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>Removing a column from a<code class="language-plaintext highlighter-rouge">M[n x m]</code> matrix, involves the creation of a new <code class="language-plaintext highlighter-rouge">[n x (m-1)]</code> matrix.</p>

<p>The method signature looks like this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_col_rem</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">column</span><span class="p">);</span>
</code></pre></div></div>

<p>For this particular use-case it would be overkill to try to create a “by-reference” (<code class="language-plaintext highlighter-rouge">_r</code>) version of the method.</p>

<p>Calling the <code class="language-plaintext highlighter-rouge">nml_mat_col_rem</code> on a matrix yields the following results:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-30-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;nml_mat_col_rem(&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;, 1)=&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-1410" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1411" class="mjx-mrow"><span id="MJXc-Node-1412" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">nml_mat_col_rem(</span></span><span id="MJXc-Node-1413" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-1414" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-1415" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1416" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1417" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1418" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1419" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1420" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1421" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1422" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1423" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1424" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1425" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1426" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1427" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1428" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1429" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1430" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1431" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1432" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1433" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1434" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1435" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1436" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1437" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1438" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1439" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1440" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1441" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1442" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1443" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1444" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1445" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1446" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-1447" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">, 1)=</span></span><span id="MJXc-Node-1448" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-1449" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-1450" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1451" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1452" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1453" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1454" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1455" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1456" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1457" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1458" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1459" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1460" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1461" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1462" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1463" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1464" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1465" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1466" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1467" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1468" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1469" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1470" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1471" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1472" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>nml_mat_col_rem(</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>4.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mtext>, 1)=</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>4.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-30">\text{nml_mat_col_rem(}
\begin{bmatrix}
1.0 & 2.0 & 3.0\\
0.0 & 2.0 & 4.0\\
2.0 & 1.0 & 9.0
\end{bmatrix}
\text{, 1)=}
\begin{bmatrix}
1.0 & 3.0\\
0.0 & 4.0\\
2.0 & 9.0
\end{bmatrix}</script>

<p>The code implementation:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_col_rem</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">column</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">column</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_REMOVE_COLUMN</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">column</span><span class="o">!=</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Observations:</p>
<ul>
  <li>The resulting <code class="language-plaintext highlighter-rouge">r</code> matrix has the number of columns <code class="language-plaintext highlighter-rouge">m-&gt;num_cols-1</code>;</li>
  <li>We keep a separate column index for the <code class="language-plaintext highlighter-rouge">r</code> matrix that we name <code class="language-plaintext highlighter-rouge">k</code>;</li>
  <li>When copying the elements from <code class="language-plaintext highlighter-rouge">m</code> to <code class="language-plaintext highlighter-rouge">r</code> we skip the column <code class="language-plaintext highlighter-rouge">column</code> by adding this condition <code class="language-plaintext highlighter-rouge">(column!=j)</code>:
    <ul>
      <li>Then we increment <code class="language-plaintext highlighter-rouge">k</code>, using <code class="language-plaintext highlighter-rouge">k++</code> inside the <code class="language-plaintext highlighter-rouge">r-&gt;data[i][k++]</code> statement;</li>
      <li>From this moment onwards <code class="language-plaintext highlighter-rouge">k-j == 1</code>, meaning <code class="language-plaintext highlighter-rouge">k</code> and <code class="language-plaintext highlighter-rouge">j</code> are no longer in sync, because we’ve skipped the column.</li>
    </ul>
  </li>
</ul>

<h3 id="removing-a-row">Removing a row<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#removing-a-row" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>Removing a column from a<code class="language-plaintext highlighter-rouge">M[n x m]</code> matrix, involves the creation of a new <code class="language-plaintext highlighter-rouge">[(n-1) x m]</code> matrix.</p>

<p>The method signature looks like this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_row_rem</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row</span><span class="p">);</span>
</code></pre></div></div>

<p>Calling the <code class="language-plaintext highlighter-rouge">nml_mat_row_rem</code> on a matrix yields the following results:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-31-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;nml_mat_row_rem(&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;, 1)=&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-1473" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1474" class="mjx-mrow"><span id="MJXc-Node-1475" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">nml_mat_row_rem(</span></span><span id="MJXc-Node-1476" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-1477" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-1478" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1479" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1480" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1481" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1482" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1483" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1484" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1485" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1486" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1487" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1488" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1489" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1490" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1491" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1492" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1493" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1494" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1495" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1496" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1497" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1498" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1499" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1500" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1501" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1502" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1503" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1504" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1505" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1506" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1507" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1508" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1509" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-1510" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">, 1)=</span></span><span id="MJXc-Node-1511" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-1512" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">[</span></span><span id="MJXc-Node-1513" class="mjx-mtable" style="vertical-align: -0.95em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1514" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1515" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1516" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1517" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1518" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1519" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1520" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1521" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1522" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1523" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1524" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1525" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1526" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1527" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1528" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1529" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1530" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1531" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1532" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1533" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1534" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">]</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>nml_mat_row_rem(</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>4.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mtext>, 1)=</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-31">\text{nml_mat_row_rem(}
\begin{bmatrix}
1.0 & 2.0 & 3.0\\
0.0 & 2.0 & 4.0\\
2.0 & 1.0 & 9.0
\end{bmatrix}
\text{, 1)=}
\begin{bmatrix}
1.0 & 2.0 & 3.0\\
2.0 & 1.0 & 9.0
\end{bmatrix}</script>

<p>The code implementation:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_row_rem</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">row</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_REMOVE_ROW</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="o">!=</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
      <span class="p">}</span>
      <span class="n">k</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Observations:</p>
<ul>
  <li>The resulting matrix <code class="language-plaintext highlighter-rouge">r</code> has the same number of columns as m (<code class="language-plaintext highlighter-rouge">m-&gt;num_cols</code>), but a smaller number of rows (<code class="language-plaintext highlighter-rouge">r-&gt;num_rows</code>);</li>
  <li>We keep a separate row index <code class="language-plaintext highlighter-rouge">k</code> for the resulting matrix ‘r’;</li>
  <li>Initially <code class="language-plaintext highlighter-rouge">k</code> is in sync with <code class="language-plaintext highlighter-rouge">i</code>, as long as <code class="language-plaintext highlighter-rouge">(row!=i)</code>;</li>
  <li>When <code class="language-plaintext highlighter-rouge">row==i</code>, <code class="language-plaintext highlighter-rouge">k</code> is no longer incremented, so the sync is lost and <code class="language-plaintext highlighter-rouge">i - k == 1</code>. This is how the row gets skipped.</li>
</ul>

<h3 id="swapping-rows">Swapping Rows<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#swapping-rows" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>This functionality will prove useful later when we re going to implement the Row Echelon Form and LU Decomposition algorithms.</p>

<p>In this case we can define two methods:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Returns a new matrix with row1 and row2 swapped</span>
<span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_row_swap</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row2</span><span class="p">);</span>

<span class="c1">// Modifies the existing matrix m, by swapping the two rows row1 and row2</span>
<span class="kt">int</span> <span class="nf">nml_mat_row_swap_r</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row2</span><span class="p">);</span>
</code></pre></div></div>

<p>Visually the method works like this:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-32-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;nml_mat_row_swap_r(&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;, 0, 1)=&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-1535" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1536" class="mjx-mrow"><span id="MJXc-Node-1537" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">nml_mat_row_swap_r(</span></span><span id="MJXc-Node-1538" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-1539" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-1540" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1541" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1542" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1543" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1544" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1545" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1546" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1547" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1548" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1549" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1550" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1551" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1552" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1553" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1554" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1555" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1556" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1557" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1558" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1559" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1560" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1561" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1562" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1563" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1564" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1565" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1566" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1567" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1568" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1569" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1570" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1571" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-1572" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">, 0, 1)=</span></span><span id="MJXc-Node-1573" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-1574" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-1575" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1576" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1577" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1578" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1579" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1580" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1581" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1582" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1583" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1584" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1585" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1586" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1587" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1588" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1589" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1590" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1591" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1592" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1593" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1594" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1595" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1596" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1597" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1598" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1599" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1600" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1601" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1602" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1603" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1604" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1605" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1606" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>nml_mat_row_swap_r(</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>4.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mtext>, 0, 1)=</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>4.0</mn></mtd></mtr><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-32">\text{nml_mat_row_swap_r(}
\begin{bmatrix}
1.0 & 2.0 & 3.0\\
0.0 & 2.0 & 4.0\\
2.0 & 1.0 & 9.0
\end{bmatrix}
\text{, 0, 1)=}
\begin{bmatrix}
0.0 & 2.0 & 4.0\\
1.0 & 2.0 & 3.0\\
2.0 & 1.0 & 9.0
\end{bmatrix}</script>

<p>The C implementation makes use of the fact that rows are contiguous memory blocks can be swapped without having to access each element of the rows in particular:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">nml_mat_row_swap_r</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row2</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">row1</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span> <span class="o">||</span> <span class="n">row2</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_SWAP_ROWS</span><span class="p">,</span> <span class="n">row1</span><span class="p">,</span> <span class="n">row2</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">double</span> <span class="o">*</span><span class="n">tmp</span> <span class="o">=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">row2</span><span class="p">];</span>
  <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">row2</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">row1</span><span class="p">];</span>
  <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">row1</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<p>As for the <code class="language-plaintext highlighter-rouge">nml_mat_row_swap(..)</code> this can be written by re-using <code class="language-plaintext highlighter-rouge">nml_mat_row_swap_r(...)</code>:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_row_swap</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row2</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_cp</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nml_mat_row_swap_r</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">row1</span><span class="p">,</span> <span class="n">row2</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<h3 id="swapping-columns">Swapping columns<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#swapping-columns" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>This functionality might not be as useful as the previous one (<code class="language-plaintext highlighter-rouge">nml_mat_row_swap(...)</code>), but for sake of having a robust API for our ~potential~ users, we will implement it.</p>

<p>We define again two methods, one that is returning a new <code class="language-plaintext highlighter-rouge">nml_mat</code> matrix, and one that operates on the given on:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_col_swap</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">col1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">col2</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">nml_mat_col_swap_r</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">col1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">col2</span><span class="p">);</span> 
</code></pre></div></div>

<p>Visually the two methods are working like this:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-33-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;nml_mat_col_swap_r(&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;, 0, 1)=&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-1607" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1608" class="mjx-mrow"><span id="MJXc-Node-1609" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">nml_mat_col_swap_r(</span></span><span id="MJXc-Node-1610" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-1611" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-1612" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1613" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1614" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1615" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1616" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1617" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1618" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1619" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1620" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1621" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1622" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1623" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1624" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1625" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1626" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1627" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1628" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1629" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1630" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1631" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1632" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1633" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1634" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1635" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1636" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1637" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1638" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1639" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1640" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1641" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1642" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1643" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-1644" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">, 0, 1)=</span></span><span id="MJXc-Node-1645" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-1646" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-1647" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1648" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1649" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1650" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1651" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1652" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1653" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1654" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1655" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1656" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1657" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1658" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1659" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1660" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1661" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1662" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1663" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1664" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1665" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1666" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1667" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1668" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1669" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1670" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1671" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1672" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1673" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1674" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1675" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1676" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1677" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1678" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>nml_mat_col_swap_r(</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>4.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mtext>, 0, 1)=</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>4.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>0.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-33">\text{nml_mat_col_swap_r(}
\begin{bmatrix}
1.0 & 2.0 & 3.0\\
0.0 & 2.0 & 4.0\\
2.0 & 1.0 & 9.0
\end{bmatrix}
\text{, 0, 1)=}
\begin{bmatrix}
2.0 & 1.0 & 4.0\\
2.0 & 0.0 & 3.0\\
1.0 & 2.0 & 9.0
\end{bmatrix}</script>

<p>Compared to the previous two functions (for swapping rows) the code is slightly different. Columns are not contiguous blocks of memory, so we will need to swap each element one by one:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">nml_mat_col_swap_r</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">col1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">col2</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">col1</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span> <span class="o">||</span> <span class="n">col2</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_SWAP_ROWS</span><span class="p">,</span> <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">double</span> <span class="n">tmp</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">col1</span><span class="p">];</span>
    <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">col1</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">col2</span><span class="p">];</span>
    <span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">col2</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<p>Writing the <code class="language-plaintext highlighter-rouge">nml_mat_col_swap(...)</code> version of the method will simply re-use the previous “<code class="language-plaintext highlighter-rouge">_r</code>” one:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_col_swap</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">col1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">col2</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_cp</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nml_mat_col_swap_r</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<h3 id="horizontal-concatenation-of-two-matrices">Horizontal Concatenation of two matrices<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#horizontal-concatenation-of-two-matrices" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>This functionality is probably not very useful from a “scientific” point of view, but it’s a nice exercise we can solve, and a neat “utility” we can add to the library.</p>

<p>We would like to write a function, that takes a variable number of matrices (<code class="language-plaintext highlighter-rouge">nml_mat**</code>) and returns a new matrix that represents the horizontal concatenation of those matrices.</p>

<p>It’s important that all the input matrices have the same number of columns, otherwise the horizontal concatenation won’t work.</p>

<p>Our C function will have the following signature:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_cath</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mnum</span><span class="p">,</span> <span class="n">nml_mat</span> <span class="o">**</span><span class="n">marr</span><span class="p">);</span> 
</code></pre></div></div>

<p>Where:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">unsigned int mnum</code> - represents the total number of matrices we want to (horizontally) concatenate;</li>
  <li><code class="language-plaintext highlighter-rouge">nml_mat **marr</code> - are the matrices we want to (horizontally) concatenate;</li>
</ul>

<p>Visually, the function works like this:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-34-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;5.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 10.873em; position: relative;"><span id="MJXc-Node-1679" class="mjx-math" aria-hidden="true" style="width: 100%;"><span id="MJXc-Node-1680" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -5.059em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-1681" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-1682" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-1683" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-1684" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-1685" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1686" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1687" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1688" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1689" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1690" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1691" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1692" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1693" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1694" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1695" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1696" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1697" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1698" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1699" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1700" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1701" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1702" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1703" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1704" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1705" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1706" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1707" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1708" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1709" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1710" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1711" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1712" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1713" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1714" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1715" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1716" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1717" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1718" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span><span id="MJXc-Node-1719" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-1720" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-1721" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">[</span></span><span id="MJXc-Node-1722" class="mjx-mtable" style="vertical-align: -0.25em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1723" class="mjx-mtr" style="height: 1em;"><span id="MJXc-Node-1724" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1725" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1726" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1727" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1728" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1729" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1730" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1731" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1732" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1733" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">]</span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1734" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1735" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.045em;">C</span></span><span id="MJXc-Node-1736" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-1737" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-1738" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">[</span></span><span id="MJXc-Node-1739" class="mjx-mtable" style="vertical-align: -0.95em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1740" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1741" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1742" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1743" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1744" class="mjx-mtd" style="padding: 0px 0.5em; width: 2.056em;"><span id="MJXc-Node-1745" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1746" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-1747" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1748" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 2.056em;"><span id="MJXc-Node-1749" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1750" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1751" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1752" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1753" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1754" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1755" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1756" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1757" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1758" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1759" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1760" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-1761" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1762" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>A</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>4.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mspace linebreak="newline"></mspace><mi>B</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>4.0</mn></mtd><mtd><mn>0.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mspace linebreak="newline"></mspace><mi>C</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>3.0</mn></mtd><mtd><mo>−</mo><mn>1.0</mn></mtd><mtd><mn>1.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>0.0</mn></mtd><mtd><mo>−</mo><mn>5.0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-34">A=
\begin{bmatrix}
1.0 & 2.0 & 3.0\\
0.0 & 2.0 & 4.0\\
2.0 & 1.0 & 9.0
\end{bmatrix}
\\
B=
\begin{bmatrix}
4.0 & 0.0 & 9.0\\
\end{bmatrix}
\\
C=
\begin{bmatrix}
3.0 & -1.0 & 1.0\\
2.0 & 0.0 & -5.0
\end{bmatrix}</script>

<p>Calling the method <code class="language-plaintext highlighter-rouge">nml_mat_cath(3, **[A, B, C])</code> will yield the following result:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-35-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;5.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-1763" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1764" class="mjx-mrow"><span id="MJXc-Node-1765" class="mjx-mrow"><span id="MJXc-Node-1766" class="mjx-mo" style="vertical-align: -3.081em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.55em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-1767" class="mjx-mtable" style="vertical-align: -3.75em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1768" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1769" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1770" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1771" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1772" class="mjx-mtd" style="padding: 0px 0.5em; width: 2.056em;"><span id="MJXc-Node-1773" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1774" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1775" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 2.056em;"><span id="MJXc-Node-1776" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1777" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1778" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1779" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1780" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1781" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1782" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1783" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1784" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1785" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1786" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1787" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1788" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1789" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1790" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1791" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1792" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1793" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1794" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1795" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1796" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1797" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1798" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1799" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1800" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1801" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1802" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1803" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1804" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1805" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1806" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1807" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1808" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1809" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1810" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1811" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1812" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1813" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1814" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-1815" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1816" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1817" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1818" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1819" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1820" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1821" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1822" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1823" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1824" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1825" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1826" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1827" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1828" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-1829" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1830" class="mjx-mo" style="vertical-align: -3.081em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.55em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>4.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr><mtr><mtd><mn>4.0</mn></mtd><mtd><mn>0.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr><mtr><mtd><mn>3.0</mn></mtd><mtd><mo>−</mo><mn>1.0</mn></mtd><mtd><mn>1.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>0.0</mn></mtd><mtd><mo>−</mo><mn>5.0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-35">\begin{bmatrix}
1.0 & 2.0 & 3.0\\
0.0 & 2.0 & 4.0\\
2.0 & 1.0 & 9.0\\
4.0 & 0.0 & 9.0\\
3.0 & -1.0 & 1.0\\
2.0 & 0.0 & -5.0
\end{bmatrix}</script>

<p>The corresponding C code for this implementation looks like this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_cath</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mnum</span><span class="p">,</span> <span class="n">nml_mat</span> <span class="o">**</span><span class="n">marr</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="mi">0</span><span class="o">==</span><span class="n">mnum</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// No matrices, nothing to return</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="mi">1</span><span class="o">==</span><span class="n">mnum</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// We just return the one matrix supplied as the first param</span>
    <span class="c1">// no need for additional logic</span>
    <span class="k">return</span> <span class="n">nml_mat_cp</span><span class="p">(</span><span class="n">marr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
  <span class="p">}</span>
  <span class="c1">// We calculate the total number of columns to know how to allocate memory</span>
  <span class="c1">// for the resulting matrix</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">offset</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">lrow</span><span class="p">,</span> <span class="n">ncols</span><span class="p">;</span>
  <span class="n">lrow</span> <span class="o">=</span> <span class="n">marr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span>
  <span class="n">ncols</span> <span class="o">=</span> <span class="n">marr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">mnum</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">NULL</span> <span class="o">==</span> <span class="n">marr</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="p">{</span>
      <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">INCONSITENT_ARRAY</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mnum</span><span class="p">);</span>
      <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lrow</span> <span class="o">!=</span> <span class="n">marr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_CONCATENATE_H</span><span class="p">,</span> <span class="n">lrow</span><span class="p">,</span> <span class="n">marr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">);</span>
      <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">ncols</span><span class="o">+=</span><span class="n">marr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// At this point we know how the resulting matrix looks like,</span>
  <span class="c1">// we allocate memory for it accordingly</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="n">lrow</span><span class="p">,</span> <span class="n">ncols</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// If the column index of marr[k] overflows</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">offset</span> <span class="o">==</span> <span class="n">marr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">offset</span> <span class="o">+=</span> <span class="n">marr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span>
        <span class="c1">// We jump to the next matrix in the array</span>
        <span class="n">k</span><span class="o">++</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">marr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="n">offset</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Observations:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">i</code>, <code class="language-plaintext highlighter-rouge">j</code> are used to iterate over the resulting matrix (<code class="language-plaintext highlighter-rouge">r</code>);</li>
  <li><code class="language-plaintext highlighter-rouge">k</code> is the index of the current we are concatenating;</li>
  <li><code class="language-plaintext highlighter-rouge">offset</code> is useful to determine we need to jump to next matrix that needs concatenation.</li>
</ul>

<h3 id="vertical-concatenation">Vertical concatenation<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#vertical-concatenation" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>Just like the horizontal concatenation, this functionality is not very useful for the more complex algorithms we are going to implement later in this tutorial. But, for the sake of our ~potential~ library users, and because it’s a nice exercise we will implement it.</p>

<p>The main idea is to write a function, that takes a variable number of matrices (<code class="language-plaintext highlighter-rouge">nml_mat**</code>) and returns a new matrix that represents the vertical concatenation of those matrices.</p>

<p>It’s important that all the input matrices have the same number of rows, otherwise the vertical concatenation won’t work.</p>

<p>The method signature looks like:</p>

<p><code class="language-plaintext highlighter-rouge">nml_mat *nml_mat_catv(unsigned int mnum, nml_mat **marr);</code></p>

<p>Where:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">unsigned int mnum</code> - represents the total number of matrices we want to (horizontally) concatenate;</li>
  <li><code class="language-plaintext highlighter-rouge">nml_mat **marr</code> - are the matrices we want to (horizontally) concatenate;</li>
</ul>

<p>Visually the method works like this:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-36-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 9.316em; position: relative;"><span id="MJXc-Node-1831" class="mjx-math" aria-hidden="true" style="width: 100%;"><span id="MJXc-Node-1832" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -4.307em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-1833" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-1834" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-1835" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-1836" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">[</span></span><span id="MJXc-Node-1837" class="mjx-mtable" style="vertical-align: -0.95em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1838" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1839" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1840" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1841" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1842" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1843" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1844" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1845" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1846" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1847" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1848" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1849" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1850" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1851" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1852" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1853" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1854" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1855" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1856" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1857" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1858" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">]</span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1859" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1860" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span><span id="MJXc-Node-1861" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-1862" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-1863" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">[</span></span><span id="MJXc-Node-1864" class="mjx-mtable" style="vertical-align: -0.95em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1865" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1866" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1867" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1868" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1869" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1870" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1871" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1872" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1873" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1874" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1875" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1876" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1877" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1878" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1879" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1880" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1881" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1882" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1883" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1884" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1885" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">]</span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1886" class="mjx-mspace" style="width: 0px; height: 0px;"></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>A</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>4.0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mspace linebreak="newline"></mspace><mi>B</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>4.0</mn></mtd><mtd><mn>0.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr><mtr><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mspace linebreak="newline"></mspace></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-36">A=
\begin{bmatrix}
1.0 & 2.0 & 3.0\\
0.0 & 2.0 & 4.0\\
\end{bmatrix}
\\
B=
\begin{bmatrix}
4.0 & 0.0 & 9.0\\
2.0 & 1.0 & 9.0
\end{bmatrix}
\\</script>

<p>Calling <code class="language-plaintext highlighter-rouge">nml_mat_catv(2, **[A, B])</code> will return the following result:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-37-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;9.0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-1887" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1888" class="mjx-mrow"><span id="MJXc-Node-1889" class="mjx-mrow"><span id="MJXc-Node-1890" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">[</span></span><span id="MJXc-Node-1891" class="mjx-mtable" style="vertical-align: -0.95em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1892" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1893" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.278em;"><span id="MJXc-Node-1894" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1895" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1896" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1897" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1898" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1899" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1900" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1901" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1902" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1903" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1904" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1905" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1906" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1907" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1908" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-1909" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1910" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1911" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1912" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1913" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1914" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1915" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1916" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1917" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1918" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1919" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1920" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">4.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1921" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1922" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1923" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">2.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1924" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1925" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1926" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">1.0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1927" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1928" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1929" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9.0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1930" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">]</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>3.0</mn></mtd><mtd><mn>4.0</mn></mtd><mtd><mn>0.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr><mtr><mtd><mn>0.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>4.0</mn></mtd><mtd><mn>2.0</mn></mtd><mtd><mn>1.0</mn></mtd><mtd><mn>9.0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-37">\begin{bmatrix}
1.0 & 2.0 & 3.0 & 4.0 & 0.0 & 9.0\\
0.0 & 2.0 & 4.0 & 2.0 & 1.0 & 9.0
\end{bmatrix}</script>

<p>The code implementation looks like this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Concatenates a variable number of matrices into one.</span>
<span class="c1">// The concentation is done vertically this means the matrices need to have</span>
<span class="c1">// the same number of columns, while the number of rows is allowed to</span>
<span class="c1">// be variable</span>
<span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_catv</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mnum</span><span class="p">,</span> <span class="n">nml_mat</span> <span class="o">**</span><span class="n">marr</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">==</span> <span class="n">mnum</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="n">mnum</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">nml_mat_cp</span><span class="p">(</span><span class="n">marr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
  <span class="p">}</span>
  <span class="c1">// We check to see if the matrices have the same number of columns</span>
  <span class="kt">int</span> <span class="n">lcol</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">offset</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">numrows</span><span class="p">;</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span><span class="p">;</span>
  <span class="n">lcol</span> <span class="o">=</span> <span class="n">marr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span>
  <span class="n">numrows</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">mnum</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">NULL</span><span class="o">==</span><span class="n">marr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">{</span>
      <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">INCONSITENT_ARRAY</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">mnum</span><span class="p">);</span>
      <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lcol</span> <span class="o">!=</span> <span class="n">marr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_CONCATENATE_V</span><span class="p">,</span><span class="n">lcol</span><span class="p">,</span><span class="n">marr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">);</span>
      <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// In the same time we calculate the resulting matrix number of rows</span>
    <span class="n">numrows</span><span class="o">+=</span><span class="n">marr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// At this point we know the dimensions of the resulting Matrix</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="n">numrows</span><span class="p">,</span> <span class="n">lcol</span><span class="p">);</span>
  <span class="c1">// We start copying the values one by one</span>
  <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">offset</span> <span class="o">==</span> <span class="n">marr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">offset</span> <span class="o">+=</span> <span class="n">marr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span>
        <span class="n">k</span><span class="o">++</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">marr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">offset</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">nml_mat_print</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Observations:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">i</code>, <code class="language-plaintext highlighter-rouge">j</code> are used to iterate over the resulting matrix (<code class="language-plaintext highlighter-rouge">r</code>);</li>
  <li>Compared to our previous method (<code class="language-plaintext highlighter-rouge">nml_mat_cath(..)</code>) this time we start by iterating though the columns;</li>
  <li><code class="language-plaintext highlighter-rouge">k</code> is the index of the current matrix we are concatenating;</li>
  <li><code class="language-plaintext highlighter-rouge">offset</code> is useful to determine we need to jump to next matrix that needs concatenation</li>
</ul>

<h2 id="basic-matrix-operations">Basic Matrix Operations<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#basic-matrix-operations" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<h3 id="add-two-matrices">Add two matrices<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#add-two-matrices" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>From a mathematical perspective the formula for adding two matrices A and B is quit simple:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-38-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;01&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;02&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;01&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;02&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;01&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;01&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;02&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;02&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 25.021em; position: relative;"><span id="MJXc-Node-1931" class="mjx-math" aria-hidden="true" style="width: 100%;"><span id="MJXc-Node-1932" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -5.642em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-1933" class="mjx-mrow"><span id="MJXc-Node-1934" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-1935" class="mjx-mtable" style="vertical-align: -2.35em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1936" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-1937" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.539em;"><span id="MJXc-Node-1938" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1939" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1940" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1941" class="mjx-texatom" style=""><span id="MJXc-Node-1942" class="mjx-mrow"><span id="MJXc-Node-1943" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">01</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1944" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.539em;"><span id="MJXc-Node-1945" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1946" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1947" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1948" class="mjx-texatom" style=""><span id="MJXc-Node-1949" class="mjx-mrow"><span id="MJXc-Node-1950" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">02</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1951" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.167em;"><span id="MJXc-Node-1952" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1953" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1954" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1955" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1956" class="mjx-mtd" style="padding: 0px 0.5em; width: 0px;"><span id="MJXc-Node-1957" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1958" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.609em;"><span id="MJXc-Node-1959" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1960" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1961" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1962" class="mjx-texatom" style=""><span id="MJXc-Node-1963" class="mjx-mrow"><span id="MJXc-Node-1964" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span id="MJXc-Node-1965" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1966" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1967" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1968" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1969" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1970" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1971" class="mjx-texatom" style=""><span id="MJXc-Node-1972" class="mjx-mrow"><span id="MJXc-Node-1973" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1974" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1975" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1976" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1977" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1978" class="mjx-texatom" style=""><span id="MJXc-Node-1979" class="mjx-mrow"><span id="MJXc-Node-1980" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1981" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1982" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1983" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1984" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-1985" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1986" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-1987" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1988" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-1989" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1990" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1991" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1992" class="mjx-texatom" style=""><span id="MJXc-Node-1993" class="mjx-mrow"><span id="MJXc-Node-1994" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-1995" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1996" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1997" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-1998" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1999" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2000" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2001" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2002" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2003" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2004" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2005" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2006" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2007" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2008" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2009" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2010" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2011" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2012" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2013" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2014" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2015" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2016" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2017" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2018" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2019" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2020" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2021" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2022" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2023" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2024" class="mjx-texatom" style=""><span id="MJXc-Node-2025" class="mjx-mrow"><span id="MJXc-Node-2026" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2027" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2028" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2029" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2030" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2031" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2032" class="mjx-texatom" style=""><span id="MJXc-Node-2033" class="mjx-mrow"><span id="MJXc-Node-2034" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2035" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2036" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2037" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2038" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2039" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2040" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2041" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2042" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2043" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2044" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2045" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2046" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2047" class="mjx-texatom" style=""><span id="MJXc-Node-2048" class="mjx-mrow"><span id="MJXc-Node-2049" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2050" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-2051" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-2052" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2053" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-2054" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-2055" class="mjx-mtable" style="vertical-align: -2.35em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-2056" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2057" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.439em;"><span id="MJXc-Node-2058" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2059" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2060" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2061" class="mjx-texatom" style=""><span id="MJXc-Node-2062" class="mjx-mrow"><span id="MJXc-Node-2063" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">01</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2064" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.439em;"><span id="MJXc-Node-2065" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2066" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2067" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2068" class="mjx-texatom" style=""><span id="MJXc-Node-2069" class="mjx-mrow"><span id="MJXc-Node-2070" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">02</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2071" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.167em;"><span id="MJXc-Node-2072" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2073" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2074" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2075" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2076" class="mjx-mtd" style="padding: 0px 0.5em; width: 0px;"><span id="MJXc-Node-2077" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2078" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.509em;"><span id="MJXc-Node-2079" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2080" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2081" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2082" class="mjx-texatom" style=""><span id="MJXc-Node-2083" class="mjx-mrow"><span id="MJXc-Node-2084" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span id="MJXc-Node-2085" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2086" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-2087" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2088" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2089" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2090" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2091" class="mjx-texatom" style=""><span id="MJXc-Node-2092" class="mjx-mrow"><span id="MJXc-Node-2093" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2094" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2095" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2096" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2097" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2098" class="mjx-texatom" style=""><span id="MJXc-Node-2099" class="mjx-mrow"><span id="MJXc-Node-2100" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2101" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2102" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2103" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2104" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2105" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2106" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2107" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2108" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2109" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2110" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2111" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2112" class="mjx-texatom" style=""><span id="MJXc-Node-2113" class="mjx-mrow"><span id="MJXc-Node-2114" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-2115" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2116" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-2117" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2118" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2119" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2120" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2121" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2122" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2123" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2124" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2125" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2126" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2127" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2128" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2129" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2130" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2131" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2132" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2133" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2134" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2135" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2136" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2137" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2138" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2139" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2140" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2141" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2142" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2143" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2144" class="mjx-texatom" style=""><span id="MJXc-Node-2145" class="mjx-mrow"><span id="MJXc-Node-2146" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2147" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2148" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2149" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2150" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2151" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2152" class="mjx-texatom" style=""><span id="MJXc-Node-2153" class="mjx-mrow"><span id="MJXc-Node-2154" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2155" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2156" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2157" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2158" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2159" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2160" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2161" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2162" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2163" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2164" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2165" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2166" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2167" class="mjx-texatom" style=""><span id="MJXc-Node-2168" class="mjx-mrow"><span id="MJXc-Node-2169" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2170" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-2171" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-2172" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-2173" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-2174" class="mjx-mrow"><span id="MJXc-Node-2175" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-2176" class="mjx-mtable" style="vertical-align: -2.35em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-2177" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2178" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 4.2em;"><span id="MJXc-Node-2179" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2180" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2181" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2182" class="mjx-texatom" style=""><span id="MJXc-Node-2183" class="mjx-mrow"><span id="MJXc-Node-2184" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">01</span></span></span></span></span></span><span id="MJXc-Node-2185" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2186" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2187" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2188" class="mjx-texatom" style=""><span id="MJXc-Node-2189" class="mjx-mrow"><span id="MJXc-Node-2190" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">01</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2191" class="mjx-mtd" style="padding: 0px 0.5em; width: 4.2em;"><span id="MJXc-Node-2192" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2193" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2194" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2195" class="mjx-texatom" style=""><span id="MJXc-Node-2196" class="mjx-mrow"><span id="MJXc-Node-2197" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">02</span></span></span></span></span></span><span id="MJXc-Node-2198" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2199" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2200" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2201" class="mjx-texatom" style=""><span id="MJXc-Node-2202" class="mjx-mrow"><span id="MJXc-Node-2203" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">02</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2204" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.167em;"><span id="MJXc-Node-2205" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2206" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2207" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2208" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2209" class="mjx-mtd" style="padding: 0px 0.5em; width: 0px;"><span id="MJXc-Node-2210" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2211" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 4.341em;"><span id="MJXc-Node-2212" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2213" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2214" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2215" class="mjx-texatom" style=""><span id="MJXc-Node-2216" class="mjx-mrow"><span id="MJXc-Node-2217" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span id="MJXc-Node-2218" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span id="MJXc-Node-2219" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2220" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2221" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2222" class="mjx-texatom" style=""><span id="MJXc-Node-2223" class="mjx-mrow"><span id="MJXc-Node-2224" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span id="MJXc-Node-2225" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2226" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-2227" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2228" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2229" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2230" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2231" class="mjx-texatom" style=""><span id="MJXc-Node-2232" class="mjx-mrow"><span id="MJXc-Node-2233" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span id="MJXc-Node-2234" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2235" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2236" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2237" class="mjx-texatom" style=""><span id="MJXc-Node-2238" class="mjx-mrow"><span id="MJXc-Node-2239" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2240" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2241" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2242" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2243" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2244" class="mjx-texatom" style=""><span id="MJXc-Node-2245" class="mjx-mrow"><span id="MJXc-Node-2246" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span id="MJXc-Node-2247" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2248" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2249" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2250" class="mjx-texatom" style=""><span id="MJXc-Node-2251" class="mjx-mrow"><span id="MJXc-Node-2252" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2253" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2254" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2255" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2256" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2257" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2258" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2259" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2260" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2261" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2262" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2263" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2264" class="mjx-texatom" style=""><span id="MJXc-Node-2265" class="mjx-mrow"><span id="MJXc-Node-2266" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-2267" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span id="MJXc-Node-2268" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2269" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2270" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2271" class="mjx-texatom" style=""><span id="MJXc-Node-2272" class="mjx-mrow"><span id="MJXc-Node-2273" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-2274" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2275" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-2276" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2277" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2278" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2279" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2280" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2281" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2282" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2283" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2284" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2285" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2286" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2287" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2288" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2289" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2290" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2291" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2292" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2293" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2294" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2295" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2296" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2297" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2298" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2299" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2300" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2301" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2302" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2303" class="mjx-texatom" style=""><span id="MJXc-Node-2304" class="mjx-mrow"><span id="MJXc-Node-2305" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2306" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-2307" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2308" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2309" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2310" class="mjx-texatom" style=""><span id="MJXc-Node-2311" class="mjx-mrow"><span id="MJXc-Node-2312" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2313" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2314" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2315" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2316" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2317" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2318" class="mjx-texatom" style=""><span id="MJXc-Node-2319" class="mjx-mrow"><span id="MJXc-Node-2320" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2321" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-2322" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2323" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2324" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2325" class="mjx-texatom" style=""><span id="MJXc-Node-2326" class="mjx-mrow"><span id="MJXc-Node-2327" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2328" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2329" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2330" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2331" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2332" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2333" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2334" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2335" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2336" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2337" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2338" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2339" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2340" class="mjx-texatom" style=""><span id="MJXc-Node-2341" class="mjx-mrow"><span id="MJXc-Node-2342" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2343" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span id="MJXc-Node-2344" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2345" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2346" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2347" class="mjx-texatom" style=""><span id="MJXc-Node-2348" class="mjx-mrow"><span id="MJXc-Node-2349" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2350" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-2351" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>01</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>02</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>2</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>n</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>01</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>02</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>2</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>n</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mspace linebreak="newline"></mspace><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>01</mn></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>01</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>02</mn></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>02</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>2</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>n</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-38">\begin{bmatrix}
a_{01} & a_{02} & ... && a_{0n}\\
a_{11} & a_{12} & ... && a_{1n}\\
... & ... & ... && ...\\
a_{m1} & a_{m2} & ... && a_{mn}\\
\end{bmatrix}
+
\begin{bmatrix}
b_{01} & b_{02} & ... && b_{0n}\\
b_{11} & b_{12} & ... && b_{1n}\\
... & ... & ... && ...\\
b_{m1} & b_{m2} & ... && b_{mn}\\
\end{bmatrix}
=
\\
\begin{bmatrix}
a_{01} + b_{01} & a_{02} + b_{02} & ... && a_{0n} + b_{0n}\\
a_{11} + b_{11} & a_{12} + b_{12} & ... && a_{1n} + b_{1n}\\
... & ... & ... && ...\\
a_{m1} + b_{m1} & a_{m2} + b_{m2} & ... && a_{mn} +  b_{mn}\\
\end{bmatrix}</script>

<p>Basically each element from the first matrix gets added with the corresponding element from the second matrix.</p>

<p>The corresponding C code is straightforward:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_add</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m1</span><span class="p">,</span> <span class="n">nml_mat</span> <span class="o">*</span><span class="n">m2</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_cp</span><span class="p">(</span><span class="n">m1</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nml_mat_add_r</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">m2</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">nml_mat_add_r</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m1</span><span class="p">,</span> <span class="n">nml_mat</span> <span class="o">*</span><span class="n">m2</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nml_mat_eqdim</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">NML_ERROR</span><span class="p">(</span><span class="n">CANNOT_ADD</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m1</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m2</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">m1</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">m2</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="subtracting-two-matrices">Subtracting two matrices<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#subtracting-two-matrices" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>This is very similar with to the addition, except this time each element from <code class="language-plaintext highlighter-rouge">m2</code> is subtracted from the corresponding element from <code class="language-plaintext highlighter-rouge">m1</code>:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_sub</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m1</span><span class="p">,</span> <span class="n">nml_mat</span> <span class="o">*</span><span class="n">m2</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_cp</span><span class="p">(</span><span class="n">m2</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nml_mat_sub_r</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">m2</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">nml_mat_sub_r</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m1</span><span class="p">,</span> <span class="n">nml_mat</span> <span class="o">*</span><span class="n">m2</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nml_mat_eqdim</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">NML_ERROR</span><span class="p">(</span><span class="n">CANNOT_SUBTRACT</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m1</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m2</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">m1</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="n">m2</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<h3 id="multiplying-two-matrices">Multiplying two matrices<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#multiplying-two-matrices" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>Having a matrix <code class="language-plaintext highlighter-rouge">A[m x n]</code> and a matrix <code class="language-plaintext highlighter-rouge">B[n x p]</code>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-39-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-2352" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2353" class="mjx-mrow"><span id="MJXc-Node-2354" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-2355" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-2356" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-2357" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-2358" class="mjx-mtable" style="vertical-align: -2.35em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-2359" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2360" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.539em;"><span id="MJXc-Node-2361" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2362" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2363" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2364" class="mjx-texatom" style=""><span id="MJXc-Node-2365" class="mjx-mrow"><span id="MJXc-Node-2366" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2367" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.539em;"><span id="MJXc-Node-2368" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2369" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2370" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2371" class="mjx-texatom" style=""><span id="MJXc-Node-2372" class="mjx-mrow"><span id="MJXc-Node-2373" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2374" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.167em;"><span id="MJXc-Node-2375" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2376" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2377" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2378" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2379" class="mjx-mtd" style="padding: 0px 0.5em; width: 0px;"><span id="MJXc-Node-2380" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2381" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.609em;"><span id="MJXc-Node-2382" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2383" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2384" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2385" class="mjx-texatom" style=""><span id="MJXc-Node-2386" class="mjx-mrow"><span id="MJXc-Node-2387" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-2388" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2389" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-2390" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2391" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2392" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2393" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2394" class="mjx-texatom" style=""><span id="MJXc-Node-2395" class="mjx-mrow"><span id="MJXc-Node-2396" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">21</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2397" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2398" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2399" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2400" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2401" class="mjx-texatom" style=""><span id="MJXc-Node-2402" class="mjx-mrow"><span id="MJXc-Node-2403" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">22</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2404" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2405" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2406" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2407" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2408" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2409" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2410" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2411" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2412" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2413" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2414" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2415" class="mjx-texatom" style=""><span id="MJXc-Node-2416" class="mjx-mrow"><span id="MJXc-Node-2417" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span id="MJXc-Node-2418" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2419" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-2420" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2421" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2422" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2423" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2424" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2425" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2426" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2427" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2428" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2429" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2430" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2431" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2432" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2433" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2434" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2435" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2436" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2437" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2438" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2439" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2440" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2441" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2442" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2443" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2444" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2445" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2446" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2447" class="mjx-texatom" style=""><span id="MJXc-Node-2448" class="mjx-mrow"><span id="MJXc-Node-2449" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2450" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2451" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2452" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2453" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2454" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2455" class="mjx-texatom" style=""><span id="MJXc-Node-2456" class="mjx-mrow"><span id="MJXc-Node-2457" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2458" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2459" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2460" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2461" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2462" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2463" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2464" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2465" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2466" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2467" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2468" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2469" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2470" class="mjx-texatom" style=""><span id="MJXc-Node-2471" class="mjx-mrow"><span id="MJXc-Node-2472" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2473" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-2474" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-2475" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-2476" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span><span id="MJXc-Node-2477" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-2478" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-2479" class="mjx-mo" style="vertical-align: -1.838em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.479em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-2480" class="mjx-mtable" style="vertical-align: -2.507em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-2481" class="mjx-mtr" style="height: 1.305em;"><span id="MJXc-Node-2482" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.242em;"><span id="MJXc-Node-2483" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2484" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2485" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2486" class="mjx-texatom" style=""><span id="MJXc-Node-2487" class="mjx-mrow"><span id="MJXc-Node-2488" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2489" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.242em;"><span id="MJXc-Node-2490" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2491" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2492" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2493" class="mjx-texatom" style=""><span id="MJXc-Node-2494" class="mjx-mrow"><span id="MJXc-Node-2495" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2496" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.167em;"><span id="MJXc-Node-2497" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2498" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2499" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2500" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2501" class="mjx-mtd" style="padding: 0px 0.5em; width: 0px;"><span id="MJXc-Node-2502" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2503" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.244em;"><span id="MJXc-Node-2504" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2505" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2506" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2507" class="mjx-texatom" style=""><span id="MJXc-Node-2508" class="mjx-mrow"><span id="MJXc-Node-2509" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-2510" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em;">p</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2511" class="mjx-mtr" style="height: 1.505em;"><span id="MJXc-Node-2512" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2513" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2514" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2515" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2516" class="mjx-texatom" style=""><span id="MJXc-Node-2517" class="mjx-mrow"><span id="MJXc-Node-2518" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2519" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2520" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2521" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2522" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2523" class="mjx-texatom" style=""><span id="MJXc-Node-2524" class="mjx-mrow"><span id="MJXc-Node-2525" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2526" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2527" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2528" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2529" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2530" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2531" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2532" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2533" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2534" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2535" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2536" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2537" class="mjx-texatom" style=""><span id="MJXc-Node-2538" class="mjx-mrow"><span id="MJXc-Node-2539" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span id="MJXc-Node-2540" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em;">p</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2541" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-2542" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2543" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2544" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2545" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2546" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2547" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2548" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2549" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2550" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2551" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2552" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2553" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2554" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2555" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2556" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2557" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2558" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2559" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2560" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2561" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2562" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2563" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2564" class="mjx-mtr" style="height: 1.305em;"><span id="MJXc-Node-2565" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2566" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2567" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2568" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2569" class="mjx-texatom" style=""><span id="MJXc-Node-2570" class="mjx-mrow"><span id="MJXc-Node-2571" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span><span id="MJXc-Node-2572" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2573" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2574" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2575" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2576" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2577" class="mjx-texatom" style=""><span id="MJXc-Node-2578" class="mjx-mrow"><span id="MJXc-Node-2579" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span><span id="MJXc-Node-2580" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2581" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2582" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2583" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2584" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2585" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2586" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2587" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2588" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2589" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2590" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2591" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2592" class="mjx-texatom" style=""><span id="MJXc-Node-2593" class="mjx-mrow"><span id="MJXc-Node-2594" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span><span id="MJXc-Node-2595" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em;">p</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-2596" class="mjx-mo" style="vertical-align: -1.838em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.479em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>A</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>2</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>n</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo><mi>B</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mi>p</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>p</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mn>2</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>p</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-39">A = 
\begin{bmatrix}
a_{11} & a_{12} & ... && a_{1n}\\
a_{21} & a_{22} & ... && a_{2n}\\
... & ... & ... && ...\\
a_{m1} & a_{m2} & ... && a_{mn}\\
\end{bmatrix}
, B =
\begin{bmatrix}
b_{11} & b_{12} & ... && b_{1p}\\
b_{11} & b_{12} & ... && b_{2p}\\
... & ... & ... && ...\\
b_{n1} & b_{n2} & ... && b_{np}\\
\end{bmatrix}</script>

<p>We define the product <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-40-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-2597" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2598" class="mjx-mrow"><span id="MJXc-Node-2599" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-2600" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2601" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span><span id="MJXc-Node-2602" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-2603" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.045em;">C</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>∗</mo><mi>B</mi><mo>=</mo><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">A * B = C</script>, where <code class="language-plaintext highlighter-rouge">C [m x p]</code>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-41-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-2604" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2605" class="mjx-mrow"><span id="MJXc-Node-2606" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.045em;">C</span></span><span id="MJXc-Node-2607" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-2608" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-2609" class="mjx-mo" style="vertical-align: -1.838em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.479em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-2610" class="mjx-mtable" style="vertical-align: -2.507em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-2611" class="mjx-mtr" style="height: 1.305em;"><span id="MJXc-Node-2612" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.443em;"><span id="MJXc-Node-2613" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2614" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2615" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2616" class="mjx-texatom" style=""><span id="MJXc-Node-2617" class="mjx-mrow"><span id="MJXc-Node-2618" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2619" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.443em;"><span id="MJXc-Node-2620" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2621" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2622" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2623" class="mjx-texatom" style=""><span id="MJXc-Node-2624" class="mjx-mrow"><span id="MJXc-Node-2625" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2626" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.167em;"><span id="MJXc-Node-2627" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2628" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2629" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2630" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2631" class="mjx-mtd" style="padding: 0px 0.5em; width: 0px;"><span id="MJXc-Node-2632" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2633" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.445em;"><span id="MJXc-Node-2634" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2635" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2636" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2637" class="mjx-texatom" style=""><span id="MJXc-Node-2638" class="mjx-mrow"><span id="MJXc-Node-2639" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-2640" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em;">p</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2641" class="mjx-mtr" style="height: 1.505em;"><span id="MJXc-Node-2642" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2643" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2644" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2645" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2646" class="mjx-texatom" style=""><span id="MJXc-Node-2647" class="mjx-mrow"><span id="MJXc-Node-2648" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2649" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2650" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2651" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2652" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2653" class="mjx-texatom" style=""><span id="MJXc-Node-2654" class="mjx-mrow"><span id="MJXc-Node-2655" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2656" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2657" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2658" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2659" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2660" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2661" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2662" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2663" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2664" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2665" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2666" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2667" class="mjx-texatom" style=""><span id="MJXc-Node-2668" class="mjx-mrow"><span id="MJXc-Node-2669" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span id="MJXc-Node-2670" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em;">p</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2671" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-2672" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2673" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2674" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2675" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2676" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2677" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2678" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2679" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2680" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2681" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2682" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2683" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2684" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2685" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2686" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2687" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2688" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2689" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2690" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2691" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2692" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2693" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2694" class="mjx-mtr" style="height: 1.305em;"><span id="MJXc-Node-2695" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2696" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2697" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2698" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2699" class="mjx-texatom" style=""><span id="MJXc-Node-2700" class="mjx-mrow"><span id="MJXc-Node-2701" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2702" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2703" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2704" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2705" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2706" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2707" class="mjx-texatom" style=""><span id="MJXc-Node-2708" class="mjx-mrow"><span id="MJXc-Node-2709" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2710" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2711" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2712" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2713" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2714" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2715" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2716" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2717" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2718" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2719" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2720" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2721" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2722" class="mjx-texatom" style=""><span id="MJXc-Node-2723" class="mjx-mrow"><span id="MJXc-Node-2724" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-2725" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em;">p</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-2726" class="mjx-mo" style="vertical-align: -1.838em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.479em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mi>p</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>p</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>2</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>p</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-41">C =
\begin{bmatrix}
c_{11} & c_{12} & ... && c_{1p}\\
c_{11} & c_{12} & ... && c_{2p}\\
... & ... & ... && ...\\
c_{m1} & c_{m2} & ... && c_{mp}\\
\end{bmatrix}</script>

<p>Where:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-42-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-2727" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2728" class="mjx-mrow"><span id="MJXc-Node-2729" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2730" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2731" class="mjx-texatom" style=""><span id="MJXc-Node-2732" class="mjx-mrow"><span id="MJXc-Node-2733" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span><span id="MJXc-Node-2734" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.464em;">j</span></span></span></span></span></span><span id="MJXc-Node-2735" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-2736" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-2737" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2738" class="mjx-texatom" style=""><span id="MJXc-Node-2739" class="mjx-mrow"><span id="MJXc-Node-2740" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span><span id="MJXc-Node-2741" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-2742" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2743" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2744" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2745" class="mjx-texatom" style=""><span id="MJXc-Node-2746" class="mjx-mrow"><span id="MJXc-Node-2747" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-2748" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.464em;">j</span></span></span></span></span></span><span id="MJXc-Node-2749" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2750" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2751" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2752" class="mjx-texatom" style=""><span id="MJXc-Node-2753" class="mjx-mrow"><span id="MJXc-Node-2754" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span><span id="MJXc-Node-2755" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-2756" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2757" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2758" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2759" class="mjx-texatom" style=""><span id="MJXc-Node-2760" class="mjx-mrow"><span id="MJXc-Node-2761" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span id="MJXc-Node-2762" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.464em;">j</span></span></span></span></span></span><span id="MJXc-Node-2763" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2764" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2765" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2766" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-2767" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2768" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2769" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2770" class="mjx-texatom" style=""><span id="MJXc-Node-2771" class="mjx-mrow"><span id="MJXc-Node-2772" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span><span id="MJXc-Node-2773" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span id="MJXc-Node-2774" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2775" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2776" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2777" class="mjx-texatom" style=""><span id="MJXc-Node-2778" class="mjx-mrow"><span id="MJXc-Node-2779" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span><span id="MJXc-Node-2780" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.464em;">j</span></span></span></span></span></span><span id="MJXc-Node-2781" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-2782" class="mjx-munderover MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-2783" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.506em; padding-bottom: 0.506em;">∑</span></span></span><span class="mjx-stack" style="vertical-align: -0.31em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.394em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-2789" class="mjx-texatom" style=""><span id="MJXc-Node-2790" class="mjx-mrow"><span id="MJXc-Node-2791" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-2784" class="mjx-texatom" style=""><span id="MJXc-Node-2785" class="mjx-mrow"><span id="MJXc-Node-2786" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">k</span></span><span id="MJXc-Node-2787" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-2788" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-2792" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-2793" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-2794" class="mjx-texatom" style=""><span id="MJXc-Node-2795" class="mjx-mrow"><span id="MJXc-Node-2796" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span><span id="MJXc-Node-2797" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">k</span></span></span></span></span></span><span id="MJXc-Node-2798" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2799" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2800" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-2801" class="mjx-texatom" style=""><span id="MJXc-Node-2802" class="mjx-mrow"><span id="MJXc-Node-2803" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">k</span></span><span id="MJXc-Node-2804" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.464em;">j</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mn>1</mn></mrow></msub><mo>∗</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mn>2</mn></mrow></msub><mo>∗</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>j</mi></mrow></msub><mo>+</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>+</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi></mrow></msub><mo>∗</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>j</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></munderover><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mo>∗</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-42">c_{ij} = a_{i1} * b_{1j} + a_{i2} * b_{2j} + ... + a_{in} * b_{nj} = \sum_{k=1}^{n} a_{ik} * b_{kj}</script>, for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-43-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mn&gt;1..&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-2805" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2806" class="mjx-mrow"><span id="MJXc-Node-2807" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span><span id="MJXc-Node-2808" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.212em; padding-bottom: 0.338em;">→</span></span><span id="MJXc-Node-2809" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1..</span></span><span id="MJXc-Node-2810" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo stretchy="false">→</mo><mn>1..</mn><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-43">i \rightarrow 1..m</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-44-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mn&gt;1..&lt;/mn&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-2811" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2812" class="mjx-mrow"><span id="MJXc-Node-2813" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.464em;">j</span></span><span id="MJXc-Node-2814" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.212em; padding-bottom: 0.338em;">→</span></span><span id="MJXc-Node-2815" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1..</span></span><span id="MJXc-Node-2816" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">→</mo><mn>1..</mn><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">j \rightarrow 1..p</script>.</p>

<p>The product <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-45-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-2817" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2818" class="mjx-mrow"><span id="MJXc-Node-2819" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-2820" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2821" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>∗</mo><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-45">A*B</script> is defined if and only if the number of columns in <code class="language-plaintext highlighter-rouge">A</code> equals the number of rows in <code class="language-plaintext highlighter-rouge">B</code>, which is <code class="language-plaintext highlighter-rouge">n</code>.</p>

<p>The resulting product matrix will then “inherit” the number of rows from <code class="language-plaintext highlighter-rouge">A</code> and the number of columns from <code class="language-plaintext highlighter-rouge">B</code>.</p>

<p>The formula is more easy to digest if we follow a simple example:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-46-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 6.973em; position: relative;"><span id="MJXc-Node-2822" class="mjx-math" aria-hidden="true" style="width: 100%;"><span id="MJXc-Node-2823" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -5.658em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-2824" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-2825" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-2826" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-2827" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">[</span></span><span id="MJXc-Node-2828" class="mjx-mtable" style="vertical-align: -0.95em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-2829" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2830" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-2831" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2832" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2833" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-2834" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2835" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2836" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-2837" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2838" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2839" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2840" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2841" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2842" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2843" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2844" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2845" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2846" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2847" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2848" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-2849" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">]</span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-2850" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-2851" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span><span id="MJXc-Node-2852" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-2853" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-2854" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-2855" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-2856" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2857" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-2858" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2859" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2860" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-2861" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2862" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2863" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-2864" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2865" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2866" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2867" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2868" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2869" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2870" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2871" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2872" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2873" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2874" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2875" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2876" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-2877" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-2878" class="mjx-mspace" style="width: 0px; height: 0px;"></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>A</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>3</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>4</mn></mtd></mtr></mtable><mo>]</mo></mrow><mspace linebreak="newline"></mspace><mi>B</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>2</mn></mtd><mtd><mn>3</mn></mtd></mtr><mtr><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>5</mn></mtd></mtr></mtable><mo>]</mo></mrow><mspace linebreak="newline"></mspace></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-46">A=
\begin{bmatrix}
1 & 2 & 3\\
0 & 0 & 4
\end{bmatrix}
\\
B=
\begin{bmatrix}
2 & 3 \\
2 & 1 \\
1 & 5
\end{bmatrix}
\\</script>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-47-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-2879" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2880" class="mjx-mrow"><span id="MJXc-Node-2881" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-2882" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2883" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>∗</mo><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">A*B</script> exists because <code class="language-plaintext highlighter-rouge">A[2x3]</code> and <code class="language-plaintext highlighter-rouge">B[3x2]</code>. The resulting matrix <code class="language-plaintext highlighter-rouge">C</code> will be <code class="language-plaintext highlighter-rouge">2x2</code>.</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-48-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;20&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;20&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-2884" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2885" class="mjx-mrow"><span id="MJXc-Node-2886" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.045em;">C</span></span><span id="MJXc-Node-2887" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-2888" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-2889" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">[</span></span><span id="MJXc-Node-2890" class="mjx-mtable" style="vertical-align: -0.95em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-2891" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2892" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 8.278em;"><span id="MJXc-Node-2893" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2894" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-2895" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2896" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span id="MJXc-Node-2897" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2898" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span id="MJXc-Node-2899" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2900" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span id="MJXc-Node-2901" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2902" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span id="MJXc-Node-2903" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2904" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2905" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 8.278em;"><span id="MJXc-Node-2906" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2907" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-2908" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2909" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span id="MJXc-Node-2910" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2911" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span id="MJXc-Node-2912" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2913" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-2914" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2915" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span id="MJXc-Node-2916" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2917" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2918" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2919" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2920" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2921" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span id="MJXc-Node-2922" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2923" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span id="MJXc-Node-2924" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2925" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span id="MJXc-Node-2926" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2927" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span id="MJXc-Node-2928" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2929" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span id="MJXc-Node-2930" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2931" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2932" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2933" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2934" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span id="MJXc-Node-2935" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2936" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span id="MJXc-Node-2937" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2938" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span id="MJXc-Node-2939" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2940" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-2941" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-2942" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span id="MJXc-Node-2943" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-2944" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-2945" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">]</span></span></span><span id="MJXc-Node-2946" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-2947" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-2948" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">[</span></span><span id="MJXc-Node-2949" class="mjx-mtable" style="vertical-align: -0.95em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-2950" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2951" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-2952" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2953" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">9</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2954" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1em;"><span id="MJXc-Node-2955" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2956" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">20</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2957" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2958" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2959" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2960" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2961" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2962" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2963" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">20</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-2964" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">]</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn><mo>∗</mo><mn>2</mn><mo>+</mo><mn>2</mn><mo>∗</mo><mn>2</mn><mo>+</mo><mn>3</mn><mo>∗</mo><mn>1</mn></mtd><mtd><mn>1</mn><mo>∗</mo><mn>3</mn><mo>+</mo><mn>2</mn><mo>∗</mo><mn>1</mn><mo>+</mo><mn>3</mn><mo>∗</mo><mn>5</mn></mtd></mtr><mtr><mtd><mn>0</mn><mo>∗</mo><mn>2</mn><mo>+</mo><mn>0</mn><mo>∗</mo><mn>2</mn><mo>+</mo><mn>4</mn><mo>∗</mo><mn>1</mn></mtd><mtd><mn>0</mn><mo>∗</mo><mn>3</mn><mo>+</mo><mn>0</mn><mo>∗</mo><mn>1</mn><mo>+</mo><mn>4</mn><mo>∗</mo><mn>5</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>9</mn></mtd><mtd><mn>20</mn></mtd></mtr><mtr><mtd><mn>4</mn></mtd><mtd><mn>20</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-48">C=
\begin{bmatrix}
1 * 2 + 2 * 2 + 3 * 1 & 1 * 3 + 2 * 1 + 3 * 5 \\
0 * 2 + 0 * 2 + 4 * 1 & 0 * 3 + 0 * 1 + 4 * 5 \\
\end{bmatrix}
=
\begin{bmatrix}
9 & 20 \\
4 & 20 \\
\end{bmatrix}</script>

<p>The naive C implementation for this algorithm looks like:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_dot</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m1</span><span class="p">,</span> <span class="n">nml_mat</span> <span class="o">*</span><span class="n">m2</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">m1</span><span class="o">-&gt;</span><span class="n">num_cols</span> <span class="o">==</span> <span class="n">m2</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">NML_ERROR</span><span class="p">(</span><span class="n">CANNOT_MULITPLY</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">;</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="n">m1</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">m2</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span><span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">m1</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">m1</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">m2</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Better algorithms exists for matrix multiplications, if you want to find out more please check this wikipedia <a href="https://en.wikipedia.org/wiki/Matrix_multiplication_algorithm">article</a>.</p>

<h2 id="row-echelon-form">Row Echelon Form<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#row-echelon-form" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<p>A matrix <code class="language-plaintext highlighter-rouge">A</code> is in <em>Row Echelon Form</em> if it has the shape resulting from a Gaussian Elimination.</p>

<p>Additionally, the matrix <code class="language-plaintext highlighter-rouge">A</code> is in Row Echelon form if:</p>
<ul>
  <li>The first non-zero element for each row is exactly <code class="language-plaintext highlighter-rouge">1.0</code>;</li>
  <li>Rows with all <code class="language-plaintext highlighter-rouge">0.0</code> elements are bellow rows that have at least one non-zero element.</li>
  <li>Each leading entry (pivot) is in a column to the right of the leading entry in the previous row.</li>
</ul>

<p>All the bellow matrices are examples of matrices that have been “morphed” into Row Echelon Form:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-49-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 8.76em; position: relative;"><span id="MJXc-Node-2965" class="mjx-math" aria-hidden="true" style="width: 100%;"><span id="MJXc-Node-2966" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -13.376em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-2967" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-2968" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-2969" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-2970" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-2971" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-2972" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2973" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-2974" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2975" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2976" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-2977" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2978" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2979" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-2980" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2981" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2982" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-2983" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2984" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2985" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-2986" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-2987" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2988" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2989" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2990" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2991" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2992" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-2993" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2994" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2995" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-2996" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2997" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2998" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-2999" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3000" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3001" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3002" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3003" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3004" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3005" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3006" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3007" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3008" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3009" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3010" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3011" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-3012" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-3013" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span><span id="MJXc-Node-3014" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-3015" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-3016" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3017" class="mjx-mtable" style="vertical-align: -2.35em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3018" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3019" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3020" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3021" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3022" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3023" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3024" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3025" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3026" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3027" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3028" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3029" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3030" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3031" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3032" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3033" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3034" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3035" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3036" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3037" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3038" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3039" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3040" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3041" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3042" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3043" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3044" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3045" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3046" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3047" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3048" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3049" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3050" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3051" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3052" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3053" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3054" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3055" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3056" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3057" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3058" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3059" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3060" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3061" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3062" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3063" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3064" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3065" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3066" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3067" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3068" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3069" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3070" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-3071" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-3072" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.045em;">C</span></span><span id="MJXc-Node-3073" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-3074" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-3075" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3076" class="mjx-mtable" style="vertical-align: -2.35em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3077" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3078" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3079" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3080" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3081" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3082" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3083" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3084" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3085" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3086" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3087" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3088" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3089" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3090" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3091" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3092" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3093" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3094" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3095" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3096" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3097" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3098" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3099" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3100" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3101" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3102" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3103" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3104" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3105" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-3106" class="mjx-mspace" style="width: 0px; height: 0px;"></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>A</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>4</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>3</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mspace linebreak="newline"></mspace><mi>B</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>4</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>3</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mspace linebreak="newline"></mspace><mi>C</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mspace linebreak="newline"></mspace></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-49">A=
\begin{bmatrix}
1 & 2 & 3 & 4 \\
0 & 0 & 1 & 3 \\
0 & 0 & 0 & 1 
\end{bmatrix}
\\
B=
\begin{bmatrix}
1 & 2 & 3 & 4 \\
0 & 0 & 1 & 3 \\
0 & 0 & 0 & 1 \\
0 & 0 & 0 & 0
\end{bmatrix}
\\
C=
\begin{bmatrix}
1 & 2 \\
0 & 1 \\
0 & 0 \\
0 & 0
\end{bmatrix}
\\</script>

<p>Every matrix can be transformed into a Row Echelon, by using <em>elementary row operations</em>:</p>
<ul>
  <li>Interchanging (swapping) two rows. See <code class="language-plaintext highlighter-rouge">nml_mat_row_swap_r(...)</code> implemented before;</li>
  <li>Multiply each element in a row by a non-zero number (scalar multiplication of rows). See <code class="language-plaintext highlighter-rouge">nml_mat_row_mult_r(...)</code> implemented before;</li>
  <li>Multiply a row by a non-zero number and add the result to another row (row addition). See <code class="language-plaintext highlighter-rouge">nml_mat_row_addrow_r(...)</code> implemented before;</li>
</ul>

<p>The algorithm to transform the matrix in a Row Echelon Form is as follows:</p>
<ol>
  <li>Find the “pivot”, the first non-zero entry from the first column of the matrix;
    <ul>
      <li>If the column has only zero elements, jump to the next column;</li>
    </ul>
  </li>
  <li>Interchange rows, moving the pivot row to become the first row;</li>
  <li>Multiply each element in the pivot by the inverse of the pivot <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-50-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-3107" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3108" class="mjx-mrow"><span id="MJXc-Node-3109" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.682em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.379em; top: -1.266em;"><span id="MJXc-Node-3110" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.379em; bottom: -0.748em;"><span id="MJXc-Node-3111" class="mjx-mrow" style=""><span id="MJXc-Node-3112" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em;">p</span></span><span id="MJXc-Node-3113" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span><span id="MJXc-Node-3114" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">v</span></span><span id="MJXc-Node-3115" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-3116" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">t</span></span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 1.682em;"></span></span><span class="mjx-vsize" style="height: 1.424em; vertical-align: -0.529em;"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mrow><mi>p</mi><mi>i</mi><mi>v</mi><mi>o</mi><mi>t</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-50">\frac{1}{pivot}</script> so that the pivot equals <code class="language-plaintext highlighter-rouge">1.0</code>;</li>
  <li>Add multiplies of the pivot row to each of the pivot rows, so every element in the pivot column will equal <code class="language-plaintext highlighter-rouge">0.0</code>.</li>
  <li>Continue the process until there are no more pivots to process.</li>
</ol>

<p><em>Note:</em> A matrix can have multiple Row Echelon Forms, but you will see in the next chapter, there’s only one Reduced Row Echelon Form.</p>

<h3 id="example">Example<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#example" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>Let’s take for example the following matrix, <code class="language-plaintext highlighter-rouge">A[3x3]</code>. <code class="language-plaintext highlighter-rouge">REF(A)</code> is also a <code class="language-plaintext highlighter-rouge">3x3</code> matrix. The transitions are:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-51-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 26.919em; position: relative;"><span id="MJXc-Node-3117" class="mjx-math" aria-hidden="true" style="width: 100%;"><span id="MJXc-Node-3118" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -4.242em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-3119" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-3120" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-3121" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-3122" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3123" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3124" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3125" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3126" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3127" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3128" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3129" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3130" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3131" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3132" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3133" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3134" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3135" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3136" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3137" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3138" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3139" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3140" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3141" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3142" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3143" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3144" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3145" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3146" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3147" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3148" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3149" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3150" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">7</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3151" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3152" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3153" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">8</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3154" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-3155" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.212em; padding-bottom: 0.338em;">→</span></span><span id="MJXc-Node-3156" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-3157" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3158" class="mjx-texatom" style=""><span id="MJXc-Node-3159" class="mjx-mrow"><span id="MJXc-Node-3160" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-3161" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-3162" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-3163" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3164" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3165" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3166" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3167" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3168" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3169" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3170" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3171" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3172" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3173" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3174" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3175" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3176" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3177" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3178" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3179" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3180" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3181" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3182" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3183" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3184" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3185" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3186" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3187" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3188" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3189" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3190" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3191" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">7</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3192" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3193" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3194" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">8</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3195" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-3196" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.212em; padding-bottom: 0.338em;">→</span></span><span id="MJXc-Node-3197" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-3198" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3199" class="mjx-texatom" style=""><span id="MJXc-Node-3200" class="mjx-mrow"><span id="MJXc-Node-3201" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-3202" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-3203" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-3204" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3205" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3206" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3207" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3208" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3209" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3210" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3211" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3212" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3213" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3214" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3215" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3216" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3217" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3218" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3219" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3220" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3221" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3222" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3223" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3224" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3225" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3226" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3227" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3228" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3229" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3230" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3231" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3232" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3233" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3234" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3235" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">6</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3236" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-3237" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.212em; padding-bottom: 0.338em;">→</span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-3238" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-3239" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3240" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-3241" class="mjx-texatom" style=""><span id="MJXc-Node-3242" class="mjx-mrow"><span id="MJXc-Node-3243" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">r</span></span><span id="MJXc-Node-3244" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-3245" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.464em; padding-right: 0.06em;">f</span></span></span></span></span></span><span id="MJXc-Node-3246" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-3247" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-3248" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3249" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3250" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3251" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3252" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3253" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3254" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3255" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3256" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3257" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3258" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3259" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3260" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3261" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3262" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3263" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3264" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3265" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3266" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3267" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3268" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3269" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3270" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3271" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3272" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3273" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3274" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3275" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3276" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3277" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3278" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3279" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3280" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>A</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>2</mn></mtd><mtd><mn>7</mn></mtd><mtd><mn>8</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo stretchy="false">→</mo><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mn>2</mn></mtd><mtd><mn>7</mn></mtd><mtd><mn>8</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo stretchy="false">→</mo><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>6</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo stretchy="false">→</mo><mspace linebreak="newline"></mspace><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-51">A=
\begin{bmatrix}
0 & 1 & 2 \\
1 & 2 & 1 \\
2 & 7 & 8
\end{bmatrix}
\rightarrow
A_{1}=
\begin{bmatrix}
1 & 2 & 1 \\
0 & 1 & 2 \\
2 & 7 & 8
\end{bmatrix}
\rightarrow
A_{2} =
\begin{bmatrix}
1 & 2 & 1 \\
0 & 1 & 2 \\
0 & 3 & 6
\end{bmatrix}
\rightarrow
\\
A_{ref}  =
\begin{bmatrix}
1 & 2 & 1 \\
0 & 1 & 2 \\
0 & 0 & 0
\end{bmatrix}</script>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-52-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-3281" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3282" class="mjx-mrow"><span id="MJXc-Node-3283" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-3284" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.212em; padding-bottom: 0.338em;">→</span></span><span id="MJXc-Node-3285" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-3286" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3287" class="mjx-texatom" style=""><span id="MJXc-Node-3288" class="mjx-mrow"><span id="MJXc-Node-3289" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo stretchy="false">→</mo><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-52">A \rightarrow A_{1}</script>: We found out that the first non-zero element of the first <code class="language-plaintext highlighter-rouge">column[0]</code> is <code class="language-plaintext highlighter-rouge">1</code> on <code class="language-plaintext highlighter-rouge">row[1]</code> so we’ve swapped <code class="language-plaintext highlighter-rouge">row[0]</code> with <code class="language-plaintext highlighter-rouge">row[1]</code>. Using our code this means:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-53-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;nml_mat_row_swap_r(&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;, 0, 1)=&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-3290" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3291" class="mjx-mrow"><span id="MJXc-Node-3292" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">nml_mat_row_swap_r(</span></span><span id="MJXc-Node-3293" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-3294" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3295" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3296" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3297" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3298" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3299" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3300" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3301" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3302" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3303" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3304" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3305" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3306" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3307" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3308" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3309" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3310" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3311" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3312" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3313" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3314" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3315" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3316" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3317" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3318" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3319" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3320" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3321" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3322" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">7</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3323" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3324" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3325" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">8</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3326" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-3327" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">, 0, 1)=</span></span><span id="MJXc-Node-3328" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-3329" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3330" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3331" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3332" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3333" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3334" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3335" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3336" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3337" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3338" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3339" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3340" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3341" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3342" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3343" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3344" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3345" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3346" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3347" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3348" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3349" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3350" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3351" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3352" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3353" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3354" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3355" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3356" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3357" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">7</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3358" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3359" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3360" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">8</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3361" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>nml_mat_row_swap_r(</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>2</mn></mtd><mtd><mn>7</mn></mtd><mtd><mn>8</mn></mtd></mtr></mtable><mo>]</mo></mrow><mtext>, 0, 1)=</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mn>2</mn></mtd><mtd><mn>7</mn></mtd><mtd><mn>8</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-53">\text{nml_mat_row_swap_r(}
\begin{bmatrix}
0 & 1 & 2 \\
1 & 2 & 1 \\
2 & 7 & 8
\end{bmatrix}
\text{, 0, 1)=}
\begin{bmatrix}
1 & 2 & 1 \\
0 & 1 & 2 \\
2 & 7 & 8
\end{bmatrix}</script>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-54-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-3362" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3363" class="mjx-mrow"><span id="MJXc-Node-3364" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3365" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3366" class="mjx-texatom" style=""><span id="MJXc-Node-3367" class="mjx-mrow"><span id="MJXc-Node-3368" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-3369" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.212em; padding-bottom: 0.338em;">→</span></span><span id="MJXc-Node-3370" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-3371" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3372" class="mjx-texatom" style=""><span id="MJXc-Node-3373" class="mjx-mrow"><span id="MJXc-Node-3374" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo stretchy="false">→</mo><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-54">A_{1} \rightarrow A_{2}</script>: For <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-55-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-3375" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3376" class="mjx-mrow"><span id="MJXc-Node-3377" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3378" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3379" class="mjx-texatom" style=""><span id="MJXc-Node-3380" class="mjx-mrow"><span id="MJXc-Node-3381" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-55">A_{1}</script> we’ve multiplied each element of <code class="language-plaintext highlighter-rouge">row[0]</code> with <code class="language-plaintext highlighter-rouge">-2</code> and added the result to <code class="language-plaintext highlighter-rouge">row[2]</code>. Using our code this means:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-56-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;nml_mat_row_addrow_r(&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;, 2, 0, -2.0)=&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-3382" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3383" class="mjx-mrow"><span id="MJXc-Node-3384" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">nml_mat_row_addrow_r(</span></span><span id="MJXc-Node-3385" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-3386" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3387" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3388" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3389" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3390" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3391" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3392" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3393" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3394" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3395" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3396" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3397" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3398" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3399" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3400" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3401" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3402" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3403" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3404" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3405" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3406" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3407" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3408" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3409" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3410" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3411" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3412" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3413" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3414" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">7</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3415" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3416" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3417" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">8</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3418" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-3419" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">, 2, 0, -2.0)=</span></span><span id="MJXc-Node-3420" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-3421" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3422" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3423" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3424" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3425" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3426" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3427" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3428" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3429" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3430" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3431" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3432" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3433" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3434" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3435" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3436" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3437" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3438" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3439" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3440" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3441" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3442" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3443" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3444" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3445" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3446" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3447" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3448" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3449" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3450" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3451" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3452" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">6</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3453" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>nml_mat_row_addrow_r(</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mn>2</mn></mtd><mtd><mn>7</mn></mtd><mtd><mn>8</mn></mtd></mtr></mtable><mo>]</mo></mrow><mtext>, 2, 0, -2.0)=</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>6</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-56">\text{nml_mat_row_addrow_r(}
\begin{bmatrix}
1 & 2 & 1 \\
0 & 1 & 2 \\
2 & 7 & 8
\end{bmatrix}
\text{, 2, 0, -2.0)=}
\begin{bmatrix}
1 & 2 & 1 \\
0 & 1 & 2 \\
0 & 3 & 6
\end{bmatrix}</script>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-57-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-3454" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3455" class="mjx-mrow"><span id="MJXc-Node-3456" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3457" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3458" class="mjx-texatom" style=""><span id="MJXc-Node-3459" class="mjx-mrow"><span id="MJXc-Node-3460" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-3461" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.212em; padding-bottom: 0.338em;">→</span></span><span id="MJXc-Node-3462" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-3463" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-3464" class="mjx-texatom" style=""><span id="MJXc-Node-3465" class="mjx-mrow"><span id="MJXc-Node-3466" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">r</span></span><span id="MJXc-Node-3467" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-3468" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.464em; padding-right: 0.06em;">f</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo stretchy="false">→</mo><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-57">A_{2} \rightarrow A_{ref}</script>: For <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-58-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-3469" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3470" class="mjx-mrow"><span id="MJXc-Node-3471" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3472" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3473" class="mjx-texatom" style=""><span id="MJXc-Node-3474" class="mjx-mrow"><span id="MJXc-Node-3475" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-58">A_{2}</script> we’ve multiplied <code class="language-plaintext highlighter-rouge">row[1]</code> with <code class="language-plaintext highlighter-rouge">-3</code> and added the result to <code class="language-plaintext highlighter-rouge">row[2]</code>. Using the code this means:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-59-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;nml_mat_row_addrow_r(&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;, 2, 1, -2.0)=&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-3476" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3477" class="mjx-mrow"><span id="MJXc-Node-3478" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">nml_mat_row_addrow_r(</span></span><span id="MJXc-Node-3479" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-3480" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3481" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3482" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3483" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3484" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3485" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3486" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3487" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3488" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3489" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3490" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3491" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3492" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3493" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3494" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3495" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3496" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3497" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3498" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3499" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3500" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3501" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3502" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3503" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3504" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3505" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3506" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3507" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3508" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3509" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3510" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3511" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">6</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3512" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-3513" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">, 2, 1, -2.0)=</span></span><span id="MJXc-Node-3514" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-3515" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3516" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3517" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3518" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3519" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3520" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3521" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3522" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3523" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3524" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3525" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3526" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3527" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3528" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3529" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3530" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3531" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3532" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3533" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3534" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3535" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3536" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3537" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3538" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3539" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3540" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3541" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3542" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3543" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3544" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3545" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3546" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3547" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>nml_mat_row_addrow_r(</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>6</mn></mtd></mtr></mtable><mo>]</mo></mrow><mtext>, 2, 1, -2.0)=</mtext><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-59">\text{nml_mat_row_addrow_r(}
\begin{bmatrix}
1 & 2 & 1 \\
0 & 1 & 2 \\
0 & 3 & 6
\end{bmatrix}
\text{, 2, 1, -2.0)=}
\begin{bmatrix}
1 & 2 & 1 \\
0 & 1 & 2 \\
0 & 0 & 0
\end{bmatrix}</script>

<h3 id="code-implementation">Code implementation<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#code-implementation" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>Most of the bits and pieces for assembling the algorithm, were already implemented before: <code class="language-plaintext highlighter-rouge">nml_mat_row_swap_r(...)</code>, <code class="language-plaintext highlighter-rouge">nml_mat_row_mult_r(...)</code>, <code class="language-plaintext highlighter-rouge">nml_mat_row_addrow_r(...)</code>.</p>

<p>What we are missing at this moment to assemble the algorithm is to write the “pivot function”. We are going to call this: <code class="language-plaintext highlighter-rouge">_nml_mat_pivotidx(...)</code>:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Finds the first non-zero element on the col column, under the row row.</span>
<span class="c1">// This is used to determine the pivot in gauss Elimination</span>
<span class="c1">// If not pivot is found, returns -1</span>
<span class="kt">int</span> <span class="nf">_nml_mat_pivotidx</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">col</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// No validations are made, this is an API Method</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">row</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">NML_MIN_COEF</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>At this point the algorithm is straight-forward to implement:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Retrieves the matrix in Row Echelon form using Gauss Elimination</span>
<span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_ref</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_cp</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">pivot</span><span class="p">;</span>
  <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="c1">// We iterate until we exhaust the columns and the rows</span>
  <span class="k">while</span><span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_cols</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Find the pivot - the first non-zero entry in the first column of the matrix</span>
    <span class="n">pivot</span> <span class="o">=</span> <span class="n">_nml_mat_pivotidx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pivot</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// All elements on the column are zeros</span>
      <span class="c1">// We move to the next column without doing anything</span>
      <span class="n">j</span><span class="o">++</span><span class="p">;</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// We interchange rows moving the pivot to the first row that doesn't have</span>
    <span class="c1">// already a pivot in place</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pivot</span><span class="o">!=</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">nml_mat_row_swap_r</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">pivot</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">// Multiply each element in the pivot row by the inverse of the pivot</span>
    <span class="n">nml_mat_row_mult_r</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
    <span class="c1">// We add multiplies of the pivot so every element on the column equals 0</span>
    <span class="k">for</span><span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">NML_MIN_COEF</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">nml_mat_row_addrow_r</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]));</span>
      <span class="p">}</span> 
    <span class="p">}</span>
    <span class="n">i</span><span class="o">++</span><span class="p">;</span>
    <span class="n">j</span><span class="o">++</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">1/r-&gt;data[i][j]</code> might pose a risk. If <code class="language-plaintext highlighter-rouge">r-&gt;data[i][j]</code> becomes very small, (like, 0.0000…01), we might overflow when multiplying witg <code class="language-plaintext highlighter-rouge">1/r-&gt;data[i][j]</code>. 
In this regard I’ve introduced a “guard” value called <code class="language-plaintext highlighter-rouge">NML_MIN_COEF</code>.</p>

<p>We consider every number smaller than <code class="language-plaintext highlighter-rouge">NML_MIN_COEF</code> to be <code class="language-plaintext highlighter-rouge">0.0</code>. That’s why we perform this additional check: <code class="language-plaintext highlighter-rouge">if (fabs(r-&gt;data[k][j]) &gt; NML_MIN_COEF)</code> in our algorithm.</p>

<h2 id="reduced-row-echelon-form">Reduced Row Echelon Form<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#reduced-row-echelon-form" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<p>A matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-60-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-3548" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3549" class="mjx-mrow"><span id="MJXc-Node-3550" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-60">A</script> is in Reduced Row Echelon Form, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-61-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-3551" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3552" class="mjx-mrow"><span id="MJXc-Node-3553" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3554" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-3555" class="mjx-texatom" style=""><span id="MJXc-Node-3556" class="mjx-mrow"><span id="MJXc-Node-3557" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">r</span></span><span id="MJXc-Node-3558" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">r</span></span><span id="MJXc-Node-3559" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-3560" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.464em; padding-right: 0.06em;">f</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-61">A_{rref}</script> if all the conditions of being in Row Echelon Form are satisfied, and the leading entry in each row is the only non-zero entry in this column.</p>

<p>For example the following matrices are in Reduced Row Echelon Form (Rref):</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-62-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 8.76em; position: relative;"><span id="MJXc-Node-3561" class="mjx-math" aria-hidden="true" style="width: 100%;"><span id="MJXc-Node-3562" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -13.376em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-3563" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-3564" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-3565" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-3566" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3567" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3568" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3569" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3570" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3571" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3572" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3573" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3574" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3575" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3576" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3577" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3578" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3579" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3580" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3581" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3582" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3583" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3584" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3585" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3586" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3587" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3588" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3589" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3590" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3591" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3592" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3593" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3594" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3595" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3596" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3597" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3598" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3599" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3600" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3601" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3602" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3603" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3604" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3605" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3606" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3607" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-3608" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-3609" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span><span id="MJXc-Node-3610" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-3611" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-3612" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3613" class="mjx-mtable" style="vertical-align: -2.35em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3614" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3615" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3616" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3617" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3618" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3619" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3620" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3621" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3622" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3623" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3624" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3625" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3626" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3627" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3628" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3629" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3630" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3631" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3632" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3633" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3634" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3635" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3636" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3637" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3638" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3639" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3640" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3641" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3642" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3643" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3644" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3645" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3646" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3647" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3648" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3649" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3650" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3651" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3652" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3653" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3654" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3655" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3656" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3657" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3658" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3659" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3660" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3661" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3662" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3663" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3664" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3665" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3666" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-3667" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-3668" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.045em;">C</span></span><span id="MJXc-Node-3669" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-3670" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-3671" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3672" class="mjx-mtable" style="vertical-align: -2.35em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3673" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3674" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3675" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3676" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3677" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3678" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3679" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3680" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3681" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3682" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3683" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3684" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3685" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3686" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3687" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3688" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3689" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3690" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3691" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3692" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3693" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3694" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3695" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3696" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3697" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3698" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3699" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3700" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3701" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-3702" class="mjx-mspace" style="width: 0px; height: 0px;"></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>A</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mspace linebreak="newline"></mspace><mi>B</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mspace linebreak="newline"></mspace><mi>C</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mspace linebreak="newline"></mspace></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-62">A=
\begin{bmatrix}
1 & 2 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
\\
B=
\begin{bmatrix}
1 & 2 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 \\
0 & 0 & 0 & 0
\end{bmatrix}
\\
C=
\begin{bmatrix}
1 & 0 \\


0 & 1 \\
0 & 0 \\
0 & 0
\end{bmatrix}
\\</script>

<p>Compared to the previous algorithm, an additional step is performed:</p>

<ol>
  <li>We identify the last row having a pivot equal to <code class="language-plaintext highlighter-rouge">1</code>;</li>
  <li>We mark this as the pivot row;</li>
  <li>We add multiplies of the pivot row to each of it’s upper rows, until every element above it remains <code class="language-plaintext highlighter-rouge">0.0</code>;</li>
  <li>We repeat the process from bottom-up.</li>
</ol>

<p><em>Note:</em> A matrix has only <code class="language-plaintext highlighter-rouge">RREF</code> form, but can have many <code class="language-plaintext highlighter-rouge">REF</code> forms.</p>

<h2 id="code-implementation-1">Code Implementation<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#code-implementation-1" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<p>To make the algorithm more stable from a “computational” perspective we will change the “pivoting method” used above. We introduce a new one:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Find the max element from the column "col" under the row "row"</span>
<span class="c1">// This is needed to pivot in Gauss-Jordan elimination</span>
<span class="c1">// If pivot is not found, return -1</span>
<span class="kt">int</span> <span class="nf">_nml_mat_pivotmaxidx</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">col</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">maxi</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">micol</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">max</span> <span class="o">=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]);</span>
  <span class="n">maxi</span> <span class="o">=</span> <span class="n">row</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">row</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">micol</span> <span class="o">=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">]);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">micol</span><span class="o">&gt;</span><span class="n">max</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">max</span> <span class="o">=</span> <span class="n">micol</span><span class="p">;</span>
      <span class="n">maxi</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">max</span> <span class="o">&lt;</span> <span class="n">NML_MIN_COEF</span><span class="p">)</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">maxi</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<p>Compared to the previous one, this one will return the biggest element on the column under row <code class="language-plaintext highlighter-rouge">row</code>. 
This will be picked as pivot.</p>

<p>The C code:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Retrieves the matrix in Row Echelon form using Gauss Elimination</span>
<span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_ref</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_cp</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">pivot</span><span class="p">;</span>
  <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span><span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_cols</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Find the pivot - the first non-zero entry in the first column of the matrix</span>
    <span class="n">pivot</span> <span class="o">=</span> <span class="n">_nml_mat_pivotidx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pivot</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// All elements on the column are zeros</span>
      <span class="c1">// We move to the next column without doing anything</span>
      <span class="n">j</span><span class="o">++</span><span class="p">;</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// We interchange rows moving the pivot to the first row that doesn't have</span>
    <span class="c1">// already a pivot in place</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pivot</span><span class="o">!=</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">nml_mat_row_swap_r</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">pivot</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">// Multiply each element in the pivot row by the inverse of the pivot</span>
    <span class="n">nml_mat_row_mult_r</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
    <span class="c1">// We add multiplies of the pivot so every element on the column equals 0</span>
    <span class="k">for</span><span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">NML_MIN_COEF</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">nml_mat_row_addrow_r</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]));</span>
      <span class="p">}</span> 
    <span class="p">}</span>
    <span class="n">i</span><span class="o">++</span><span class="p">;</span>
    <span class="n">j</span><span class="o">++</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<h2 id="lup-decomposition">LU(P) Decomposition<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#lup-decomposition" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<p>LU Decomposition, also named LU Factorisation refers to the factorisation of a matrix A, into two factors <code class="language-plaintext highlighter-rouge">L</code> and <code class="language-plaintext highlighter-rouge">U</code>.</p>

<p>Normally the factorisation looks like this:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-63-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;13&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;23&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;31&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;33&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;31&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;13&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;23&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;33&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-3703" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3704" class="mjx-mrow"><span id="MJXc-Node-3705" class="mjx-mrow"><span id="MJXc-Node-3706" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3707" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3708" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3709" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.271em;"><span id="MJXc-Node-3710" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3711" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3712" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3713" class="mjx-texatom" style=""><span id="MJXc-Node-3714" class="mjx-mrow"><span id="MJXc-Node-3715" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3716" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.271em;"><span id="MJXc-Node-3717" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3718" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3719" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3720" class="mjx-texatom" style=""><span id="MJXc-Node-3721" class="mjx-mrow"><span id="MJXc-Node-3722" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3723" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.271em;"><span id="MJXc-Node-3724" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3725" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3726" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3727" class="mjx-texatom" style=""><span id="MJXc-Node-3728" class="mjx-mrow"><span id="MJXc-Node-3729" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">13</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3730" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3731" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3732" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3733" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3734" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3735" class="mjx-texatom" style=""><span id="MJXc-Node-3736" class="mjx-mrow"><span id="MJXc-Node-3737" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">21</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3738" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3739" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3740" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3741" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3742" class="mjx-texatom" style=""><span id="MJXc-Node-3743" class="mjx-mrow"><span id="MJXc-Node-3744" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">22</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3745" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3746" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3747" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3748" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3749" class="mjx-texatom" style=""><span id="MJXc-Node-3750" class="mjx-mrow"><span id="MJXc-Node-3751" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">23</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3752" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3753" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3754" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3755" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3756" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3757" class="mjx-texatom" style=""><span id="MJXc-Node-3758" class="mjx-mrow"><span id="MJXc-Node-3759" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">31</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3760" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3761" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3762" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3763" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3764" class="mjx-texatom" style=""><span id="MJXc-Node-3765" class="mjx-mrow"><span id="MJXc-Node-3766" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">32</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3767" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3768" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3769" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3770" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3771" class="mjx-texatom" style=""><span id="MJXc-Node-3772" class="mjx-mrow"><span id="MJXc-Node-3773" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">33</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3774" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-3775" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-3776" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-3777" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3778" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3779" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3780" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.04em;"><span id="MJXc-Node-3781" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3782" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3783" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.04em;"><span id="MJXc-Node-3784" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3785" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3786" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3787" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3788" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3789" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3790" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3791" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3792" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3793" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3794" class="mjx-texatom" style=""><span id="MJXc-Node-3795" class="mjx-mrow"><span id="MJXc-Node-3796" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">21</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3797" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3798" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3799" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3800" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3801" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3802" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3803" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3804" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3805" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3806" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3807" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3808" class="mjx-texatom" style=""><span id="MJXc-Node-3809" class="mjx-mrow"><span id="MJXc-Node-3810" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">31</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3811" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3812" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3813" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3814" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3815" class="mjx-texatom" style=""><span id="MJXc-Node-3816" class="mjx-mrow"><span id="MJXc-Node-3817" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">32</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3818" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3819" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3820" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3821" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-3822" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-3823" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-3824" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3825" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3826" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3827" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.314em;"><span id="MJXc-Node-3828" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3829" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3830" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3831" class="mjx-texatom" style=""><span id="MJXc-Node-3832" class="mjx-mrow"><span id="MJXc-Node-3833" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3834" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.314em;"><span id="MJXc-Node-3835" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3836" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3837" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3838" class="mjx-texatom" style=""><span id="MJXc-Node-3839" class="mjx-mrow"><span id="MJXc-Node-3840" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3841" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.314em;"><span id="MJXc-Node-3842" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3843" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3844" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3845" class="mjx-texatom" style=""><span id="MJXc-Node-3846" class="mjx-mrow"><span id="MJXc-Node-3847" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">13</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3848" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3849" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3850" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3851" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3852" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3853" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3854" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3855" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3856" class="mjx-texatom" style=""><span id="MJXc-Node-3857" class="mjx-mrow"><span id="MJXc-Node-3858" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">22</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3859" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3860" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3861" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3862" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3863" class="mjx-texatom" style=""><span id="MJXc-Node-3864" class="mjx-mrow"><span id="MJXc-Node-3865" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">23</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3866" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3867" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3868" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3869" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3870" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3871" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3872" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3873" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3874" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3875" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3876" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3877" class="mjx-texatom" style=""><span id="MJXc-Node-3878" class="mjx-mrow"><span id="MJXc-Node-3879" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">33</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3880" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>13</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>23</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>31</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>33</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mn>31</mn></mrow></msub></mtd><mtd><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow></msub></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>∗</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>13</mn></mrow></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mtd><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>23</mn></mrow></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>33</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-63">\begin{bmatrix}
a_{11} & a_{12} & a_{13} \\
a_{21} & a_{22} & a_{23} \\
a_{31} & a_{32} & a_{33} 
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 & 0 \\
l_{21} & 1 & 0 \\
l_{31} & l_{32} & 1
\end{bmatrix} 
* 
\begin{bmatrix}
u_{11} & u_{12} & u_{13} \\
0 & u_{22} & u_{23} \\
0 & 0 & u_{33}
\end{bmatrix}</script>

<p>In practice, however, this type of factorisation might fail to materialise without swapping various rows of A during the computation. In this case, we need to introduce into the equation a new matrix <code class="language-plaintext highlighter-rouge">P</code> where we keep track of all the row changes that are happening during the LU process.</p>

<p>Thus, the decomposition is called <em>LU Factorisation with partial pivoting</em>, and the new equation becomes:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-64-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-3881" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3882" class="mjx-mrow"><span id="MJXc-Node-3883" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-3884" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-3885" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-3886" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-3887" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-3888" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-3889" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo>∗</mo><mi>A</mi><mo>=</mo><mi>L</mi><mo>∗</mo><mi>U</mi></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-64">P * A = L * U</script>

<p>Where:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">P</code> represents any valid (row) permutation of the Identity <code class="language-plaintext highlighter-rouge">I</code> matrix, and it’s computed during the process;</li>
  <li><code class="language-plaintext highlighter-rouge">L</code> is a lower diagonal matrix, with all the elements of the first diagonal <code class="language-plaintext highlighter-rouge">==1</code>;</li>
  <li><code class="language-plaintext highlighter-rouge">U</code> is an upper diagonal matrix.</li>
</ul>

<p>There’s another factorisation where not only the rows are pivoted, but also columns, this is called <em>LU Factorisation with full pivoting</em> but we are not going to implement this.</p>

<p>If the <code class="language-plaintext highlighter-rouge">A</code> matrix is square (<code class="language-plaintext highlighter-rouge">nxn</code>), it can always be decomposed like : <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-65-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-3890" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3891" class="mjx-mrow"><span id="MJXc-Node-3892" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-3893" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-3894" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-3895" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-3896" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-3897" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-3898" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo>∗</mo><mi>A</mi><mo>=</mo><mi>L</mi><mo>∗</mo><mi>U</mi></math></span></span><script type="math/tex" id="MathJax-Element-65">P * A = L * U</script>.</p>

<p>To compute the LU(P) decomposition we will need to basically implement a modified version of the Gauss Elimination algorithm (see Row Echelon Form). This is probably the most popular implementation, and it requires around <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-66-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-3899" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3900" class="mjx-mrow"><span id="MJXc-Node-3901" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-3902" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.58em;"><span id="MJXc-Node-3903" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.305em; vertical-align: -0.41em;"></span></span><span id="MJXc-Node-3904" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-3905" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-3906" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-3907" class="mjx-texatom" style=""><span id="MJXc-Node-3908" class="mjx-mrow"><span id="MJXc-Node-3909" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>2</mn><mn>3</mn></mfrac><mo>∗</mo><msup><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-66">\frac{2}{3}*n^{3}</script> floating point operations.</p>

<p>Other algorithms involve direct recursion or randomization. We are not going to implement those versions.</p>

<p>Computing the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-67-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-3910" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3911" class="mjx-mrow"><span id="MJXc-Node-3912" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-3913" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-3914" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-3915" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-3916" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-3917" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-3918" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo>∗</mo><mi>A</mi><mo>=</mo><mi>L</mi><mo>∗</mo><mi>U</mi></math></span></span><script type="math/tex" id="MathJax-Element-67">P * A = L * U</script> decomposition of matrix <code class="language-plaintext highlighter-rouge">A</code> is instrumental for computing the determinant of matrix <code class="language-plaintext highlighter-rouge">A</code>, the inverse of matrix <code class="language-plaintext highlighter-rouge">A</code> and solving linear systems of equations.</p>

<h3 id="the-lup-algorithm-as-an-example">The LU(P) algorithm as an example<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#the-lup-algorithm-as-an-example" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>LU(P) factorisation (or decomposition) can be obtained by adjusting the idea of Gaussian Elimination (see Row Echelon Form and Reduced Row Echelon Form).</p>

<p>The algorithm starts like this:</p>
<ul>
  <li>We allocate memory for the L, U, P matrices
    <ul>
      <li><code class="language-plaintext highlighter-rouge">L</code> starts as zero matrix;</li>
      <li><code class="language-plaintext highlighter-rouge">P</code> is the identity matrix;</li>
      <li><code class="language-plaintext highlighter-rouge">U</code> is an exact copy of A;</li>
    </ul>
  </li>
  <li>We start iterating the matrix <code class="language-plaintext highlighter-rouge">U</code> by columns
    <ul>
      <li>For each column we look for the pivot value (the biggest value of the column in absolute)
        <ul>
          <li>If needed we swap the corresponding rows in <code class="language-plaintext highlighter-rouge">U</code>, <code class="language-plaintext highlighter-rouge">L</code> and <code class="language-plaintext highlighter-rouge">P</code>, so that the pivot is position on the first diagonal;</li>
          <li>If no swap is needed we start creating zeroes on the column by the means of row addition. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-68-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-3919" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3920" class="mjx-mrow"><span id="MJXc-Node-3921" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-3922" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-3923" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span><span id="MJXc-Node-3924" class="mjx-texatom"><span id="MJXc-Node-3925" class="mjx-mrow"><span id="MJXc-Node-3926" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span></span><span id="MJXc-Node-3927" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-3928" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-3929" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span><span id="MJXc-Node-3930" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span><span id="MJXc-Node-3931" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">t</span></span><span id="MJXc-Node-3932" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span><span id="MJXc-Node-3933" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em;">p</span></span><span id="MJXc-Node-3934" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span><span id="MJXc-Node-3935" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span><span id="MJXc-Node-3936" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-3937" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">r</span></span><span id="MJXc-Node-3938" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-3939" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-3940" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-3941" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span><span id="MJXc-Node-3942" class="mjx-texatom"><span id="MJXc-Node-3943" class="mjx-mrow"><span id="MJXc-Node-3944" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.006em;">y</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mi>o</mi><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow><mo>+</mo><mi>m</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>i</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>r</mi><mo>∗</mo><mi>R</mi><mi>o</mi><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-68">Row{x} + multiplier * Row{y}</script>.
            <ul>
              <li>We record the <code class="language-plaintext highlighter-rouge">multiplier</code> in matrix <code class="language-plaintext highlighter-rouge">L</code></li>
            </ul>
          </li>
        </ul>
      </li>
      <li>We repeat for every column until <code class="language-plaintext highlighter-rouge">U</code> has only zero elements under the first diagonal.</li>
    </ul>
  </li>
</ul>

<p>Let’s look at the decomposition for a matrix <code class="language-plaintext highlighter-rouge">A[3x3]</code>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-69-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-3945" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3946" class="mjx-mrow"><span id="MJXc-Node-3947" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-3948" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-3949" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-3950" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3951" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3952" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3953" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3954" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3955" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3956" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3957" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3958" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3959" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3960" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3961" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3962" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-3963" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3964" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3965" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3966" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3967" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3968" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3969" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3970" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3971" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3972" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3973" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-3974" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3975" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3976" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-3977" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3978" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3979" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-3980" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3981" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-3982" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-3983" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-3984" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-3985" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-3986" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-3987" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-3988" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3989" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-3990" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-3991" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3992" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3993" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-3994" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3995" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3996" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-3997" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3998" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3999" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4000" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4001" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4002" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4003" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4004" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4005" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4006" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4007" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4008" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4009" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4010" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4011" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4012" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4013" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4014" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4015" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4016" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4017" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4018" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4019" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4020" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-4021" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-4022" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-4023" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4024" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4025" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4026" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4027" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4028" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4029" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4030" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4031" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4032" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4033" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4034" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4035" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4036" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4037" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4038" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4039" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4040" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4041" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4042" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4043" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4044" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4045" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4046" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4047" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4048" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4049" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4050" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4051" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4052" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4053" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4054" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4055" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4056" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4057" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-4058" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-4059" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-4060" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4061" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4062" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4063" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4064" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4065" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4066" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4067" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4068" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4069" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4070" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4071" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-4072" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4073" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4074" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4075" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4076" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4077" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4078" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4079" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4080" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4081" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4082" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4083" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4084" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4085" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4086" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4087" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4088" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4089" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4090" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4091" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4092" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4093" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4094" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4095" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo><mi>A</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>5</mn></mtd></mtr><mtr><mtd><mn>4</mn></mtd><mtd><mn>4</mn></mtd><mtd><mo>−</mo><mn>4</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo><mi>L</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo><mi>U</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>5</mn></mtd></mtr><mtr><mtd><mn>4</mn></mtd><mtd><mn>4</mn></mtd><mtd><mo>−</mo><mn>4</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-69">P=
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1  
\end{bmatrix}
, A =
\begin{bmatrix}
2 & 1 & 5 \\
4 & 4 & -4 \\
1 & 3 & 1  
\end{bmatrix}
, L =
\begin{bmatrix}
0 & 0 & 0 \\
0 & 0 & 0 \\
0 & 0 & 0  
\end{bmatrix}
, U = 
\begin{bmatrix}
2 & 1 & 5 \\
4 & 4 & -4 \\
1 & 3 & 1  
\end{bmatrix}</script>

<ul>
  <li><strong>Step1</strong>: Because <code class="language-plaintext highlighter-rouge">4&gt;2</code>, we swap <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-70-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-4096" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4097" class="mjx-mrow"><span id="MJXc-Node-4098" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-4099" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-4100" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4101" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4102" class="mjx-texatom" style=""><span id="MJXc-Node-4103" class="mjx-mrow"><span id="MJXc-Node-4104" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mi>o</mi><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-70">Row_{0}</script> with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-71-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-4105" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4106" class="mjx-mrow"><span id="MJXc-Node-4107" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-4108" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-4109" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4110" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4111" class="mjx-texatom" style=""><span id="MJXc-Node-4112" class="mjx-mrow"><span id="MJXc-Node-4113" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mi>o</mi><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-71">Row_{1}</script>. After this row operation we have:</li>
</ul>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-72-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-4114" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4115" class="mjx-mrow"><span id="MJXc-Node-4116" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4117" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4118" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4119" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4120" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4121" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4122" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4123" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4124" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4125" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4126" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4127" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4128" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4129" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4130" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4131" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4132" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4133" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4134" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4135" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4136" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4137" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4138" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4139" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4140" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4141" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4142" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4143" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4144" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4145" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4146" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4147" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4148" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4149" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4150" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4151" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-4152" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-4153" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-4154" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4155" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4156" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4157" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4158" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4159" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4160" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4161" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4162" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4163" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4164" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4165" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4166" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4167" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4168" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4169" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4170" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4171" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4172" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4173" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4174" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4175" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4176" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4177" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4178" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4179" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4180" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4181" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4182" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4183" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4184" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4185" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4186" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4187" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4188" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-4189" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-4190" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-4191" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4192" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4193" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4194" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4195" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4196" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4197" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4198" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4199" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4200" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4201" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4202" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-4203" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4204" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4205" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4206" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4207" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4208" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4209" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4210" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4211" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4212" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4213" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4214" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4215" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4216" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4217" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4218" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4219" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4220" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4221" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4222" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4223" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4224" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4225" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4226" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo><mi>L</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo><mi>U</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>4</mn></mtd><mtd><mn>4</mn></mtd><mtd><mo>−</mo><mn>4</mn></mtd></mtr><mtr><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>5</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-72">P=
\begin{bmatrix}
0 & 1 & 0 \\
1 & 0 & 0 \\
0 & 0 & 1  
\end{bmatrix}
, L =
\begin{bmatrix}
0 & 0 & 0 \\
0 & 0 & 0 \\
0 & 0 & 0  
\end{bmatrix}
, U =
\begin{bmatrix}
4 & 4 & -4 \\
2 & 1 & 5 \\
1 & 3 & 1  
\end{bmatrix}</script>

<ul>
  <li><strong>Step 2</strong>: We want to start creating zeroes on the first column. So we apply the following operation, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-73-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-4227" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4228" class="mjx-mrow"><span id="MJXc-Node-4229" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-4230" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-4231" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4232" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4233" class="mjx-texatom" style=""><span id="MJXc-Node-4234" class="mjx-mrow"><span id="MJXc-Node-4235" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-4236" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4237" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-4238" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4239" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.559em;"><span id="MJXc-Node-4240" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.29em; vertical-align: -0.395em;"></span></span><span id="MJXc-Node-4241" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span><span id="MJXc-Node-4242" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-4243" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-4244" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4245" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4246" class="mjx-texatom" style=""><span id="MJXc-Node-4247" class="mjx-mrow"><span id="MJXc-Node-4248" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mi>o</mi><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>−</mo><mo stretchy="false">(</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">)</mo><mi>R</mi><mi>o</mi><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-73">Row_{1}-(\frac{1}{2})Row_{0}</script>. We record the multiplier <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-74-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-4249" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4250" class="mjx-mrow"><span id="MJXc-Node-4251" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4252" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.559em;"><span id="MJXc-Node-4253" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.29em; vertical-align: -0.395em;"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mn>2</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-74">\frac{1}{2}</script> in <code class="language-plaintext highlighter-rouge">L[1][0]</code>, and we compute the basic row operation on <code class="language-plaintext highlighter-rouge">U</code>:</li>
</ul>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-75-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-4254" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4255" class="mjx-mrow"><span id="MJXc-Node-4256" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4257" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4258" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4259" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4260" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4261" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4262" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4263" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4264" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4265" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4266" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4267" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4268" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4269" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4270" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4271" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4272" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4273" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4274" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4275" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4276" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4277" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4278" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4279" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4280" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4281" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4282" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4283" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4284" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4285" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4286" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4287" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4288" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4289" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4290" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4291" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-4292" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-4293" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-4294" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4295" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4296" class="mjx-mo" style="vertical-align: -1.126em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.492em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4297" class="mjx-mtable" style="vertical-align: -1.795em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4298" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4299" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.735em;"><span id="MJXc-Node-4300" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4301" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4302" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4303" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4304" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4305" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4306" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4307" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4308" class="mjx-mtr" style="height: 1.69em;"><span id="MJXc-Node-4309" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4310" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4311" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4312" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.559em;"><span id="MJXc-Node-4313" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.29em; vertical-align: -0.395em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4314" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4315" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4316" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4317" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4318" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4319" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4320" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4321" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4322" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4323" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4324" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4325" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4326" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4327" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4328" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4329" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4330" class="mjx-mo" style="vertical-align: -1.126em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.492em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-4331" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-4332" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-4333" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4334" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4335" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4336" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4337" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4338" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4339" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4340" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4341" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-4342" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4343" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4344" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-4345" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4346" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4347" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4348" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4349" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4350" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4351" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4352" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4353" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4354" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4355" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4356" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4357" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4358" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">7</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4359" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4360" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4361" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4362" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4363" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4364" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4365" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4366" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4367" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4368" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4369" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo><mi>L</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mfrac><mn>1</mn><mn>2</mn></mfrac></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo><mi>U</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>4</mn></mtd><mtd><mn>4</mn></mtd><mtd><mo>−</mo><mn>4</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mo>−</mo><mn>1</mn></mtd><mtd><mn>7</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-75">P=
\begin{bmatrix}
0 & 1 & 0 \\
1 & 0 & 0 \\
0 & 0 & 1  
\end{bmatrix}
, L =
\begin{bmatrix}
0 & 0 & 0 \\
\frac{1}{2} & 0 & 0 \\
0 & 0 & 0  
\end{bmatrix}
, U =
\begin{bmatrix}
4 & 4 & -4 \\
0 & -1 & 7 \\
1 & 3 & 1  
\end{bmatrix}</script>

<ul>
  <li><strong>Step 3</strong>: We continue to create zeroes on the first column, by applying: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-76-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-4370" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4371" class="mjx-mrow"><span id="MJXc-Node-4372" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-4373" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-4374" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4375" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4376" class="mjx-texatom" style=""><span id="MJXc-Node-4377" class="mjx-mrow"><span id="MJXc-Node-4378" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-4379" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4380" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4381" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.57em;"><span id="MJXc-Node-4382" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.298em; vertical-align: -0.403em;"></span></span><span id="MJXc-Node-4383" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-4384" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-4385" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4386" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4387" class="mjx-texatom" style=""><span id="MJXc-Node-4388" class="mjx-mrow"><span id="MJXc-Node-4389" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mi>o</mi><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>4</mn></mfrac><mi>R</mi><mi>o</mi><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-76">Row_{2} - \frac{1}{4}Row_{0}</script>. We record the multiplier <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-77-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-4390" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4391" class="mjx-mrow"><span id="MJXc-Node-4392" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4393" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.57em;"><span id="MJXc-Node-4394" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.298em; vertical-align: -0.403em;"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mn>4</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-77">\frac{1}{4}</script> in <code class="language-plaintext highlighter-rouge">L[2][0]</code>, and we compute the row operation on <code class="language-plaintext highlighter-rouge">U</code>:</li>
</ul>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-78-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-4395" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4396" class="mjx-mrow"><span id="MJXc-Node-4397" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4398" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4399" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4400" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4401" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4402" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4403" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4404" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4405" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4406" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4407" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4408" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4409" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4410" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4411" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4412" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4413" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4414" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4415" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4416" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4417" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4418" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4419" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4420" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4421" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4422" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4423" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4424" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4425" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4426" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4427" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4428" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4429" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4430" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4431" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4432" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-4433" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-4434" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-4435" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4436" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4437" class="mjx-mo" style="vertical-align: -1.275em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.395em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4438" class="mjx-mtable" style="vertical-align: -1.944em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4439" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4440" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.735em;"><span id="MJXc-Node-4441" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4442" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4443" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4444" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4445" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4446" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4447" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4448" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4449" class="mjx-mtr" style="height: 1.69em;"><span id="MJXc-Node-4450" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4451" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4452" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4453" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.559em;"><span id="MJXc-Node-4454" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.29em; vertical-align: -0.395em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4455" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4456" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4457" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4458" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4459" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4460" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4461" class="mjx-mtr" style="height: 1.498em;"><span id="MJXc-Node-4462" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4463" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4464" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4465" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.57em;"><span id="MJXc-Node-4466" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.298em; vertical-align: -0.403em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4467" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4468" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4469" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4470" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4471" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4472" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4473" class="mjx-mo" style="vertical-align: -1.275em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.395em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-4474" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-4475" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-4476" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4477" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4478" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4479" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4480" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4481" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4482" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4483" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4484" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-4485" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4486" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4487" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-4488" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4489" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4490" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4491" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4492" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4493" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4494" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4495" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4496" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4497" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4498" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4499" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4500" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4501" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">7</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4502" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4503" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4504" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4505" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4506" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4507" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4508" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4509" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4510" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4511" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4512" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo><mi>L</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mfrac><mn>1</mn><mn>2</mn></mfrac></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mfrac><mn>1</mn><mn>4</mn></mfrac></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo><mi>U</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>4</mn></mtd><mtd><mn>4</mn></mtd><mtd><mo>−</mo><mn>4</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mo>−</mo><mn>1</mn></mtd><mtd><mn>7</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>2</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-78">P=
\begin{bmatrix}
0 & 1 & 0 \\
1 & 0 & 0 \\
0 & 0 & 1  
\end{bmatrix}
, L =
\begin{bmatrix}
0 & 0 & 0 \\
\frac{1}{2} & 0 & 0 \\
\frac{1}{4} & 0 & 0  
\end{bmatrix}
, U =
\begin{bmatrix}
4 & 4 & -4 \\
0 & -1 & 7 \\
0 & 2 & 2  
\end{bmatrix}</script>

<ul>
  <li><strong>Step 4</strong>: We’ve finished with the first column, we skip to the next one. Because <code class="language-plaintext highlighter-rouge">-1&lt;2</code> we swap <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-79-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-4513" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4514" class="mjx-mrow"><span id="MJXc-Node-4515" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-4516" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-4517" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4518" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4519" class="mjx-texatom" style=""><span id="MJXc-Node-4520" class="mjx-mrow"><span id="MJXc-Node-4521" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mi>o</mi><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-79">Row_{1}</script> with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-80-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-4522" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4523" class="mjx-mrow"><span id="MJXc-Node-4524" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-4525" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-4526" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4527" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4528" class="mjx-texatom" style=""><span id="MJXc-Node-4529" class="mjx-mrow"><span id="MJXc-Node-4530" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mi>o</mi><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-80">Row_{2}</script>. The idea is to always have the biggest pivot. <code class="language-plaintext highlighter-rouge">P</code>, <code class="language-plaintext highlighter-rouge">L</code> and <code class="language-plaintext highlighter-rouge">U</code> are affected by this swap:</li>
</ul>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-81-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-4531" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4532" class="mjx-mrow"><span id="MJXc-Node-4533" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4534" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4535" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4536" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4537" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4538" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4539" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4540" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4541" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4542" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4543" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4544" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4545" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4546" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4547" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4548" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4549" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4550" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4551" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4552" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4553" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4554" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4555" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4556" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4557" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4558" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4559" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4560" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4561" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4562" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4563" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4564" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4565" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4566" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4567" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4568" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-4569" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-4570" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-4571" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4572" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4573" class="mjx-mo" style="vertical-align: -1.275em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.395em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4574" class="mjx-mtable" style="vertical-align: -1.944em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4575" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4576" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.735em;"><span id="MJXc-Node-4577" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4578" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4579" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4580" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4581" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4582" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4583" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4584" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4585" class="mjx-mtr" style="height: 1.698em;"><span id="MJXc-Node-4586" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4587" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4588" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4589" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.57em;"><span id="MJXc-Node-4590" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.298em; vertical-align: -0.403em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4591" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4592" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4593" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4594" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4595" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4596" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4597" class="mjx-mtr" style="height: 1.49em;"><span id="MJXc-Node-4598" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4599" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4600" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4601" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.559em;"><span id="MJXc-Node-4602" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.29em; vertical-align: -0.395em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4603" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4604" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4605" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4606" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4607" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4608" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4609" class="mjx-mo" style="vertical-align: -1.275em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.395em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-4610" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-4611" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-4612" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4613" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4614" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4615" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4616" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4617" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4618" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4619" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4620" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-4621" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4622" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4623" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-4624" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4625" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4626" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4627" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4628" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4629" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4630" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4631" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4632" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4633" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4634" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4635" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4636" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4637" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4638" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4639" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4640" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4641" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4642" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4643" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4644" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4645" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4646" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4647" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">7</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4648" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo><mi>L</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mfrac><mn>1</mn><mn>4</mn></mfrac></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mfrac><mn>1</mn><mn>2</mn></mfrac></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo><mi>U</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>4</mn></mtd><mtd><mn>4</mn></mtd><mtd><mo>−</mo><mn>4</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mo>−</mo><mn>1</mn></mtd><mtd><mn>7</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-81">P=
\begin{bmatrix}
0 & 1 & 0 \\
0 & 0 & 1 \\
1 & 0 & 0 
\end{bmatrix}
, L =
\begin{bmatrix}
0 & 0 & 0 \\
\frac{1}{4} & 0 & 0 \\
\frac{1}{2} & 0 & 0 
\end{bmatrix}
, U =
\begin{bmatrix}
4 & 4 & -4 \\
0 & 2 & 2  \\
0 & -1 & 7 
\end{bmatrix}</script>

<ul>
  <li><strong>Step 5</strong>: We want to create the last <code class="language-plaintext highlighter-rouge">0.0</code> on the second column. In this regard we apply <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-82-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-4649" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4650" class="mjx-mrow"><span id="MJXc-Node-4651" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-4652" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-4653" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4654" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4655" class="mjx-texatom" style=""><span id="MJXc-Node-4656" class="mjx-mrow"><span id="MJXc-Node-4657" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-4658" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4659" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-4660" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4661" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4662" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.559em;"><span id="MJXc-Node-4663" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.29em; vertical-align: -0.395em;"></span></span><span id="MJXc-Node-4664" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span><span id="MJXc-Node-4665" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-4666" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span><span id="MJXc-Node-4667" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-4668" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4669" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4670" class="mjx-texatom" style=""><span id="MJXc-Node-4671" class="mjx-mrow"><span id="MJXc-Node-4672" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mi>o</mi><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>−</mo><mo stretchy="false">(</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">)</mo><mo>∗</mo><mi>R</mi><mi>o</mi><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-82">Row_{2} - (-\frac{1}{2}) * Row_{1}</script>:</li>
</ul>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-83-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-4673" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4674" class="mjx-mrow"><span id="MJXc-Node-4675" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4676" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4677" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4678" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4679" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4680" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4681" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4682" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4683" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4684" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4685" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4686" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4687" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4688" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4689" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4690" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4691" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4692" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4693" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4694" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4695" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4696" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4697" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4698" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4699" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4700" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4701" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4702" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4703" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4704" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4705" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4706" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4707" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4708" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4709" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4710" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-4711" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-4712" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-4713" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4714" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4715" class="mjx-mo" style="vertical-align: -1.275em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.395em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4716" class="mjx-mtable" style="vertical-align: -1.944em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4717" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4718" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.735em;"><span id="MJXc-Node-4719" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4720" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4721" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.513em;"><span id="MJXc-Node-4722" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4723" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4724" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4725" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4726" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4727" class="mjx-mtr" style="height: 1.698em;"><span id="MJXc-Node-4728" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4729" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4730" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4731" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.57em;"><span id="MJXc-Node-4732" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.298em; vertical-align: -0.403em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4733" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4734" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4735" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4736" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4737" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4738" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4739" class="mjx-mtr" style="height: 1.49em;"><span id="MJXc-Node-4740" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4741" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4742" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4743" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.559em;"><span id="MJXc-Node-4744" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.29em; vertical-align: -0.395em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4745" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4746" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4747" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4748" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4749" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.559em;"><span id="MJXc-Node-4750" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.29em; vertical-align: -0.395em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4751" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4752" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4753" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4754" class="mjx-mo" style="vertical-align: -1.275em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.395em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-4755" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-4756" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-4757" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4758" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4759" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4760" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4761" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4762" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4763" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4764" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4765" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4766" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4767" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4768" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-4769" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4770" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4771" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4772" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4773" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4774" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4775" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4776" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4777" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4778" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4779" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4780" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4781" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4782" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4783" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4784" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4785" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4786" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4787" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4788" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4789" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4790" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4791" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">8</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4792" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo><mi>L</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mfrac><mn>1</mn><mn>4</mn></mfrac></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mfrac><mn>1</mn><mn>2</mn></mfrac></mtd><mtd><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo><mi>U</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>4</mn></mtd><mtd><mn>4</mn></mtd><mtd><mo>−</mo><mn>4</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>8</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-83">P=
\begin{bmatrix}
0 & 1 & 0 \\
0 & 0 & 1 \\
1 & 0 & 0
\end{bmatrix}
, L =
\begin{bmatrix}
0 & 0 & 0 \\
\frac{1}{4} & 0 & 0 \\
\frac{1}{2} & -\frac{1}{2} & 0
\end{bmatrix}
, U =
\begin{bmatrix}
4 & 4 & -4 \\
0 & 2 & 2  \\
0 & 0 & 8
\end{bmatrix}</script>

<ul>
  <li><strong>Step 6</strong>: We modify L by adding <code class="language-plaintext highlighter-rouge">1</code>s on the first diagonal.</li>
</ul>

<p>In conclusion, the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-84-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-4793" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4794" class="mjx-mrow"><span id="MJXc-Node-4795" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4796" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-4797" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-4798" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4799" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-4800" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-4801" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo>∗</mo><mi>A</mi><mo>=</mo><mi>L</mi><mo>∗</mo><mi>U</mi></math></span></span><script type="math/tex" id="MathJax-Element-84">P*A=L*U</script> factorization of <code class="language-plaintext highlighter-rouge">A</code> looks like:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-85-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-4802" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4803" class="mjx-mrow"><span id="MJXc-Node-4804" class="mjx-mrow"><span id="MJXc-Node-4805" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4806" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4807" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4808" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4809" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4810" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4811" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4812" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4813" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4814" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4815" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4816" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4817" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4818" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4819" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4820" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4821" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4822" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4823" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4824" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4825" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4826" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4827" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4828" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4829" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4830" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4831" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4832" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4833" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4834" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4835" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4836" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4837" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-4838" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-4839" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-4840" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4841" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4842" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4843" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4844" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4845" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4846" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4847" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4848" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4849" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-4850" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4851" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">5</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4852" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4853" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4854" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4855" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4856" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4857" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4858" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4859" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4860" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4861" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4862" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4863" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4864" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4865" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4866" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4867" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4868" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4869" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4870" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4871" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4872" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4873" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-4874" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-4875" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4876" class="mjx-mo" style="vertical-align: -1.275em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.395em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4877" class="mjx-mtable" style="vertical-align: -1.944em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4878" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4879" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.735em;"><span id="MJXc-Node-4880" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4881" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4882" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.513em;"><span id="MJXc-Node-4883" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4884" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4885" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4886" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4887" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4888" class="mjx-mtr" style="height: 1.698em;"><span id="MJXc-Node-4889" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4890" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4891" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4892" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.57em;"><span id="MJXc-Node-4893" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.298em; vertical-align: -0.403em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4894" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4895" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4896" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4897" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4898" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4899" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4900" class="mjx-mtr" style="height: 1.49em;"><span id="MJXc-Node-4901" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4902" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4903" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4904" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.559em;"><span id="MJXc-Node-4905" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.29em; vertical-align: -0.395em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4906" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4907" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4908" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4909" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.266em;"><span id="MJXc-Node-4910" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.559em;"><span id="MJXc-Node-4911" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.495em;"></span></span><span class="mjx-vsize" style="height: 1.29em; vertical-align: -0.395em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4912" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4913" class="mjx-mrow" style="margin-top: -0.105em;"><span id="MJXc-Node-4914" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4915" class="mjx-mo" style="vertical-align: -1.275em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.395em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-4916" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-4917" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-4918" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4919" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4920" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4921" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-4922" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4923" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4924" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-4925" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4926" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4927" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.278em;"><span id="MJXc-Node-4928" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4929" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-4930" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">4</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4931" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4932" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4933" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4934" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4935" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4936" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4937" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4938" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4939" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4940" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4941" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4942" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4943" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4944" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4945" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4946" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4947" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4948" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4949" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4950" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">8</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4951" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>∗</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>2</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>5</mn></mtd></mtr><mtr><mtd><mn>4</mn></mtd><mtd><mn>4</mn></mtd><mtd><mo>−</mo><mn>4</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mfrac><mn>1</mn><mn>4</mn></mfrac></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mfrac><mn>1</mn><mn>2</mn></mfrac></mtd><mtd><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>∗</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>4</mn></mtd><mtd><mn>4</mn></mtd><mtd><mo>−</mo><mn>4</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>8</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-85">\begin{bmatrix}
0 & 1 & 0 \\
0 & 0 & 1 \\
1 & 0 & 0
\end{bmatrix}
*
\begin{bmatrix}
2 & 1 & 5 \\
4 & 4 & -4 \\
1 & 3 & 1  
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 & 0 \\
\frac{1}{4} & 1 & 0 \\
\frac{1}{2} & -\frac{1}{2} & 1
\end{bmatrix}
*
\begin{bmatrix}
4 & 4 & -4 \\
0 & 2 & 2  \\
0 & 0 & 8
\end{bmatrix}</script>

<p>There’s also a video with this example, link <a href="https://www.youtube.com/watch?v=f6RT4BI4S7M">here</a>.</p>

<h2 id="code-implementation-2">Code implementation<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#code-implementation-2" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<p>The best way to model the results of the <code class="language-plaintext highlighter-rouge">LU(P)</code> computation is to create a <code class="language-plaintext highlighter-rouge">struct</code> called <code class="language-plaintext highlighter-rouge">nml_mat_lup</code> containing references to all three resulting matrices: <code class="language-plaintext highlighter-rouge">L</code>, <code class="language-plaintext highlighter-rouge">U</code>, <code class="language-plaintext highlighter-rouge">P</code>.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">typedef</span> <span class="k">struct</span> <span class="n">nml_mat_lup_s</span> <span class="p">{</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">L</span><span class="p">;</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">U</span><span class="p">;</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">P</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_permutations</span><span class="p">;</span>
<span class="p">}</span> <span class="n">nml_mat_lup</span><span class="p">;</span>
</code></pre></div></div>

<p>The property <code class="language-plaintext highlighter-rouge">num_permutations</code> records the number of row permutations we’ve done during the factorization process.
This value it’s useful when computing the determinant of the matrix, so it’s better to track it now.</p>

<p>To reduce memory consumption, the two matrices <code class="language-plaintext highlighter-rouge">L</code> and <code class="language-plaintext highlighter-rouge">U</code> can be kept in single matrix <code class="language-plaintext highlighter-rouge">LU</code> that looks like this:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-86-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;13&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;23&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;31&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;33&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-4952" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4953" class="mjx-mrow"><span id="MJXc-Node-4954" class="mjx-mrow"><span id="MJXc-Node-4955" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-4956" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4957" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-4958" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.314em;"><span id="MJXc-Node-4959" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4960" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4961" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4962" class="mjx-texatom" style=""><span id="MJXc-Node-4963" class="mjx-mrow"><span id="MJXc-Node-4964" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4965" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.314em;"><span id="MJXc-Node-4966" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4967" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4968" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4969" class="mjx-texatom" style=""><span id="MJXc-Node-4970" class="mjx-mrow"><span id="MJXc-Node-4971" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4972" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.314em;"><span id="MJXc-Node-4973" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4974" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4975" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4976" class="mjx-texatom" style=""><span id="MJXc-Node-4977" class="mjx-mrow"><span id="MJXc-Node-4978" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">13</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4979" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-4980" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-4981" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4982" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4983" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4984" class="mjx-texatom" style=""><span id="MJXc-Node-4985" class="mjx-mrow"><span id="MJXc-Node-4986" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">21</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4987" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-4988" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4989" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4990" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4991" class="mjx-texatom" style=""><span id="MJXc-Node-4992" class="mjx-mrow"><span id="MJXc-Node-4993" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">22</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4994" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-4995" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4996" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4997" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4998" class="mjx-texatom" style=""><span id="MJXc-Node-4999" class="mjx-mrow"><span id="MJXc-Node-5000" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">23</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5001" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5002" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-5003" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5004" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5005" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5006" class="mjx-texatom" style=""><span id="MJXc-Node-5007" class="mjx-mrow"><span id="MJXc-Node-5008" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">31</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5009" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5010" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5011" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5012" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5013" class="mjx-texatom" style=""><span id="MJXc-Node-5014" class="mjx-mrow"><span id="MJXc-Node-5015" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">32</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5016" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-5017" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5018" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5019" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5020" class="mjx-texatom" style=""><span id="MJXc-Node-5021" class="mjx-mrow"><span id="MJXc-Node-5022" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">33</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-5023" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>13</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub></mtd><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mtd><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>23</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mn>31</mn></mrow></msub></mtd><mtd><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow></msub></mtd><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>33</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-86">\begin{bmatrix}
u_{11} & u_{12} & u_{13} \\
l_{21} & u_{22} & u_{23} \\
l_{31} & l_{32} & u_{33}
\end{bmatrix}</script>

<p>In our implementation, for simplicity and readability, we will keep them separated.</p>

<p>Following the same recipe as for <code class="language-plaintext highlighter-rouge">nml_mat</code> we are going to write “constructor-like”/”destructor-like” methods for managing the memory allocation for a <code class="language-plaintext highlighter-rouge">nml_mat_lup</code> structure.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat_lup</span> <span class="o">*</span><span class="nf">nml_mat_lup_new</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">L</span><span class="p">,</span> <span class="n">nml_mat</span> <span class="o">*</span><span class="n">U</span><span class="p">,</span> <span class="n">nml_mat</span> <span class="o">*</span><span class="n">P</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_permutations</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat_lup</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">r</span><span class="p">));</span>
  <span class="n">NP_CHECK</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
  <span class="n">r</span><span class="o">-&gt;</span><span class="n">L</span> <span class="o">=</span> <span class="n">L</span><span class="p">;</span>
  <span class="n">r</span><span class="o">-&gt;</span><span class="n">U</span> <span class="o">=</span> <span class="n">U</span><span class="p">;</span>
  <span class="n">r</span><span class="o">-&gt;</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span><span class="p">;</span>
  <span class="n">r</span><span class="o">-&gt;</span><span class="n">num_permutations</span> <span class="o">=</span> <span class="n">num_permutations</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">nml_mat_lup_free</span><span class="p">(</span><span class="n">nml_mat_lup</span><span class="o">*</span> <span class="n">lu</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">lu</span><span class="o">-&gt;</span><span class="n">P</span><span class="p">);</span>
  <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">lu</span><span class="o">-&gt;</span><span class="n">L</span><span class="p">);</span>
  <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">lu</span><span class="o">-&gt;</span><span class="n">U</span><span class="p">);</span>
  <span class="n">free</span><span class="p">(</span><span class="n">lu</span><span class="p">);</span>
<span class="p">}</span> 
</code></pre></div></div>

<p>The code that is performing the factorization:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat_lup</span> <span class="o">*</span><span class="nf">nml_mat_lup_solve</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">is_square</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_LU_MATRIX_SQUARE</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span> <span class="n">num_cols</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">L</span> <span class="o">=</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">);</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">U</span> <span class="o">=</span> <span class="n">nml_mat_cp</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">P</span> <span class="o">=</span> <span class="n">nml_mat_eye</span><span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">);</span>

  <span class="kt">int</span> <span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">,</span> <span class="n">pivot</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_permutations</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">mult</span><span class="p">;</span>

  <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">U</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Retrieves the row with the biggest element for column (j)</span>
    <span class="n">pivot</span> <span class="o">=</span> <span class="n">_nml_mat_absmaxr</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">U</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">pivot</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">NML_MIN_COEF</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">NML_ERROR</span><span class="p">(</span><span class="n">CANNOT_LU_MATRIX_DEGENERATE</span><span class="p">);</span>
      <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pivot</span><span class="o">!=</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Pivots LU and P accordingly to the rule</span>
      <span class="n">nml_mat_row_swap_r</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">pivot</span><span class="p">);</span>
      <span class="n">nml_mat_row_swap_r</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">pivot</span><span class="p">);</span>
      <span class="n">nml_mat_row_swap_r</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">pivot</span><span class="p">);</span>
      <span class="c1">// Keep the number of permutations to easily calculate the</span>
      <span class="c1">// determinant sign afterwards</span>
      <span class="n">num_permutations</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">U</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">mult</span> <span class="o">=</span> <span class="n">U</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="n">U</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
      <span class="c1">// Building the U upper rows</span>
      <span class="n">nml_mat_row_addrow_r</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="n">mult</span><span class="p">);</span>
      <span class="c1">// Store the multiplier in L</span>
      <span class="n">L</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">mult</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">nml_mat_diag_set</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">);</span>

  <span class="k">return</span> <span class="n">nml_mat_lup_new</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">num_permutations</span><span class="p">);</span>
<span class="p">}</span> 
</code></pre></div></div>

<h2 id="solving-linear-systems-of-equations">Solving linear systems of equations<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#solving-linear-systems-of-equations" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<h3 id="forward-substitution">Forward substitution<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#forward-substitution" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>Forward substitution is the process of solving linear systems of equations <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-87-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5024" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5025" class="mjx-mrow"><span id="MJXc-Node-5026" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-5027" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5028" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span><span id="MJXc-Node-5029" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5030" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo>∗</mo><mi>x</mi><mo>=</mo><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-87">L*x=B</script> if <code class="language-plaintext highlighter-rouge">L</code> is a lower diagonal coefficient matrix.</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-88-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-5031" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5032" class="mjx-mrow"><span id="MJXc-Node-5033" class="mjx-mrow"><span id="MJXc-Node-5034" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-5035" class="mjx-mtable" style="vertical-align: -2.35em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5036" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5037" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.308em;"><span id="MJXc-Node-5038" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5039" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5040" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5041" class="mjx-texatom" style=""><span id="MJXc-Node-5042" class="mjx-mrow"><span id="MJXc-Node-5043" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5044" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.308em;"><span id="MJXc-Node-5045" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5046" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5047" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.167em;"><span id="MJXc-Node-5048" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5049" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5050" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5051" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5052" class="mjx-mtd" style="padding: 0px 0.5em; width: 0px;"><span id="MJXc-Node-5053" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5054" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.575em;"><span id="MJXc-Node-5055" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5056" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5057" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5058" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-5059" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5060" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5061" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5062" class="mjx-texatom" style=""><span id="MJXc-Node-5063" class="mjx-mrow"><span id="MJXc-Node-5064" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">21</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5065" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5066" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5067" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5068" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5069" class="mjx-texatom" style=""><span id="MJXc-Node-5070" class="mjx-mrow"><span id="MJXc-Node-5071" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">22</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5072" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5073" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5074" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5075" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5076" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5077" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5078" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5079" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-5080" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5081" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5082" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5083" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-5084" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5085" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5086" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5087" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5088" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5089" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5090" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5091" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5092" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5093" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5094" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5095" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5096" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5097" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5098" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5099" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5100" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-5101" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5102" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5103" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5104" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5105" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5106" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-5107" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5108" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5109" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5110" class="mjx-texatom" style=""><span id="MJXc-Node-5111" class="mjx-mrow"><span id="MJXc-Node-5112" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-5113" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5114" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5115" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5116" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5117" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5118" class="mjx-texatom" style=""><span id="MJXc-Node-5119" class="mjx-mrow"><span id="MJXc-Node-5120" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-5121" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5122" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5123" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5124" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5125" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5126" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5127" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5128" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5129" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-5130" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5131" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5132" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5133" class="mjx-texatom" style=""><span id="MJXc-Node-5134" class="mjx-mrow"><span id="MJXc-Node-5135" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-5136" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-5137" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-5138" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5139" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-5140" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-5141" class="mjx-mtable" style="vertical-align: -2.35em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5142" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5143" class="mjx-mtd" style="padding: 0px; width: 1.228em;"><span id="MJXc-Node-5144" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5145" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5146" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5147" class="mjx-texatom" style=""><span id="MJXc-Node-5148" class="mjx-mrow"><span id="MJXc-Node-5149" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5150" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5151" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5152" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5153" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5154" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5155" class="mjx-texatom" style=""><span id="MJXc-Node-5156" class="mjx-mrow"><span id="MJXc-Node-5157" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5158" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5159" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5160" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5161" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5162" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5163" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5164" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5165" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5166" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5167" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5168" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5169" class="mjx-texatom" style=""><span id="MJXc-Node-5170" class="mjx-mrow"><span id="MJXc-Node-5171" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-5172" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-5173" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5174" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-5175" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-5176" class="mjx-mtable" style="vertical-align: -2.35em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5177" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5178" class="mjx-mtd" style="padding: 0px; width: 1.167em;"><span id="MJXc-Node-5179" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5180" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5181" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5182" class="mjx-texatom" style=""><span id="MJXc-Node-5183" class="mjx-mrow"><span id="MJXc-Node-5184" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5185" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5186" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5187" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5188" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5189" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5190" class="mjx-texatom" style=""><span id="MJXc-Node-5191" class="mjx-mrow"><span id="MJXc-Node-5192" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5193" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5194" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5195" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5196" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5197" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5198" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5199" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5200" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5201" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5202" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5203" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5204" class="mjx-texatom" style=""><span id="MJXc-Node-5205" class="mjx-mrow"><span id="MJXc-Node-5206" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-5207" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><mn>0</mn></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub></mtd><mtd><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mn>2</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>m</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>∗</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-88">\begin{bmatrix}
l_{11} & 0 & ... && 0\\
l_{21} & l_{22} & ... && 0\\
... & ... & ... && ...\\
l_{m1} & l_{m2} & ... && l_{mm}\\
\end{bmatrix}
*
\begin{bmatrix}
x_{1} \\
x_{2} \\
...   \\
x_{m}
\end{bmatrix}
=
\begin{bmatrix}
b_{1} \\
b_{2} \\
...   \\
b_{m}
\end{bmatrix}</script>

<p>In this case the resulting formulas for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-89-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5208" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5209" class="mjx-mrow"><span id="MJXc-Node-5210" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5211" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5212" class="mjx-texatom" style=""><span id="MJXc-Node-5213" class="mjx-mrow"><span id="MJXc-Node-5214" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-5215" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-5216" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-5217" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5218" class="mjx-texatom" style=""><span id="MJXc-Node-5219" class="mjx-mrow"><span id="MJXc-Node-5220" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-5221" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-5222" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5223" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5224" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5225" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-5226" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-5227" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5228" class="mjx-texatom" style=""><span id="MJXc-Node-5229" class="mjx-mrow"><span id="MJXc-Node-5230" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-89">x_{1}, x_{2}, ..., x_{m}</script> are:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-90-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 11.086em; position: relative;"><span id="MJXc-Node-5231" class="mjx-math" aria-hidden="true" style="width: 100%;"><span id="MJXc-Node-5232" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -6.37em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-5233" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5234" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5235" class="mjx-texatom" style=""><span id="MJXc-Node-5236" class="mjx-mrow"><span id="MJXc-Node-5237" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-5238" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5239" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.24em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.24em; top: -1.396em;"><span id="MJXc-Node-5240" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5241" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5242" class="mjx-texatom" style=""><span id="MJXc-Node-5243" class="mjx-mrow"><span id="MJXc-Node-5244" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span><span class="mjx-denominator" style="width: 1.24em; bottom: -0.854em;"><span id="MJXc-Node-5245" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5246" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5247" class="mjx-texatom" style=""><span id="MJXc-Node-5248" class="mjx-mrow"><span id="MJXc-Node-5249" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 1.24em;"></span></span><span class="mjx-vsize" style="height: 2.249em; vertical-align: -0.854em;"></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-5250" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-5251" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5252" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5253" class="mjx-texatom" style=""><span id="MJXc-Node-5254" class="mjx-mrow"><span id="MJXc-Node-5255" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-5256" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5257" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 5.186em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 5.186em; top: -1.396em;"><span id="MJXc-Node-5258" class="mjx-mrow"><span id="MJXc-Node-5259" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5260" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5261" class="mjx-texatom" style=""><span id="MJXc-Node-5262" class="mjx-mrow"><span id="MJXc-Node-5263" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-5264" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5265" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-5266" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5267" class="mjx-texatom" style=""><span id="MJXc-Node-5268" class="mjx-mrow"><span id="MJXc-Node-5269" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">21</span></span></span></span></span></span><span id="MJXc-Node-5270" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5271" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-5272" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5273" class="mjx-texatom" style=""><span id="MJXc-Node-5274" class="mjx-mrow"><span id="MJXc-Node-5275" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="width: 5.186em; bottom: -0.854em;"><span id="MJXc-Node-5276" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5277" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5278" class="mjx-texatom" style=""><span id="MJXc-Node-5279" class="mjx-mrow"><span id="MJXc-Node-5280" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">22</span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 5.186em;"></span></span><span class="mjx-vsize" style="height: 2.249em; vertical-align: -0.854em;"></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-5281" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-5282" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5283" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5284" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-5285" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-5286" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5287" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5288" class="mjx-texatom" style=""><span id="MJXc-Node-5289" class="mjx-mrow"><span id="MJXc-Node-5290" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span></span></span></span></span><span id="MJXc-Node-5291" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5292" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 8.284em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 8.284em; top: -1.771em;"><span id="MJXc-Node-5293" class="mjx-mrow"><span id="MJXc-Node-5294" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5295" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5296" class="mjx-texatom" style=""><span id="MJXc-Node-5297" class="mjx-mrow"><span id="MJXc-Node-5298" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span></span></span></span></span><span id="MJXc-Node-5299" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5300" class="mjx-munderover MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-5301" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.506em; padding-bottom: 0.506em;">∑</span></span></span><span class="mjx-stack" style="vertical-align: -0.31em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.351em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5307" class="mjx-texatom" style=""><span id="MJXc-Node-5308" class="mjx-mrow"><span id="MJXc-Node-5309" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-5310" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5311" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5302" class="mjx-texatom" style=""><span id="MJXc-Node-5303" class="mjx-mrow"><span id="MJXc-Node-5304" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span><span id="MJXc-Node-5305" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5306" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-5312" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-5313" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5314" class="mjx-texatom" style=""><span id="MJXc-Node-5315" class="mjx-mrow"><span id="MJXc-Node-5316" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-5317" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span></span></span></span></span><span id="MJXc-Node-5318" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5319" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-5320" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5321" class="mjx-texatom" style=""><span id="MJXc-Node-5322" class="mjx-mrow"><span id="MJXc-Node-5323" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="width: 8.284em; bottom: -0.861em;"><span id="MJXc-Node-5324" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5325" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5326" class="mjx-texatom" style=""><span id="MJXc-Node-5327" class="mjx-mrow"><span id="MJXc-Node-5328" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-5329" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 8.284em;"></span></span><span class="mjx-vsize" style="height: 2.633em; vertical-align: -0.861em;"></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>=</mo><mfrac><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mfrac><mspace linebreak="newline"></mspace><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>−</mo><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub><mo>∗</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mrow><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mfrac><mspace linebreak="newline"></mspace><mo>.</mo><mo>.</mo><mo>.</mo><mspace linebreak="newline"></mspace><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi></mrow></msub><mo>−</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>i</mi></mrow></msub><mo>∗</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>m</mi></mrow></msub></mfrac></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-90">x_{1} = \frac{b_{1}}{l_{11}} \\
x_{2} = \frac{b_{2}-l_{21}*x_{1}}{l_{22}} \\
... \\
x_{m} = \frac{b_{m}-\sum_{i=1}^{m-1} l_{mi}*x_{i}}{l_{mm}}</script>

<p>Using the mathematical formulas, the code is easy to write:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Forward substitution algorithm</span>
<span class="c1">// Solves the linear system L * x = b</span>
<span class="c1">//</span>
<span class="c1">// L is lower triangular matrix of size NxN</span>
<span class="c1">// B is column matrix of size Nx1</span>
<span class="c1">// x is the solution column matrix of size Nx1</span>
<span class="c1">//</span>
<span class="c1">// Note: In case L is not a lower triangular matrix, the algorithm will try to</span>
<span class="c1">// select only the lower triangular part of the matrix L and solve the system</span>
<span class="c1">// with it.</span>
<span class="c1">//</span>
<span class="c1">// Note: In case any of the diagonal elements (L[i][i]) are 0 the system cannot</span>
<span class="c1">// be solved</span>
<span class="c1">//</span>
<span class="c1">// Note: This function is usually used with an L matrix from a LU decomposition</span>
<span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_ls_solvefwd</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">L</span><span class="p">,</span> <span class="n">nml_mat</span> <span class="o">*</span><span class="n">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat</span><span class="o">*</span> <span class="n">x</span> <span class="o">=</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="n">L</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">tmp</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">L</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span> <span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">tmp</span> <span class="o">-=</span> <span class="n">L</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">x</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span> <span class="o">/</span> <span class="n">L</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="backward-substitution">Backward substitution<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#backward-substitution" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>Backward substitution is the process of solving linear systems of equations <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-91-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5330" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5331" class="mjx-mrow"><span id="MJXc-Node-5332" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-5333" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5334" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span><span id="MJXc-Node-5335" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5336" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.182em;">Y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi><mo>∗</mo><mi>x</mi><mo>=</mo><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-91">U*x=Y</script> if <code class="language-plaintext highlighter-rouge">U</code> is an upper diagonal coefficient matrix.</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-92-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-5337" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5338" class="mjx-mrow"><span id="MJXc-Node-5339" class="mjx-mrow"><span id="MJXc-Node-5340" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-5341" class="mjx-mtable" style="vertical-align: -2.35em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5342" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5343" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.314em;"><span id="MJXc-Node-5344" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5345" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5346" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5347" class="mjx-texatom" style=""><span id="MJXc-Node-5348" class="mjx-mrow"><span id="MJXc-Node-5349" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5350" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.314em;"><span id="MJXc-Node-5351" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5352" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5353" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5354" class="mjx-texatom" style=""><span id="MJXc-Node-5355" class="mjx-mrow"><span id="MJXc-Node-5356" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5357" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.167em;"><span id="MJXc-Node-5358" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5359" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5360" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5361" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5362" class="mjx-mtd" style="padding: 0px 0.5em; width: 0px;"><span id="MJXc-Node-5363" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5364" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.849em;"><span id="MJXc-Node-5365" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5366" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5367" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5368" class="mjx-texatom" style=""><span id="MJXc-Node-5369" class="mjx-mrow"><span id="MJXc-Node-5370" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-5371" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5372" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5373" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-5374" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5375" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5376" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5377" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5378" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5379" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5380" class="mjx-texatom" style=""><span id="MJXc-Node-5381" class="mjx-mrow"><span id="MJXc-Node-5382" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">22</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5383" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5384" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5385" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5386" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5387" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5388" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5389" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5390" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-5391" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5392" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5393" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5394" class="mjx-texatom" style=""><span id="MJXc-Node-5395" class="mjx-mrow"><span id="MJXc-Node-5396" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span><span id="MJXc-Node-5397" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5398" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5399" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-5400" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5401" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5402" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5403" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5404" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5405" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5406" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5407" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5408" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5409" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5410" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5411" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5412" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5413" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5414" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5415" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5416" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-5417" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5418" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5419" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5420" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5421" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5422" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-5423" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5424" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5425" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5426" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5427" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5428" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5429" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5430" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5431" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5432" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5433" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5434" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5435" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-5436" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5437" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5438" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">u</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5439" class="mjx-texatom" style=""><span id="MJXc-Node-5440" class="mjx-mrow"><span id="MJXc-Node-5441" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span><span id="MJXc-Node-5442" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-5443" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-5444" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5445" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-5446" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-5447" class="mjx-mtable" style="vertical-align: -2.35em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5448" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5449" class="mjx-mtd" style="padding: 0px; width: 1.228em;"><span id="MJXc-Node-5450" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5451" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5452" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5453" class="mjx-texatom" style=""><span id="MJXc-Node-5454" class="mjx-mrow"><span id="MJXc-Node-5455" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5456" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5457" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5458" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5459" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5460" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5461" class="mjx-texatom" style=""><span id="MJXc-Node-5462" class="mjx-mrow"><span id="MJXc-Node-5463" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5464" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5465" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5466" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5467" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5468" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5469" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5470" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5471" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5472" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5473" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5474" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5475" class="mjx-texatom" style=""><span id="MJXc-Node-5476" class="mjx-mrow"><span id="MJXc-Node-5477" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-5478" class="mjx-mo" style="vertical-align: -1.681em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.534em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-5479" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5480" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-5481" class="mjx-mo" style="vertical-align: -1.726em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.423em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-5482" class="mjx-mtable" style="vertical-align: -2.395em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5483" class="mjx-mtr" style="height: 1.23em;"><span id="MJXc-Node-5484" class="mjx-mtd" style="padding: 0px; width: 1.167em;"><span id="MJXc-Node-5485" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5486" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-5487" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5488" class="mjx-texatom" style=""><span id="MJXc-Node-5489" class="mjx-mrow"><span id="MJXc-Node-5490" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5491" class="mjx-mtr" style="height: 1.43em;"><span id="MJXc-Node-5492" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5493" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5494" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-5495" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5496" class="mjx-texatom" style=""><span id="MJXc-Node-5497" class="mjx-mrow"><span id="MJXc-Node-5498" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5499" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5500" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5501" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5502" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5503" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-5504" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5505" class="mjx-mtr" style="height: 1.23em;"><span id="MJXc-Node-5506" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5507" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5508" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-5509" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5510" class="mjx-texatom" style=""><span id="MJXc-Node-5511" class="mjx-mrow"><span id="MJXc-Node-5512" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">m</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-5513" class="mjx-mo" style="vertical-align: -1.726em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.423em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mi>m</mi></mrow></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>m</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd></mtd><mtd><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>m</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>∗</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-92">\begin{bmatrix}
u_{11} & u_{12} & ... && u_{1m}\\
0 & u_{22} & ... && u_{2m} \\
... & ... & ... && ...\\
0 & 0 & ... && u_{mm}\\
\end{bmatrix}
*
\begin{bmatrix}
x_{1} \\
x_{2} \\
...   \\
x_{m}
\end{bmatrix}
=
\begin{bmatrix}
y_{1} \\
y_{2} \\
...   \\
y_{m}
\end{bmatrix}</script>

<p>Similar to the example above, the code implementation is straight-forward after we compute the mathematical formula:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Back substition algorithm</span>
<span class="c1">// Solves the linear system U *x = b</span>
<span class="c1">//</span>
<span class="c1">// U is an upper triangular matrix of size NxN</span>
<span class="c1">// B is a column matrix of size Nx1</span>
<span class="c1">// x is the solution column matrix of size Nx1</span>
<span class="c1">//</span>
<span class="c1">// Note in case U is not an upper triangular matrix, the algorithm will try to</span>
<span class="c1">// select only the upper triangular part of the matrix U and solve the system</span>
<span class="c1">// with it</span>
<span class="c1">//</span>
<span class="c1">// Note: In case any of the diagonal elements (U[i][i]) are 0 the system cannot</span>
<span class="c1">// be solved</span>
<span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_ls_solvebck</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">U</span><span class="p">,</span> <span class="n">nml_mat</span> <span class="o">*</span><span class="n">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="n">U</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">U</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">tmp</span><span class="p">;</span>
  <span class="k">while</span><span class="p">(</span><span class="n">i</span><span class="o">--&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">U</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">tmp</span> <span class="o">-=</span> <span class="n">U</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">x</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span> <span class="o">/</span> <span class="n">U</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<h3 id="solving-linear-systems-using-lup-decomposition">Solving linear systems using LU(P) decomposition<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#solving-linear-systems-using-lup-decomposition" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>Knowing the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-93-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5514" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5515" class="mjx-mrow"><span id="MJXc-Node-5516" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-5517" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5518" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-5519" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5520" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-5521" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5522" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo>∗</mo><mi>A</mi><mo>=</mo><mi>L</mi><mo>∗</mo><mi>U</mi></math></span></span><script type="math/tex" id="MathJax-Element-93">P * A = L * U</script> factorisation of a matrix allows us to solve a liniar system of equations in the form: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-94-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5523" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5524" class="mjx-mrow"><span id="MJXc-Node-5525" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-5526" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5527" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span><span id="MJXc-Node-5528" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5529" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>∗</mo><mi>x</mi><mo>=</mo><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-94">A*x=B</script> by using a combination of backward and forward substitution.</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-95-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;lt;=&amp;gt;&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;lt;=&amp;gt;&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 10.032em; position: relative;"><span id="MJXc-Node-5530" class="mjx-math" aria-hidden="true" style="width: 100%;"><span id="MJXc-Node-5531" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -2.474em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-5532" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-5533" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5534" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span><span id="MJXc-Node-5535" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5536" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span><span id="MJXc-Node-5537" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.254em; padding-bottom: 0.086em;">&lt;<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">&gt;</span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-5538" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-5539" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-5540" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5541" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-5542" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5543" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span><span id="MJXc-Node-5544" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5545" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-5546" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5547" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span><span id="MJXc-Node-5548" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.254em; padding-bottom: 0.086em;">&lt;<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">&gt;</span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-5549" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-5550" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-5551" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5552" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-5553" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5554" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span><span id="MJXc-Node-5555" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5556" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-5557" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5558" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>A</mi><mo>∗</mo><mi>x</mi><mo>=</mo><mi>B</mi><mo>&lt;=&gt;</mo><mspace linebreak="newline"></mspace><mi>P</mi><mo>∗</mo><mi>A</mi><mo>∗</mo><mi>x</mi><mo>=</mo><mi>P</mi><mo>∗</mo><mi>b</mi><mo>&lt;=&gt;</mo><mspace linebreak="newline"></mspace><mi>L</mi><mo>∗</mo><mi>U</mi><mo>∗</mo><mi>x</mi><mo>=</mo><mi>P</mi><mo>∗</mo><mi>b</mi></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-95">A * x = B <=> \\
P * A * x = P * b <=> \\
L * U * x = P * b</script>

<p>To make use of the previous two algorithms (<code class="language-plaintext highlighter-rouge">nml_ls_solvebck(...)</code>, <code class="language-plaintext highlighter-rouge">nml_ls_solvefwd(...)</code>) we can introduce an auxiliary system of equations: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-96-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5559" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5560" class="mjx-mrow"><span id="MJXc-Node-5561" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-5562" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5563" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-5564" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5565" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mi>U</mi><mo>∗</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-96">y=U*x</script>.</p>

<p>If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-97-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5566" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5567" class="mjx-mrow"><span id="MJXc-Node-5568" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-5569" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5570" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-5571" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5572" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mi>U</mi><mo>∗</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-97">y = U * x</script> =&gt; <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-98-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5573" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5574" class="mjx-mrow"><span id="MJXc-Node-5575" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-5576" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5577" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-5578" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5579" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-5580" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5581" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo>∗</mo><mi>y</mi><mo>=</mo><mi>P</mi><mo>∗</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-98">L * y = P * b</script>. This means that we need to solve two systems of equations:</p>

<ul>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-99-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5582" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5583" class="mjx-mrow"><span id="MJXc-Node-5584" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-5585" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5586" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-5587" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5588" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-5589" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5590" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo>∗</mo><mi>y</mi><mo>=</mo><mi>P</mi><mo>∗</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-99">L * y = P * b</script> - forward substition, because <code class="language-plaintext highlighter-rouge">L</code> is lower triangular matrix;</li>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-100-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5591" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5592" class="mjx-mrow"><span id="MJXc-Node-5593" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-5594" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5595" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span><span id="MJXc-Node-5596" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5597" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.006em;">y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi><mo>∗</mo><mi>x</mi><mo>=</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-100">U * x = y</script> - backward substitution, becuase <code class="language-plaintext highlighter-rouge">U</code> is an upper triangular matrix.</li>
</ul>

<p>Translating this into code is simple:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_ls_solve</span><span class="p">(</span><span class="n">nml_mat_lup</span> <span class="o">*</span><span class="n">lu</span><span class="p">,</span> <span class="n">nml_mat</span><span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">lu</span><span class="o">-&gt;</span><span class="n">U</span><span class="o">-&gt;</span><span class="n">num_rows</span> <span class="o">!=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">num_rows</span> <span class="o">||</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">num_cols</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_SOLVE_LIN_SYS_INVALID_B</span><span class="p">,</span>
      <span class="n">b</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">,</span>
      <span class="n">b</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">,</span>
      <span class="n">lu</span><span class="o">-&gt;</span><span class="n">U</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">,</span>
      <span class="mi">1</span><span class="p">);</span>
      <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">Pb</span> <span class="o">=</span> <span class="n">nml_mat_dot</span><span class="p">(</span><span class="n">lu</span><span class="o">-&gt;</span><span class="n">P</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>

  <span class="c1">// We solve L*y = P*b using forward substition</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">y</span> <span class="o">=</span> <span class="n">nml_ls_solvefwd</span><span class="p">(</span><span class="n">lu</span><span class="o">-&gt;</span><span class="n">L</span><span class="p">,</span> <span class="n">Pb</span><span class="p">);</span>

  <span class="c1">// We solve U*x=y</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="n">nml_ls_solvebck</span><span class="p">(</span><span class="n">lu</span><span class="o">-&gt;</span><span class="n">U</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>

  <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
  <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">Pb</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<h2 id="calculating-the-inverse-of-the-matrix-using-lup-decomposition">Calculating the inverse of the matrix using LU(P) decomposition<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#calculating-the-inverse-of-the-matrix-using-lup-decomposition" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<p>A matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-101-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5598" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5599" class="mjx-mrow"><span id="MJXc-Node-5600" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-101">A</script> is called invertible, if there exists a matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-102-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5601" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5602" class="mjx-mrow"><span id="MJXc-Node-5603" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5604" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5605" class="mjx-texatom" style=""><span id="MJXc-Node-5606" class="mjx-mrow"><span id="MJXc-Node-5607" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5608" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-102">A^{-1}</script> so that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-103-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5609" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5610" class="mjx-mrow"><span id="MJXc-Node-5611" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-5612" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5613" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-5614" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5615" class="mjx-texatom" style=""><span id="MJXc-Node-5616" class="mjx-mrow"><span id="MJXc-Node-5617" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5618" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-5619" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5620" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.064em;">I</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>∗</mo><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-103">A * A^{-1} = I</script>.</p>

<p>We call <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-104-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5621" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5622" class="mjx-mrow"><span id="MJXc-Node-5623" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5624" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5625" class="mjx-texatom" style=""><span id="MJXc-Node-5626" class="mjx-mrow"><span id="MJXc-Node-5627" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5628" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-104">A^{-1}</script> the inverse of the matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-105-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5629" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5630" class="mjx-mrow"><span id="MJXc-Node-5631" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-105">A</script>. The equality <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-106-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5632" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5633" class="mjx-mrow"><span id="MJXc-Node-5634" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-5635" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5636" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-5637" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5638" class="mjx-texatom" style=""><span id="MJXc-Node-5639" class="mjx-mrow"><span id="MJXc-Node-5640" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5641" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-5642" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5643" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.064em;">I</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>∗</mo><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-106">A*A^{-1}=I</script> in matrix form looks like:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-107-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;13&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;23&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;31&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;33&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;13&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;23&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;31&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;33&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-5644" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5645" class="mjx-mrow"><span id="MJXc-Node-5646" class="mjx-mrow"><span id="MJXc-Node-5647" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-5648" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5649" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5650" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.492em;"><span id="MJXc-Node-5651" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5652" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5653" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5654" class="mjx-texatom" style=""><span id="MJXc-Node-5655" class="mjx-mrow"><span id="MJXc-Node-5656" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5657" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.492em;"><span id="MJXc-Node-5658" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5659" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5660" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5661" class="mjx-texatom" style=""><span id="MJXc-Node-5662" class="mjx-mrow"><span id="MJXc-Node-5663" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5664" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.492em;"><span id="MJXc-Node-5665" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5666" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5667" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5668" class="mjx-texatom" style=""><span id="MJXc-Node-5669" class="mjx-mrow"><span id="MJXc-Node-5670" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">13</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5671" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5672" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-5673" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5674" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5675" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5676" class="mjx-texatom" style=""><span id="MJXc-Node-5677" class="mjx-mrow"><span id="MJXc-Node-5678" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">21</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5679" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5680" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5681" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5682" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5683" class="mjx-texatom" style=""><span id="MJXc-Node-5684" class="mjx-mrow"><span id="MJXc-Node-5685" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">22</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5686" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-5687" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5688" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5689" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5690" class="mjx-texatom" style=""><span id="MJXc-Node-5691" class="mjx-mrow"><span id="MJXc-Node-5692" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">23</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5693" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5694" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-5695" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5696" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5697" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5698" class="mjx-texatom" style=""><span id="MJXc-Node-5699" class="mjx-mrow"><span id="MJXc-Node-5700" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">31</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5701" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5702" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5703" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5704" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5705" class="mjx-texatom" style=""><span id="MJXc-Node-5706" class="mjx-mrow"><span id="MJXc-Node-5707" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">32</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5708" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-5709" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5710" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5711" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5712" class="mjx-texatom" style=""><span id="MJXc-Node-5713" class="mjx-mrow"><span id="MJXc-Node-5714" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">33</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-5715" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-5716" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5717" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-5718" class="mjx-mo" style="vertical-align: -1.38em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.5em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-5719" class="mjx-mtable" style="vertical-align: -2.049em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5720" class="mjx-mtr" style="height: 1.466em;"><span id="MJXc-Node-5721" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.689em;"><span id="MJXc-Node-5722" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-5723" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5724" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5728" class="mjx-texatom" style=""><span id="MJXc-Node-5729" class="mjx-mrow"><span id="MJXc-Node-5730" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5731" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5725" class="mjx-texatom" style=""><span id="MJXc-Node-5726" class="mjx-mrow"><span id="MJXc-Node-5727" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5732" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.689em;"><span id="MJXc-Node-5733" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-5734" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5735" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5739" class="mjx-texatom" style=""><span id="MJXc-Node-5740" class="mjx-mrow"><span id="MJXc-Node-5741" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5742" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5736" class="mjx-texatom" style=""><span id="MJXc-Node-5737" class="mjx-mrow"><span id="MJXc-Node-5738" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5743" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.689em;"><span id="MJXc-Node-5744" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-5745" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5746" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5750" class="mjx-texatom" style=""><span id="MJXc-Node-5751" class="mjx-mrow"><span id="MJXc-Node-5752" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5753" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5747" class="mjx-texatom" style=""><span id="MJXc-Node-5748" class="mjx-mrow"><span id="MJXc-Node-5749" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">13</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5754" class="mjx-mtr" style="height: 1.666em;"><span id="MJXc-Node-5755" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-5756" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-5757" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5758" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5762" class="mjx-texatom" style=""><span id="MJXc-Node-5763" class="mjx-mrow"><span id="MJXc-Node-5764" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5765" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5759" class="mjx-texatom" style=""><span id="MJXc-Node-5760" class="mjx-mrow"><span id="MJXc-Node-5761" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">21</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5766" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5767" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-5768" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5769" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5773" class="mjx-texatom" style=""><span id="MJXc-Node-5774" class="mjx-mrow"><span id="MJXc-Node-5775" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5776" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5770" class="mjx-texatom" style=""><span id="MJXc-Node-5771" class="mjx-mrow"><span id="MJXc-Node-5772" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">22</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5777" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-5778" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-5779" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5780" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5784" class="mjx-texatom" style=""><span id="MJXc-Node-5785" class="mjx-mrow"><span id="MJXc-Node-5786" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5787" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5781" class="mjx-texatom" style=""><span id="MJXc-Node-5782" class="mjx-mrow"><span id="MJXc-Node-5783" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">23</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5788" class="mjx-mtr" style="height: 1.466em;"><span id="MJXc-Node-5789" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-5790" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-5791" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5792" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5796" class="mjx-texatom" style=""><span id="MJXc-Node-5797" class="mjx-mrow"><span id="MJXc-Node-5798" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5799" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5793" class="mjx-texatom" style=""><span id="MJXc-Node-5794" class="mjx-mrow"><span id="MJXc-Node-5795" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">31</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5800" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5801" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-5802" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5803" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5807" class="mjx-texatom" style=""><span id="MJXc-Node-5808" class="mjx-mrow"><span id="MJXc-Node-5809" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5810" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5804" class="mjx-texatom" style=""><span id="MJXc-Node-5805" class="mjx-mrow"><span id="MJXc-Node-5806" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">32</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5811" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-5812" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-5813" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5814" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.314em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5818" class="mjx-texatom" style=""><span id="MJXc-Node-5819" class="mjx-mrow"><span id="MJXc-Node-5820" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5821" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5815" class="mjx-texatom" style=""><span id="MJXc-Node-5816" class="mjx-mrow"><span id="MJXc-Node-5817" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">33</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-5822" class="mjx-mo" style="vertical-align: -1.38em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.5em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-5823" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5824" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-5825" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-5826" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5827" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5828" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.5em;"><span id="MJXc-Node-5829" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5830" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5831" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-5832" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5833" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5834" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.5em;"><span id="MJXc-Node-5835" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5836" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5837" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5838" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-5839" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5840" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5841" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5842" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5843" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5844" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-5845" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5846" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5847" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5848" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-5849" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5850" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5851" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5852" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5853" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5854" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-5855" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5856" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-5857" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>13</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>23</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>31</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>33</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>∗</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>13</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>23</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>31</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>33</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-107">\begin{bmatrix}
A_{11} & A_{12} & A_{13} \\
A_{21} & A_{22} & A_{23} \\
A_{31} & A_{32} & A_{33}
\end{bmatrix}
*
\begin{bmatrix}
A_{11}^{-1} & A_{12}^{-1} & A_{13}^{-1} \\
A_{21}^{-1} & A_{22}^{-1} & A_{23}^{-1} \\
A_{31}^{-1} & A_{32}^{-1} & A_{33}^{-1}
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix}</script>

<p>To find <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-108-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-5858" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5859" class="mjx-mrow"><span id="MJXc-Node-5860" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5861" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5866" class="mjx-texatom" style=""><span id="MJXc-Node-5867" class="mjx-mrow"><span id="MJXc-Node-5868" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5869" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5862" class="mjx-texatom" style=""><span id="MJXc-Node-5863" class="mjx-mrow"><span id="MJXc-Node-5864" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span><span id="MJXc-Node-5865" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.464em;">j</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-108">A_{ij}^{-1}</script> we solve 3 systems of linear equations in the form:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-109-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;13&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;23&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;31&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;33&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;31&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;13&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;23&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;31&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;33&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;13&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;23&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;31&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;33&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;13&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;23&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;33&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-5870" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5871" class="mjx-mrow"><span id="MJXc-Node-5872" class="mjx-mrow"><span id="MJXc-Node-5873" class="mjx-mo" style="vertical-align: -5.892em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.674em; padding-bottom: 0.296em;">⎧</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.249em; margin-bottom: 0.087em; margin-top: -0.137em;">⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎨</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.249em; margin-bottom: 0.087em; margin-top: -0.137em;">⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪</span><span class="mjx-char MJXc-TeX-size4-R" style="margin-top: -0.208em; padding-bottom: 1.179em;">⎩</span></span></span><span id="MJXc-Node-5874" class="mjx-mtable" style="vertical-align: -6.816em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5875" class="mjx-mtr" style="height: 4.667em;"><span id="MJXc-Node-5876" class="mjx-mtd" style="padding: 0px; text-align: left; width: 15.946em;"><span id="MJXc-Node-5877" class="mjx-mrow"><span id="MJXc-Node-5878" class="mjx-mrow"><span id="MJXc-Node-5879" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-5880" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5881" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5882" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.492em;"><span id="MJXc-Node-5883" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5884" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5885" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5886" class="mjx-texatom" style=""><span id="MJXc-Node-5887" class="mjx-mrow"><span id="MJXc-Node-5888" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5889" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.492em;"><span id="MJXc-Node-5890" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5891" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5892" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5893" class="mjx-texatom" style=""><span id="MJXc-Node-5894" class="mjx-mrow"><span id="MJXc-Node-5895" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5896" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.492em;"><span id="MJXc-Node-5897" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5898" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5899" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5900" class="mjx-texatom" style=""><span id="MJXc-Node-5901" class="mjx-mrow"><span id="MJXc-Node-5902" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">13</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5903" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5904" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-5905" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5906" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5907" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5908" class="mjx-texatom" style=""><span id="MJXc-Node-5909" class="mjx-mrow"><span id="MJXc-Node-5910" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">21</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5911" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5912" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5913" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5914" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5915" class="mjx-texatom" style=""><span id="MJXc-Node-5916" class="mjx-mrow"><span id="MJXc-Node-5917" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">22</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5918" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-5919" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5920" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5921" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5922" class="mjx-texatom" style=""><span id="MJXc-Node-5923" class="mjx-mrow"><span id="MJXc-Node-5924" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">23</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5925" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5926" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-5927" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5928" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5929" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5930" class="mjx-texatom" style=""><span id="MJXc-Node-5931" class="mjx-mrow"><span id="MJXc-Node-5932" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">31</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5933" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-5934" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5935" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5936" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5937" class="mjx-texatom" style=""><span id="MJXc-Node-5938" class="mjx-mrow"><span id="MJXc-Node-5939" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">32</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-5940" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-5941" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5942" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5943" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5944" class="mjx-texatom" style=""><span id="MJXc-Node-5945" class="mjx-mrow"><span id="MJXc-Node-5946" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">33</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-5947" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-5948" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-5949" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-5950" class="mjx-mo" style="vertical-align: -1.365em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.485em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-5951" class="mjx-mtable" style="vertical-align: -2.034em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5952" class="mjx-mtr" style="height: 1.451em;"><span id="MJXc-Node-5953" class="mjx-mtd" style="padding: 0px; width: 1.689em;"><span id="MJXc-Node-5954" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-5955" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5956" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5960" class="mjx-texatom" style=""><span id="MJXc-Node-5961" class="mjx-mrow"><span id="MJXc-Node-5962" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5963" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5957" class="mjx-texatom" style=""><span id="MJXc-Node-5958" class="mjx-mrow"><span id="MJXc-Node-5959" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5964" class="mjx-mtr" style="height: 1.651em;"><span id="MJXc-Node-5965" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5966" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-5967" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5968" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5972" class="mjx-texatom" style=""><span id="MJXc-Node-5973" class="mjx-mrow"><span id="MJXc-Node-5974" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5975" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5969" class="mjx-texatom" style=""><span id="MJXc-Node-5970" class="mjx-mrow"><span id="MJXc-Node-5971" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">21</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5976" class="mjx-mtr" style="height: 1.466em;"><span id="MJXc-Node-5977" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5978" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-5979" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5980" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5984" class="mjx-texatom" style=""><span id="MJXc-Node-5985" class="mjx-mrow"><span id="MJXc-Node-5986" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-5987" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5981" class="mjx-texatom" style=""><span id="MJXc-Node-5982" class="mjx-mrow"><span id="MJXc-Node-5983" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">31</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-5988" class="mjx-mo" style="vertical-align: -1.365em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.485em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-5989" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-5990" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-5991" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-5992" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5993" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-5994" class="mjx-mtd" style="padding: 0px; width: 0.5em;"><span id="MJXc-Node-5995" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5996" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5997" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5998" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5999" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6000" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6001" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-6002" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-6003" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6004" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-6005" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6006" class="mjx-mtr" style="height: 4.767em;"><span id="MJXc-Node-6007" class="mjx-mtd" style="padding: 0.1em 0px 0px; text-align: left;"><span id="MJXc-Node-6008" class="mjx-mrow"><span id="MJXc-Node-6009" class="mjx-mrow"><span id="MJXc-Node-6010" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-6011" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-6012" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-6013" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.492em;"><span id="MJXc-Node-6014" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6015" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6016" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6017" class="mjx-texatom" style=""><span id="MJXc-Node-6018" class="mjx-mrow"><span id="MJXc-Node-6019" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6020" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.492em;"><span id="MJXc-Node-6021" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6022" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6023" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6024" class="mjx-texatom" style=""><span id="MJXc-Node-6025" class="mjx-mrow"><span id="MJXc-Node-6026" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6027" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.492em;"><span id="MJXc-Node-6028" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6029" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6030" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6031" class="mjx-texatom" style=""><span id="MJXc-Node-6032" class="mjx-mrow"><span id="MJXc-Node-6033" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">13</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6034" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-6035" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-6036" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6037" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6038" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6039" class="mjx-texatom" style=""><span id="MJXc-Node-6040" class="mjx-mrow"><span id="MJXc-Node-6041" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">21</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6042" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-6043" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6044" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6045" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6046" class="mjx-texatom" style=""><span id="MJXc-Node-6047" class="mjx-mrow"><span id="MJXc-Node-6048" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">22</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6049" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-6050" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6051" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6052" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6053" class="mjx-texatom" style=""><span id="MJXc-Node-6054" class="mjx-mrow"><span id="MJXc-Node-6055" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">23</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6056" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-6057" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-6058" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6059" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6060" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6061" class="mjx-texatom" style=""><span id="MJXc-Node-6062" class="mjx-mrow"><span id="MJXc-Node-6063" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">31</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6064" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-6065" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6066" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6067" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6068" class="mjx-texatom" style=""><span id="MJXc-Node-6069" class="mjx-mrow"><span id="MJXc-Node-6070" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">32</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6071" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-6072" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6073" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6074" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6075" class="mjx-texatom" style=""><span id="MJXc-Node-6076" class="mjx-mrow"><span id="MJXc-Node-6077" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">33</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-6078" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-6079" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6080" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-6081" class="mjx-mo" style="vertical-align: -1.365em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.485em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-6082" class="mjx-mtable" style="vertical-align: -2.034em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-6083" class="mjx-mtr" style="height: 1.451em;"><span id="MJXc-Node-6084" class="mjx-mtd" style="padding: 0px; width: 1.689em;"><span id="MJXc-Node-6085" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-6086" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6087" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6091" class="mjx-texatom" style=""><span id="MJXc-Node-6092" class="mjx-mrow"><span id="MJXc-Node-6093" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6094" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6088" class="mjx-texatom" style=""><span id="MJXc-Node-6089" class="mjx-mrow"><span id="MJXc-Node-6090" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6095" class="mjx-mtr" style="height: 1.651em;"><span id="MJXc-Node-6096" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-6097" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-6098" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6099" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6103" class="mjx-texatom" style=""><span id="MJXc-Node-6104" class="mjx-mrow"><span id="MJXc-Node-6105" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6106" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6100" class="mjx-texatom" style=""><span id="MJXc-Node-6101" class="mjx-mrow"><span id="MJXc-Node-6102" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">22</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6107" class="mjx-mtr" style="height: 1.466em;"><span id="MJXc-Node-6108" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-6109" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-6110" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6111" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6115" class="mjx-texatom" style=""><span id="MJXc-Node-6116" class="mjx-mrow"><span id="MJXc-Node-6117" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6118" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6112" class="mjx-texatom" style=""><span id="MJXc-Node-6113" class="mjx-mrow"><span id="MJXc-Node-6114" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">32</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-6119" class="mjx-mo" style="vertical-align: -1.365em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.485em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-6120" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6121" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-6122" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-6123" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-6124" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-6125" class="mjx-mtd" style="padding: 0px; width: 0.5em;"><span id="MJXc-Node-6126" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6127" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6128" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-6129" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-6130" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6131" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6132" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-6133" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-6134" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6135" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-6136" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6137" class="mjx-mtr" style="height: 4.698em;"><span id="MJXc-Node-6138" class="mjx-mtd" style="padding: 0.1em 0px 0px; text-align: left;"><span id="MJXc-Node-6139" class="mjx-mrow"><span id="MJXc-Node-6140" class="mjx-mrow"><span id="MJXc-Node-6141" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-6142" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-6143" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-6144" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.492em;"><span id="MJXc-Node-6145" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6146" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6147" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6148" class="mjx-texatom" style=""><span id="MJXc-Node-6149" class="mjx-mrow"><span id="MJXc-Node-6150" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">11</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6151" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.492em;"><span id="MJXc-Node-6152" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6153" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6154" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6155" class="mjx-texatom" style=""><span id="MJXc-Node-6156" class="mjx-mrow"><span id="MJXc-Node-6157" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">12</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6158" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.492em;"><span id="MJXc-Node-6159" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6160" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6161" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6162" class="mjx-texatom" style=""><span id="MJXc-Node-6163" class="mjx-mrow"><span id="MJXc-Node-6164" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">13</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6165" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-6166" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-6167" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6168" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6169" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6170" class="mjx-texatom" style=""><span id="MJXc-Node-6171" class="mjx-mrow"><span id="MJXc-Node-6172" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">21</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6173" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-6174" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6175" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6176" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6177" class="mjx-texatom" style=""><span id="MJXc-Node-6178" class="mjx-mrow"><span id="MJXc-Node-6179" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">22</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6180" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-6181" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6182" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6183" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6184" class="mjx-texatom" style=""><span id="MJXc-Node-6185" class="mjx-mrow"><span id="MJXc-Node-6186" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">23</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6187" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-6188" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-6189" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6190" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6191" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6192" class="mjx-texatom" style=""><span id="MJXc-Node-6193" class="mjx-mrow"><span id="MJXc-Node-6194" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">31</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6195" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-6196" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6197" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6198" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6199" class="mjx-texatom" style=""><span id="MJXc-Node-6200" class="mjx-mrow"><span id="MJXc-Node-6201" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">32</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6202" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-6203" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6204" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6205" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6206" class="mjx-texatom" style=""><span id="MJXc-Node-6207" class="mjx-mrow"><span id="MJXc-Node-6208" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">33</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-6209" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-6210" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6211" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-6212" class="mjx-mo" style="vertical-align: -1.38em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.5em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-6213" class="mjx-mtable" style="vertical-align: -2.049em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-6214" class="mjx-mtr" style="height: 1.466em;"><span id="MJXc-Node-6215" class="mjx-mtd" style="padding: 0px; width: 1.689em;"><span id="MJXc-Node-6216" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-6217" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6218" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6222" class="mjx-texatom" style=""><span id="MJXc-Node-6223" class="mjx-mrow"><span id="MJXc-Node-6224" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6225" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6219" class="mjx-texatom" style=""><span id="MJXc-Node-6220" class="mjx-mrow"><span id="MJXc-Node-6221" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">13</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6226" class="mjx-mtr" style="height: 1.666em;"><span id="MJXc-Node-6227" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-6228" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-6229" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6230" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6234" class="mjx-texatom" style=""><span id="MJXc-Node-6235" class="mjx-mrow"><span id="MJXc-Node-6236" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6237" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6231" class="mjx-texatom" style=""><span id="MJXc-Node-6232" class="mjx-mrow"><span id="MJXc-Node-6233" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">23</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6238" class="mjx-mtr" style="height: 1.465em;"><span id="MJXc-Node-6239" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-6240" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-6241" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6242" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.314em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6246" class="mjx-texatom" style=""><span id="MJXc-Node-6247" class="mjx-mrow"><span id="MJXc-Node-6248" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6249" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6243" class="mjx-texatom" style=""><span id="MJXc-Node-6244" class="mjx-mrow"><span id="MJXc-Node-6245" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">33</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-6250" class="mjx-mo" style="vertical-align: -1.38em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.5em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-6251" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6252" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-6253" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-6254" class="mjx-mtable" style="vertical-align: -1.65em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-6255" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-6256" class="mjx-mtd" style="padding: 0px; width: 0.5em;"><span id="MJXc-Node-6257" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6258" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6259" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-6260" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-6261" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6262" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6263" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-6264" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-6265" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6266" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-6267" class="mjx-mo" style="vertical-align: -0.981em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.202em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-6268" class="mjx-mo" style="width: 0.12em;"></span></span><span id="MJXc-Node-6269" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.212em; padding-bottom: 0.338em;">→</span></span><span id="MJXc-Node-6270" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-6271" class="mjx-mo" style="vertical-align: -0.947em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.674em; padding-bottom: 0.296em;">⎧</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.139em; margin-bottom: 0.087em; margin-top: -0.137em;">⎪
⎪</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎨</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.139em; margin-bottom: 0.087em; margin-top: -0.137em;">⎪
⎪</span><span class="mjx-char MJXc-TeX-size4-R" style="margin-top: -0.208em; padding-bottom: 1.179em;">⎩</span></span></span><span id="MJXc-Node-6272" class="mjx-mtable" style="vertical-align: -1.871em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-6273" class="mjx-mtr" style="height: 1.378em;"><span id="MJXc-Node-6274" class="mjx-mtd" style="padding: 0px; text-align: left; width: 6.716em;"><span id="MJXc-Node-6275" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-6276" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-6277" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6278" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-6279" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6286" class="mjx-texatom" style=""><span id="MJXc-Node-6287" class="mjx-mrow"><span id="MJXc-Node-6288" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6289" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6280" class="mjx-texatom" style=""><span id="MJXc-Node-6281" class="mjx-mrow"><span id="MJXc-Node-6282" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span><span id="MJXc-Node-6283" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-6284" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span><span id="MJXc-Node-6285" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-6290" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6291" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.064em;"><span id="MJXc-Node-6292" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.064em;">I</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-6293" class="mjx-texatom" style=""><span id="MJXc-Node-6294" class="mjx-mrow"><span id="MJXc-Node-6295" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span><span id="MJXc-Node-6296" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-6297" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span><span id="MJXc-Node-6298" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6299" class="mjx-mtr" style="height: 1.478em;"><span id="MJXc-Node-6300" class="mjx-mtd" style="padding: 0.1em 0px 0px; text-align: left;"><span id="MJXc-Node-6301" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-6302" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-6303" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6304" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-6305" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6312" class="mjx-texatom" style=""><span id="MJXc-Node-6313" class="mjx-mrow"><span id="MJXc-Node-6314" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6315" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6306" class="mjx-texatom" style=""><span id="MJXc-Node-6307" class="mjx-mrow"><span id="MJXc-Node-6308" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span><span id="MJXc-Node-6309" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-6310" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span><span id="MJXc-Node-6311" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span></span><span id="MJXc-Node-6316" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6317" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.064em;"><span id="MJXc-Node-6318" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.064em;">I</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-6319" class="mjx-texatom" style=""><span id="MJXc-Node-6320" class="mjx-mrow"><span id="MJXc-Node-6321" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span><span id="MJXc-Node-6322" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-6323" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span><span id="MJXc-Node-6324" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6325" class="mjx-mtr" style="height: 1.386em;"><span id="MJXc-Node-6326" class="mjx-mtd" style="padding: 0.1em 0px 0px; text-align: left;"><span id="MJXc-Node-6327" class="mjx-mrow" style="margin-top: -0.082em;"><span id="MJXc-Node-6328" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-6329" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6330" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-6331" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6338" class="mjx-texatom" style=""><span id="MJXc-Node-6339" class="mjx-mrow"><span id="MJXc-Node-6340" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6341" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6332" class="mjx-texatom" style=""><span id="MJXc-Node-6333" class="mjx-mrow"><span id="MJXc-Node-6334" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span><span id="MJXc-Node-6335" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-6336" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span><span id="MJXc-Node-6337" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span></span><span id="MJXc-Node-6342" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6343" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.064em;"><span id="MJXc-Node-6344" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.064em;">I</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-6345" class="mjx-texatom" style=""><span id="MJXc-Node-6346" class="mjx-mrow"><span id="MJXc-Node-6347" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">c</span></span><span id="MJXc-Node-6348" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">o</span></span><span id="MJXc-Node-6349" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">l</span></span><span id="MJXc-Node-6350" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-6351" class="mjx-mo" style="width: 0.12em;"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>13</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>23</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>31</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>33</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>∗</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>31</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>13</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>23</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>31</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>33</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>∗</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>13</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>23</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>31</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow></msub></mtd><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>33</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>∗</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>13</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>23</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mn>33</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow><mo stretchy="false">→</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mi>A</mi><mo>∗</mo><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>o</mi><mi>l</mi><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup><mo>=</mo><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>o</mi><mi>l</mi><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><mi>A</mi><mo>∗</mo><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>o</mi><mi>l</mi><mn>2</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup><mo>=</mo><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>o</mi><mi>l</mi><mn>2</mn></mrow></msub></mtd></mtr><mtr><mtd><mi>A</mi><mo>∗</mo><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>o</mi><mi>l</mi><mn>3</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup><mo>=</mo><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>o</mi><mi>l</mi><mn>3</mn></mrow></msub></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-109">\begin{cases}
\begin{bmatrix}
A_{11} & A_{12} & A_{13} \\
A_{21} & A_{22} & A_{23} \\
A_{31} & A_{32} & A_{33}
\end{bmatrix}
*
\begin{bmatrix}
A_{11}^{-1}  \\
A_{21}^{-1}  \\
A_{31}^{-1}
\end{bmatrix}
=
\begin{bmatrix}
1 \\
0 \\
0 
\end{bmatrix}
\\
\begin{bmatrix}
A_{11} & A_{12} & A_{13} \\
A_{21} & A_{22} & A_{23} \\
A_{31} & A_{32} & A_{33}
\end{bmatrix}
*
\begin{bmatrix}
A_{12}^{-1}  \\
A_{22}^{-1}  \\
A_{32}^{-1}
\end{bmatrix}
=
\begin{bmatrix}
0 \\
1 \\
0
\end{bmatrix}
\\
\begin{bmatrix}
A_{11} & A_{12} & A_{13} \\
A_{21} & A_{22} & A_{23} \\
A_{31} & A_{32} & A_{33}
\end{bmatrix}
*
\begin{bmatrix}
A_{13}^{-1}  \\
A_{23}^{-1}  \\
A_{33}^{-1}
\end{bmatrix}
=
\begin{bmatrix}
0 \\
0 \\
1
\end{bmatrix}
\end{cases}
\rightarrow
\begin{cases}
A * A_{col1}^{-1} = I_{col1} \\
A * A_{col2}^{-1} = I_{col2} \\
A * A_{col3}^{-1} = I_{col3} \\
\end{cases}</script>

<p>This means we need to solve actually three systems of type: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-110-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6352" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6353" class="mjx-mrow"><span id="MJXc-Node-6354" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-6355" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6356" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-6357" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6358" class="mjx-texatom" style=""><span id="MJXc-Node-6359" class="mjx-mrow"><span id="MJXc-Node-6360" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span></span></span></span></span><span id="MJXc-Node-6361" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6362" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-6363" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6364" class="mjx-texatom" style=""><span id="MJXc-Node-6365" class="mjx-mrow"><span id="MJXc-Node-6366" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>∗</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-110">A * x_{i} = B_{i}</script> where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-111-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6367" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6368" class="mjx-mrow"><span id="MJXc-Node-6369" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6370" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6371" class="mjx-texatom" style=""><span id="MJXc-Node-6372" class="mjx-mrow"><span id="MJXc-Node-6373" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-111">x_{i}</script> represents the column <code class="language-plaintext highlighter-rouge">i</code> of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-112-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6374" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6375" class="mjx-mrow"><span id="MJXc-Node-6376" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6377" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6378" class="mjx-texatom" style=""><span id="MJXc-Node-6379" class="mjx-mrow"><span id="MJXc-Node-6380" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6381" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-112">A^{-1}</script>, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-113-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6382" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6383" class="mjx-mrow"><span id="MJXc-Node-6384" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6385" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">B</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6386" class="mjx-texatom" style=""><span id="MJXc-Node-6387" class="mjx-mrow"><span id="MJXc-Node-6388" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-113">B_{i}</script> represents the column <code class="language-plaintext highlighter-rouge">i</code> of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-114-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6389" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6390" class="mjx-mrow"><span id="MJXc-Node-6391" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.064em;">I</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-114">I</script>.</p>

<p>Having said this, the C code implementing the algorithm is as follows:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Calculates the inverse of a matrix</span>
<span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_inv</span><span class="p">(</span><span class="n">nml_mat_lup</span> <span class="o">*</span><span class="n">lup</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">unsigned</span> <span class="n">n</span> <span class="o">=</span> <span class="n">lup</span><span class="o">-&gt;</span><span class="n">L</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_sqr</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">I</span> <span class="o">=</span> <span class="n">nml_mat_eye</span><span class="p">(</span><span class="n">lup</span><span class="o">-&gt;</span><span class="n">U</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">);</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">invx</span><span class="p">;</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">Ix</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Ix</span> <span class="o">=</span> <span class="n">nml_mat_col_get</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
    <span class="n">invx</span> <span class="o">=</span> <span class="n">nml_ls_solve</span><span class="p">(</span><span class="n">lup</span><span class="p">,</span> <span class="n">Ix</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">invx</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">invx</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">invx</span><span class="p">);</span>
    <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">Ix</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">I</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<h2 id="calculating-the-determinant-of-the-matrix-using-lup-decomposition">Calculating the determinant of the matrix using LU(P) decomposition<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#calculating-the-determinant-of-the-matrix-using-lup-decomposition" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<p>The determinant of the product of two matrices is the product of their determinants. After LU(P) decomposition we have <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-115-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo&gt;=&amp;gt;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6392" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6393" class="mjx-mrow"><span id="MJXc-Node-6394" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6395" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6396" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-6397" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6398" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-6399" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6400" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-6401" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.254em; padding-bottom: 0.086em;">=<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">&gt;</span></span></span><span id="MJXc-Node-6402" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-6403" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-6404" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">t</span></span><span id="MJXc-Node-6405" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-6406" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6407" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span><span id="MJXc-Node-6408" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6409" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-6410" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-6411" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">t</span></span><span id="MJXc-Node-6412" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-6413" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-6414" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span><span id="MJXc-Node-6415" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6416" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-6417" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-6418" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">t</span></span><span id="MJXc-Node-6419" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-6420" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-6421" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span><span id="MJXc-Node-6422" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6423" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-6424" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-6425" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">t</span></span><span id="MJXc-Node-6426" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-6427" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-6428" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo>∗</mo><mi>A</mi><mo>=</mo><mi>L</mi><mo>∗</mo><mi>U</mi><mo>=&gt;</mo><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo>=</mo><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-115">P * A = L * U => det(P) * det(A) = det(L) * det(U)</script>.</p>

<p>Because <code class="language-plaintext highlighter-rouge">P</code> is a permutation of <code class="language-plaintext highlighter-rouge">I</code>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-116-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;n is even&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;n is odd&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-6429" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6430" class="mjx-mrow"><span id="MJXc-Node-6431" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-6432" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-6433" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">t</span></span><span id="MJXc-Node-6434" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-6435" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6436" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span><span id="MJXc-Node-6437" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6438" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-6439" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6440" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-6441" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6442" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6443" class="mjx-texatom" style=""><span id="MJXc-Node-6444" class="mjx-mrow"><span id="MJXc-Node-6445" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span id="MJXc-Node-6446" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6447" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.464em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-6448" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-6449" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span><span id="MJXc-Node-6450" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span><span id="MJXc-Node-6451" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-6452" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">{</span></span><span id="MJXc-Node-6453" class="mjx-mtable" style="vertical-align: -0.869em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-6454" class="mjx-mtr" style="height: 1.119em;"><span id="MJXc-Node-6455" class="mjx-mtd" style="padding: 0px; text-align: left; width: 5.063em;"><span id="MJXc-Node-6456" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6457" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-6458" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-6459" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">n is even</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6460" class="mjx-mtr" style="height: 1.119em;"><span id="MJXc-Node-6461" class="mjx-mtd" style="padding: 0.1em 0px 0px; text-align: left;"><span id="MJXc-Node-6462" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6463" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6464" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span><span id="MJXc-Node-6465" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-6466" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.422em; padding-bottom: 0.338em;">n is odd</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-6467" class="mjx-mo" style="width: 0.12em;"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msup><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mn>1</mn><mo>,</mo><mtext>n is even</mtext></mtd></mtr><mtr><mtd><mo>−</mo><mn>1</mn><mo>,</mo><mtext>n is odd</mtext></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-116">det(P) = (-1)^{n} = f(n)
\begin{cases}
1, \text{n is even} \\
-1, \text{n is odd}
\end{cases}</script>

<p><code class="language-plaintext highlighter-rouge">n</code> represents the total number of permutations of I. This value is already computed and stored in <code class="language-plaintext highlighter-rouge">nml_mat_lup-&gt;num_permutations</code>.</p>

<p><code class="language-plaintext highlighter-rouge">L</code> is a lower triangular matrix. The determinant of a lower triangular matrix is the product of its diagonal elements <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-117-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;=&amp;gt;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6468" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6469" class="mjx-mrow"><span id="MJXc-Node-6470" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.254em; padding-bottom: 0.086em;">=<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">&gt;</span></span></span><span id="MJXc-Node-6471" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-6472" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-6473" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">t</span></span><span id="MJXc-Node-6474" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-6475" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-6476" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span><span id="MJXc-Node-6477" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6478" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=&gt;</mo><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-117">=> det(L) = 1</script>.</p>

<p><code class="language-plaintext highlighter-rouge">U</code> is an upper triangular matrix. The determinant of an upper triangular matrix is the product of its diagonal elements <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-118-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;=&amp;gt;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6479" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6480" class="mjx-mrow"><span id="MJXc-Node-6481" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.254em; padding-bottom: 0.086em;">=<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">&gt;</span></span></span><span id="MJXc-Node-6482" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-6483" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-6484" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">t</span></span><span id="MJXc-Node-6485" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-6486" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-6487" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span><span id="MJXc-Node-6488" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6489" class="mjx-munderover MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-6490" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.506em; padding-bottom: 0.506em;">∏</span></span></span><span class="mjx-stack" style="vertical-align: -0.31em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.433em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6496" class="mjx-texatom" style=""><span id="MJXc-Node-6497" class="mjx-mrow"><span id="MJXc-Node-6498" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.085em;">N</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6491" class="mjx-texatom" style=""><span id="MJXc-Node-6492" class="mjx-mrow"><span id="MJXc-Node-6493" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span><span id="MJXc-Node-6494" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6495" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-6499" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.084em;"><span id="MJXc-Node-6500" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6501" class="mjx-texatom" style=""><span id="MJXc-Node-6502" class="mjx-mrow"><span id="MJXc-Node-6503" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span><span id="MJXc-Node-6504" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=&gt;</mo><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow></munderover><msub><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-118">=> det(U) = \prod_{i=1}^{N} U_{ii}</script>.</p>

<p>So, our initial relationship: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-119-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;lt;=&amp;gt;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mtext&gt;f(num_permutations)&lt;/mtext&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6505" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6506" class="mjx-mrow"><span id="MJXc-Node-6507" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-6508" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-6509" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">t</span></span><span id="MJXc-Node-6510" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-6511" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6512" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span><span id="MJXc-Node-6513" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6514" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-6515" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-6516" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">t</span></span><span id="MJXc-Node-6517" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-6518" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-6519" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span><span id="MJXc-Node-6520" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6521" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-6522" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-6523" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">t</span></span><span id="MJXc-Node-6524" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-6525" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span><span id="MJXc-Node-6526" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span><span id="MJXc-Node-6527" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6528" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-6529" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-6530" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">t</span></span><span id="MJXc-Node-6531" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-6532" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6533" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span><span id="MJXc-Node-6534" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.254em; padding-bottom: 0.086em;">&lt;<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">&gt;</span></span></span><span id="MJXc-Node-6535" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-6536" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">e</span></span><span id="MJXc-Node-6537" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">t</span></span><span id="MJXc-Node-6538" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">(</span></span><span id="MJXc-Node-6539" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-6540" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">)</span></span><span id="MJXc-Node-6541" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6542" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 6.729em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 9.516em; top: -1.888em;"><span id="MJXc-Node-6543" class="mjx-mrow" style=""><span id="MJXc-Node-6544" class="mjx-munderover"><span class="mjx-base"><span id="MJXc-Node-6545" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.506em; padding-bottom: 0.506em;">∏</span></span></span><span class="mjx-stack" style="vertical-align: -0.31em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.433em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6551" class="mjx-texatom" style=""><span id="MJXc-Node-6552" class="mjx-mrow"><span id="MJXc-Node-6553" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.085em;">N</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6546" class="mjx-texatom" style=""><span id="MJXc-Node-6547" class="mjx-mrow"><span id="MJXc-Node-6548" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span><span id="MJXc-Node-6549" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6550" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-6554" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.084em;"><span id="MJXc-Node-6555" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.084em;">U</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6556" class="mjx-texatom" style=""><span id="MJXc-Node-6557" class="mjx-mrow"><span id="MJXc-Node-6558" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span><span id="MJXc-Node-6559" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 9.516em; bottom: -0.893em;"><span id="MJXc-Node-6560" class="mjx-mtext" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">f(num_permutations)</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 6.729em;"></span></span><span class="mjx-vsize" style="height: 1.966em; vertical-align: -0.631em;"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo>=</mo><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo><mo>&lt;=&gt;</mo><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow></munderover><msub><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>i</mi></mrow></msub></mrow><mtext>f(num_permutations)</mtext></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-119">det(P) * det(A) = det(L) * det(P) <=> det(A) = \frac{\prod_{i=1}^{N} U_{ii}}{\text{f(num_permutations)}}</script>.</p>

<p>This means that the determinant of matrix <code class="language-plaintext highlighter-rouge">A</code> is actually the product of the diagonal elements of matrix <code class="language-plaintext highlighter-rouge">U</code> multiplied with <em>(-1)</em> in case the number of row permutations is odd.</p>

<p>Putting this into code is as simple as:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// After the LU(P) factorisation the determinant can be easily calculated</span>
<span class="c1">// by multiplying the main diagonal of matrix U with the sign.</span>
<span class="c1">// the sign is -1 if the number of permutations is odd</span>
<span class="c1">// the sign is +1 if the number of permutations is even</span>
<span class="kt">double</span> <span class="nf">nml_mat_det</span><span class="p">(</span><span class="n">nml_mat_lup</span><span class="o">*</span> <span class="n">lup</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">k</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">sign</span> <span class="o">=</span> <span class="p">(</span><span class="n">lup</span><span class="o">-&gt;</span><span class="n">num_permutations</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">U</span> <span class="o">=</span> <span class="n">lup</span><span class="o">-&gt;</span><span class="n">U</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">product</span> <span class="o">=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">U</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">product</span> <span class="o">*=</span> <span class="n">U</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">k</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">product</span> <span class="o">*</span> <span class="n">sign</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="qr-decomposition">QR Decomposition<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#qr-decomposition" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<p>Any square matrix <code class="language-plaintext highlighter-rouge">A</code> can be decomposed as: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-120-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6561" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6562" class="mjx-mrow"><span id="MJXc-Node-6563" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-6564" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6565" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.464em;">Q</span></span><span id="MJXc-Node-6566" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6567" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>=</mo><mi>Q</mi><mo>∗</mo><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-120">A = Q * R</script> where <code class="language-plaintext highlighter-rouge">Q</code> is an orthogonal matrix, and <code class="language-plaintext highlighter-rouge">R</code> is an upper triangular matrix.</p>

<p>A matrix is orthogonal if its columns are orthogonal unit vectors, meaning: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-121-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6568" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6569" class="mjx-mrow"><span id="MJXc-Node-6570" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.464em;">Q</span></span><span id="MJXc-Node-6571" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6572" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-6573" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.464em;">Q</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6574" class="mjx-texatom" style=""><span id="MJXc-Node-6575" class="mjx-mrow"><span id="MJXc-Node-6576" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.12em;">T</span></span></span></span></span></span><span id="MJXc-Node-6577" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6578" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-6579" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.464em;">Q</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6580" class="mjx-texatom" style=""><span id="MJXc-Node-6581" class="mjx-mrow"><span id="MJXc-Node-6582" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.12em;">T</span></span></span></span></span></span><span id="MJXc-Node-6583" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6584" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.464em;">Q</span></span><span id="MJXc-Node-6585" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6586" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.064em;">I</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo>∗</mo><msup><mi>Q</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msup><mo>=</mo><msup><mi>Q</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msup><mo>∗</mo><mi>Q</mi><mo>=</mo><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-121">Q * Q^{T} = Q^{T} * Q = I</script>. Where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-122-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6587" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6588" class="mjx-mrow"><span id="MJXc-Node-6589" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6590" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.464em;">Q</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6591" class="mjx-texatom" style=""><span id="MJXc-Node-6592" class="mjx-mrow"><span id="MJXc-Node-6593" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.12em;">T</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Q</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-122">Q^{T}</script> is the transpose of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-123-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6594" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6595" class="mjx-mrow"><span id="MJXc-Node-6596" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.464em;">Q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-123">Q</script>. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-124-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6597" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6598" class="mjx-mrow"><span id="MJXc-Node-6599" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6600" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.464em;">Q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6601" class="mjx-texatom" style=""><span id="MJXc-Node-6602" class="mjx-mrow"><span id="MJXc-Node-6603" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em; padding-right: 0.12em;">T</span></span></span></span></span></span><span id="MJXc-Node-6604" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6605" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-6606" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.464em;">Q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6607" class="mjx-texatom" style=""><span id="MJXc-Node-6608" class="mjx-mrow"><span id="MJXc-Node-6609" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6610" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>Q</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msub><mo>=</mo><msub><mi>Q</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-124">Q_{T} = Q_{-1}</script> for an orthogonal matrix.</p>

<p>The process of computing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-125-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6611" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6612" class="mjx-mrow"><span id="MJXc-Node-6613" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-6614" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6615" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.464em;">Q</span></span><span id="MJXc-Node-6616" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6617" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">R</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>=</mo><mi>Q</mi><mo>∗</mo><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-125">A = Q * R</script> is called the Gram–Schmidt algorithm.</p>

<p>If LU(P) factorization works mainly by applying basic matrix operations on rows, the QR decomposition is more focused on columns.</p>

<p>So we consider:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-126-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;, where&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;are the column vectors of A&lt;/mtext&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;, where&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;are the column vectors of Q&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 24.855em; position: relative;"><span id="MJXc-Node-6618" class="mjx-math" aria-hidden="true" style="width: 100%;"><span id="MJXc-Node-6619" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -4.4em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-6620" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.506em; padding-bottom: 0.296em;">A</span></span><span id="MJXc-Node-6621" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6622" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-6623" class="mjx-mo" style="vertical-align: -1.055em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.35em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-6624" class="mjx-mtable" style="vertical-align: -1.724em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-6625" class="mjx-mtr" style="height: 1.274em;"><span id="MJXc-Node-6626" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.918em;"><span id="MJXc-Node-6627" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6628" class="mjx-texatom"><span id="MJXc-Node-6629" class="mjx-mrow"><span id="MJXc-Node-6630" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6631" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.918em;"><span id="MJXc-Node-6632" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6633" class="mjx-texatom"><span id="MJXc-Node-6634" class="mjx-mrow"><span id="MJXc-Node-6635" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6636" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.918em;"><span id="MJXc-Node-6637" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6638" class="mjx-texatom"><span id="MJXc-Node-6639" class="mjx-mrow"><span id="MJXc-Node-6640" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6641" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-6642" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-6643" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6644" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6645" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6646" class="mjx-texatom" style=""><span id="MJXc-Node-6647" class="mjx-mrow"><span id="MJXc-Node-6648" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6649" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-6650" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6651" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6652" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6653" class="mjx-texatom" style=""><span id="MJXc-Node-6654" class="mjx-mrow"><span id="MJXc-Node-6655" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6656" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-6657" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6658" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6659" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6660" class="mjx-texatom" style=""><span id="MJXc-Node-6661" class="mjx-mrow"><span id="MJXc-Node-6662" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6663" class="mjx-mtr" style="height: 1.274em;"><span id="MJXc-Node-6664" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-6665" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6666" class="mjx-texatom"><span id="MJXc-Node-6667" class="mjx-mrow"><span id="MJXc-Node-6668" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6669" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-6670" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6671" class="mjx-texatom"><span id="MJXc-Node-6672" class="mjx-mrow"><span id="MJXc-Node-6673" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6674" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-6675" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6676" class="mjx-texatom"><span id="MJXc-Node-6677" class="mjx-mrow"><span id="MJXc-Node-6678" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-6679" class="mjx-mo" style="vertical-align: -1.055em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.35em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-6680" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.422em; padding-bottom: 0.548em;">, where&nbsp;</span></span><span id="MJXc-Node-6681" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6682" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6683" class="mjx-texatom" style=""><span id="MJXc-Node-6684" class="mjx-mrow"><span id="MJXc-Node-6685" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span></span></span></span></span><span id="MJXc-Node-6686" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.422em; padding-bottom: 0.338em;">&nbsp;are the column vectors of A</span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-6687" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-6688" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.464em;">Q</span></span><span id="MJXc-Node-6689" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6690" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-6691" class="mjx-mo" style="vertical-align: -1.065em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.369em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-6692" class="mjx-mtable" style="vertical-align: -1.734em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-6693" class="mjx-mtr" style="height: 1.274em;"><span id="MJXc-Node-6694" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.835em;"><span id="MJXc-Node-6695" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6696" class="mjx-texatom"><span id="MJXc-Node-6697" class="mjx-mrow"><span id="MJXc-Node-6698" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6699" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.835em;"><span id="MJXc-Node-6700" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6701" class="mjx-texatom"><span id="MJXc-Node-6702" class="mjx-mrow"><span id="MJXc-Node-6703" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6704" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.835em;"><span id="MJXc-Node-6705" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6706" class="mjx-texatom"><span id="MJXc-Node-6707" class="mjx-mrow"><span id="MJXc-Node-6708" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6709" class="mjx-mtr" style="height: 1.419em;"><span id="MJXc-Node-6710" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-6711" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6712" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-6713" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6714" class="mjx-texatom" style=""><span id="MJXc-Node-6715" class="mjx-mrow"><span id="MJXc-Node-6716" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6717" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-6718" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6719" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-6720" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6721" class="mjx-texatom" style=""><span id="MJXc-Node-6722" class="mjx-mrow"><span id="MJXc-Node-6723" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6724" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-6725" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6726" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-6727" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6728" class="mjx-texatom" style=""><span id="MJXc-Node-6729" class="mjx-mrow"><span id="MJXc-Node-6730" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6731" class="mjx-mtr" style="height: 1.274em;"><span id="MJXc-Node-6732" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-6733" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6734" class="mjx-texatom"><span id="MJXc-Node-6735" class="mjx-mrow"><span id="MJXc-Node-6736" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6737" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-6738" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6739" class="mjx-texatom"><span id="MJXc-Node-6740" class="mjx-mrow"><span id="MJXc-Node-6741" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6742" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-6743" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6744" class="mjx-texatom"><span id="MJXc-Node-6745" class="mjx-mrow"><span id="MJXc-Node-6746" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-6747" class="mjx-mo" style="vertical-align: -1.065em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.369em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-6748" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.422em; padding-bottom: 0.548em;">, where&nbsp;</span></span><span id="MJXc-Node-6749" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-6750" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6751" class="mjx-texatom" style=""><span id="MJXc-Node-6752" class="mjx-mrow"><span id="MJXc-Node-6753" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span></span></span></span></span><span id="MJXc-Node-6754" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.422em; padding-bottom: 0.548em;">&nbsp;are the column vectors of Q</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>A</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mtext>, where&nbsp;</mtext><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mtext>&nbsp;are the column vectors of A</mtext><mspace linebreak="newline"></mspace><mi>Q</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd></mtr><mtr><mtd><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mtext>, where&nbsp;</mtext><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mtext>&nbsp;are the column vectors of Q</mtext></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-126">A = 
\begin{bmatrix}
| & | & | \\
a_{1} & a_{2} & a_{3} \\
| & | & |
\end{bmatrix}
\text{, where } a_{i} \text{ are the column vectors of A}
\\
Q = 
\begin{bmatrix}
| & | & | \\
q_{1} & q_{2} & q_{3} \\
| & | & |
\end{bmatrix}
\text{, where } q_{i} \text{ are the column vectors of Q}</script>

<p>Because all the vectors in matrix <code class="language-plaintext highlighter-rouge">Q</code> should have length <code class="language-plaintext highlighter-rouge">1</code>, we have to normalize the columns in <code class="language-plaintext highlighter-rouge">A</code>.</p>

<p>This gives the following formulas:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-127-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mtext&gt;&amp;#xA0;where,&amp;#xA0;&lt;/mtext&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mtext&gt;&amp;#xA0;where,&amp;#xA0;&lt;/mtext&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-6755" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6756" class="mjx-mrow"><span id="MJXc-Node-6757" class="mjx-mrow"><span id="MJXc-Node-6758" class="mjx-mo" style="vertical-align: -1.737em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.674em; padding-bottom: 0.296em;">⎧</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.213em; margin-bottom: 0.087em; margin-top: -0.137em;">⎪
⎪
⎪
⎪
⎪</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎨</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.213em; margin-bottom: 0.087em; margin-top: -0.137em;">⎪
⎪
⎪
⎪
⎪</span><span class="mjx-char MJXc-TeX-size4-R" style="margin-top: -0.208em; padding-bottom: 1.179em;">⎩</span></span></span><span id="MJXc-Node-6759" class="mjx-mtable" style="vertical-align: -2.661em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-6760" class="mjx-mtr" style="height: 1.568em;"><span id="MJXc-Node-6761" class="mjx-mtd" style="padding: 0px; text-align: left; width: 22.702em;"><span id="MJXc-Node-6762" class="mjx-mrow" style="margin-top: -0.163em;"><span id="MJXc-Node-6763" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-6764" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6765" class="mjx-texatom" style=""><span id="MJXc-Node-6766" class="mjx-mrow"><span id="MJXc-Node-6767" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-6768" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6769" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.498em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.118em; top: -1.183em;"><span id="MJXc-Node-6770" class="mjx-msubsup" style=""><span class="mjx-base"><span id="MJXc-Node-6771" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6772" class="mjx-texatom" style=""><span id="MJXc-Node-6773" class="mjx-mrow"><span id="MJXc-Node-6774" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.118em; bottom: -0.893em;"><span id="MJXc-Node-6775" class="mjx-mrow" style=""><span id="MJXc-Node-6776" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-6777" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6778" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6779" class="mjx-texatom" style=""><span id="MJXc-Node-6780" class="mjx-mrow"><span id="MJXc-Node-6781" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-6782" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 1.498em;"></span></span><span class="mjx-vsize" style="height: 1.468em; vertical-align: -0.631em;"></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6783" class="mjx-mtr" style="height: 2.166em;"><span id="MJXc-Node-6784" class="mjx-mtd" style="padding: 0.1em 0px 0px; text-align: left;"><span id="MJXc-Node-6785" class="mjx-mrow"><span id="MJXc-Node-6786" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-6787" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6788" class="mjx-texatom" style=""><span id="MJXc-Node-6789" class="mjx-mrow"><span id="MJXc-Node-6790" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-6791" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6792" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.637em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.314em; top: -1.744em;"><span id="MJXc-Node-6793" class="mjx-msubsup" style=""><span class="mjx-base"><span id="MJXc-Node-6794" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6798" class="mjx-texatom" style=""><span id="MJXc-Node-6799" class="mjx-mrow"><span id="MJXc-Node-6800" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6795" class="mjx-texatom" style=""><span id="MJXc-Node-6796" class="mjx-mrow"><span id="MJXc-Node-6797" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.314em; bottom: -1.037em;"><span id="MJXc-Node-6801" class="mjx-mrow" style=""><span id="MJXc-Node-6802" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-6803" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6804" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6808" class="mjx-texatom" style=""><span id="MJXc-Node-6809" class="mjx-mrow"><span id="MJXc-Node-6810" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6805" class="mjx-texatom" style=""><span id="MJXc-Node-6806" class="mjx-mrow"><span id="MJXc-Node-6807" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span></span><span id="MJXc-Node-6811" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 1.637em;"></span></span><span class="mjx-vsize" style="height: 1.966em; vertical-align: -0.733em;"></span></span><span id="MJXc-Node-6812" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.422em; padding-bottom: 0.548em;">&nbsp;where,&nbsp;</span></span><span id="MJXc-Node-6813" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6814" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6818" class="mjx-texatom" style=""><span id="MJXc-Node-6819" class="mjx-mrow"><span id="MJXc-Node-6820" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6815" class="mjx-texatom" style=""><span id="MJXc-Node-6816" class="mjx-mrow"><span id="MJXc-Node-6817" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span></span><span id="MJXc-Node-6821" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6822" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-6823" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6824" class="mjx-texatom" style=""><span id="MJXc-Node-6825" class="mjx-mrow"><span id="MJXc-Node-6826" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-6827" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6828" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟨</span></span><span id="MJXc-Node-6829" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6830" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6831" class="mjx-texatom" style=""><span id="MJXc-Node-6832" class="mjx-mrow"><span id="MJXc-Node-6833" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-6834" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-6835" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-6836" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6837" class="mjx-texatom" style=""><span id="MJXc-Node-6838" class="mjx-mrow"><span id="MJXc-Node-6839" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-6840" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟩</span></span><span id="MJXc-Node-6841" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6842" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-6843" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6844" class="mjx-texatom" style=""><span id="MJXc-Node-6845" class="mjx-mrow"><span id="MJXc-Node-6846" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6847" class="mjx-mtr" style="height: 2.087em;"><span id="MJXc-Node-6848" class="mjx-mtd" style="padding: 0.1em 0px 0px; text-align: left;"><span id="MJXc-Node-6849" class="mjx-mrow"><span id="MJXc-Node-6850" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-6851" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6852" class="mjx-texatom" style=""><span id="MJXc-Node-6853" class="mjx-mrow"><span id="MJXc-Node-6854" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-6855" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6856" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.637em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.314em; top: -1.759em;"><span id="MJXc-Node-6857" class="mjx-msubsup" style=""><span class="mjx-base"><span id="MJXc-Node-6858" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.314em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6862" class="mjx-texatom" style=""><span id="MJXc-Node-6863" class="mjx-mrow"><span id="MJXc-Node-6864" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6859" class="mjx-texatom" style=""><span id="MJXc-Node-6860" class="mjx-mrow"><span id="MJXc-Node-6861" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.314em; bottom: -1.052em;"><span id="MJXc-Node-6865" class="mjx-mrow" style=""><span id="MJXc-Node-6866" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-6867" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6868" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.314em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6872" class="mjx-texatom" style=""><span id="MJXc-Node-6873" class="mjx-mrow"><span id="MJXc-Node-6874" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6869" class="mjx-texatom" style=""><span id="MJXc-Node-6870" class="mjx-mrow"><span id="MJXc-Node-6871" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span></span><span id="MJXc-Node-6875" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 1.637em;"></span></span><span class="mjx-vsize" style="height: 1.987em; vertical-align: -0.744em;"></span></span><span id="MJXc-Node-6876" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.422em; padding-bottom: 0.548em;">&nbsp;where,&nbsp;</span></span><span id="MJXc-Node-6877" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6878" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.314em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6882" class="mjx-texatom" style=""><span id="MJXc-Node-6883" class="mjx-mrow"><span id="MJXc-Node-6884" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-6879" class="mjx-texatom" style=""><span id="MJXc-Node-6880" class="mjx-mrow"><span id="MJXc-Node-6881" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span></span><span id="MJXc-Node-6885" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6886" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-6887" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6888" class="mjx-texatom" style=""><span id="MJXc-Node-6889" class="mjx-mrow"><span id="MJXc-Node-6890" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-6891" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6892" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟨</span></span><span id="MJXc-Node-6893" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6894" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6895" class="mjx-texatom" style=""><span id="MJXc-Node-6896" class="mjx-mrow"><span id="MJXc-Node-6897" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-6898" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-6899" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-6900" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6901" class="mjx-texatom" style=""><span id="MJXc-Node-6902" class="mjx-mrow"><span id="MJXc-Node-6903" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-6904" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟩</span></span><span id="MJXc-Node-6905" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6906" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-6907" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6908" class="mjx-texatom" style=""><span id="MJXc-Node-6909" class="mjx-mrow"><span id="MJXc-Node-6910" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-6911" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">−</span></span><span id="MJXc-Node-6912" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟨</span></span><span id="MJXc-Node-6913" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6914" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6915" class="mjx-texatom" style=""><span id="MJXc-Node-6916" class="mjx-mrow"><span id="MJXc-Node-6917" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-6918" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-6919" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-6920" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6921" class="mjx-texatom" style=""><span id="MJXc-Node-6922" class="mjx-mrow"><span id="MJXc-Node-6923" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-6924" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟩</span></span><span id="MJXc-Node-6925" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-6926" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-6927" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6928" class="mjx-texatom" style=""><span id="MJXc-Node-6929" class="mjx-mrow"><span id="MJXc-Node-6930" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-6931" class="mjx-mo" style="width: 0.12em;"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>=</mo><mfrac><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mrow><mo fence="false" stretchy="false">‖</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo fence="false" stretchy="false">‖</mo></mrow></mfrac></mtd></mtr><mtr><mtd><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>=</mo><mfrac><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mrow><mo fence="false" stretchy="false">‖</mo><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mo fence="false" stretchy="false">‖</mo></mrow></mfrac><mtext>&nbsp;where,&nbsp;</mtext><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mo>=</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>−</mo><mo fence="false" stretchy="false">⟨</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo fence="false" stretchy="false">⟩</mo><mo>∗</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>=</mo><mfrac><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mrow><mo fence="false" stretchy="false">‖</mo><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mo fence="false" stretchy="false">‖</mo></mrow></mfrac><mtext>&nbsp;where,&nbsp;</mtext><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mo>=</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>−</mo><mo fence="false" stretchy="false">⟨</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>,</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo fence="false" stretchy="false">⟩</mo><mo>∗</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>−</mo><mo fence="false" stretchy="false">⟨</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>,</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo fence="false" stretchy="false">⟩</mo><mo>∗</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-127">\begin{cases}
q_{1} = \frac{a_{1}}{\lVert a_{1} \rVert} \\
q_{2} = \frac{a^{\bot}_{2}}{\lVert a^{\bot}_{2} \rVert} \text{ where, } a^{\bot}_{2} = a_{2} - \langle a_{2}, q_{1} \rangle * q_{1} \\
q_{3} = \frac{a^{\bot}_{3}}{\lVert a^{\bot}_{3} \rVert} \text{ where, } a^{\bot}_{3} = a_{3} - \langle a_{3}, q_{1} \rangle * q_{1} - \langle a_{3}, q_{2} \rangle * q_{2}
\end{cases}</script>

<p>Basically our QR decomposition looks like this:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-128-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-6932" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6933" class="mjx-mrow"><span id="MJXc-Node-6934" class="mjx-mrow"><span id="MJXc-Node-6935" class="mjx-mo" style="vertical-align: -1.055em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.35em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-6936" class="mjx-mtable" style="vertical-align: -1.724em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-6937" class="mjx-mtr" style="height: 1.274em;"><span id="MJXc-Node-6938" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.918em;"><span id="MJXc-Node-6939" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6940" class="mjx-texatom"><span id="MJXc-Node-6941" class="mjx-mrow"><span id="MJXc-Node-6942" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6943" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.918em;"><span id="MJXc-Node-6944" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6945" class="mjx-texatom"><span id="MJXc-Node-6946" class="mjx-mrow"><span id="MJXc-Node-6947" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6948" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.918em;"><span id="MJXc-Node-6949" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6950" class="mjx-texatom"><span id="MJXc-Node-6951" class="mjx-mrow"><span id="MJXc-Node-6952" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6953" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-6954" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-6955" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6956" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6957" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6958" class="mjx-texatom" style=""><span id="MJXc-Node-6959" class="mjx-mrow"><span id="MJXc-Node-6960" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6961" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-6962" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6963" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6964" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6965" class="mjx-texatom" style=""><span id="MJXc-Node-6966" class="mjx-mrow"><span id="MJXc-Node-6967" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6968" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-6969" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6970" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6971" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6972" class="mjx-texatom" style=""><span id="MJXc-Node-6973" class="mjx-mrow"><span id="MJXc-Node-6974" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-6975" class="mjx-mtr" style="height: 1.274em;"><span id="MJXc-Node-6976" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-6977" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6978" class="mjx-texatom"><span id="MJXc-Node-6979" class="mjx-mrow"><span id="MJXc-Node-6980" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6981" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-6982" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6983" class="mjx-texatom"><span id="MJXc-Node-6984" class="mjx-mrow"><span id="MJXc-Node-6985" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-6986" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-6987" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6988" class="mjx-texatom"><span id="MJXc-Node-6989" class="mjx-mrow"><span id="MJXc-Node-6990" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-6991" class="mjx-mo" style="vertical-align: -1.055em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.35em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-6992" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-6993" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-6994" class="mjx-mo" style="vertical-align: -1.549em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.446em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-6995" class="mjx-mtable" style="vertical-align: -2.218em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-6996" class="mjx-mtr" style="height: 1.274em;"><span id="MJXc-Node-6997" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.738em;"><span id="MJXc-Node-6998" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-6999" class="mjx-texatom"><span id="MJXc-Node-7000" class="mjx-mrow"><span id="MJXc-Node-7001" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7002" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.877em;"><span id="MJXc-Node-7003" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7004" class="mjx-texatom"><span id="MJXc-Node-7005" class="mjx-mrow"><span id="MJXc-Node-7006" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7007" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.877em;"><span id="MJXc-Node-7008" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7009" class="mjx-texatom"><span id="MJXc-Node-7010" class="mjx-mrow"><span id="MJXc-Node-7011" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-7012" class="mjx-mtr" style="height: 2.387em;"><span id="MJXc-Node-7013" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-7014" class="mjx-mrow" style="margin-top: 0.244em;"><span id="MJXc-Node-7015" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.498em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.118em; top: -1.183em;"><span id="MJXc-Node-7016" class="mjx-msubsup" style=""><span class="mjx-base"><span id="MJXc-Node-7017" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7018" class="mjx-texatom" style=""><span id="MJXc-Node-7019" class="mjx-mrow"><span id="MJXc-Node-7020" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.118em; bottom: -0.893em;"><span id="MJXc-Node-7021" class="mjx-mrow" style=""><span id="MJXc-Node-7022" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-7023" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7024" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7025" class="mjx-texatom" style=""><span id="MJXc-Node-7026" class="mjx-mrow"><span id="MJXc-Node-7027" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-7028" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 1.498em;"></span></span><span class="mjx-vsize" style="height: 1.468em; vertical-align: -0.631em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7029" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-7030" class="mjx-mrow" style="margin-top: 0.01em;"><span id="MJXc-Node-7031" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.637em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.314em; top: -1.744em;"><span id="MJXc-Node-7032" class="mjx-msubsup" style=""><span class="mjx-base"><span id="MJXc-Node-7033" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-7037" class="mjx-texatom" style=""><span id="MJXc-Node-7038" class="mjx-mrow"><span id="MJXc-Node-7039" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-7034" class="mjx-texatom" style=""><span id="MJXc-Node-7035" class="mjx-mrow"><span id="MJXc-Node-7036" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.314em; bottom: -1.037em;"><span id="MJXc-Node-7040" class="mjx-mrow" style=""><span id="MJXc-Node-7041" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-7042" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7043" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-7047" class="mjx-texatom" style=""><span id="MJXc-Node-7048" class="mjx-mrow"><span id="MJXc-Node-7049" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-7044" class="mjx-texatom" style=""><span id="MJXc-Node-7045" class="mjx-mrow"><span id="MJXc-Node-7046" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span></span><span id="MJXc-Node-7050" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 1.637em;"></span></span><span class="mjx-vsize" style="height: 1.966em; vertical-align: -0.733em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7051" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-7052" class="mjx-mrow"><span id="MJXc-Node-7053" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.637em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.314em; top: -1.759em;"><span id="MJXc-Node-7054" class="mjx-msubsup" style=""><span class="mjx-base"><span id="MJXc-Node-7055" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.314em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-7059" class="mjx-texatom" style=""><span id="MJXc-Node-7060" class="mjx-mrow"><span id="MJXc-Node-7061" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-7056" class="mjx-texatom" style=""><span id="MJXc-Node-7057" class="mjx-mrow"><span id="MJXc-Node-7058" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.314em; bottom: -1.052em;"><span id="MJXc-Node-7062" class="mjx-mrow" style=""><span id="MJXc-Node-7063" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-7064" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7065" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.314em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-7069" class="mjx-texatom" style=""><span id="MJXc-Node-7070" class="mjx-mrow"><span id="MJXc-Node-7071" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-7066" class="mjx-texatom" style=""><span id="MJXc-Node-7067" class="mjx-mrow"><span id="MJXc-Node-7068" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span></span><span id="MJXc-Node-7072" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 1.637em;"></span></span><span class="mjx-vsize" style="height: 1.987em; vertical-align: -0.744em;"></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-7073" class="mjx-mtr" style="height: 1.274em;"><span id="MJXc-Node-7074" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-7075" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7076" class="mjx-texatom"><span id="MJXc-Node-7077" class="mjx-mrow"><span id="MJXc-Node-7078" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7079" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-7080" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7081" class="mjx-texatom"><span id="MJXc-Node-7082" class="mjx-mrow"><span id="MJXc-Node-7083" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7084" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-7085" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7086" class="mjx-texatom"><span id="MJXc-Node-7087" class="mjx-mrow"><span id="MJXc-Node-7088" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-7089" class="mjx-mo" style="vertical-align: -1.549em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.446em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-7090" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-7091" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-7092" class="mjx-mo" style="vertical-align: -1.22em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.34em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-7093" class="mjx-mtable" style="vertical-align: -1.889em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-7094" class="mjx-mtr" style="height: 1.275em;"><span id="MJXc-Node-7095" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.918em;"><span id="MJXc-Node-7096" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7097" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-7098" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7099" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7100" class="mjx-texatom" style=""><span id="MJXc-Node-7101" class="mjx-mrow"><span id="MJXc-Node-7102" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-7103" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7104" class="mjx-mtd" style="padding: 0px 0.5em; width: 2.975em;"><span id="MJXc-Node-7105" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7106" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟨</span></span><span id="MJXc-Node-7107" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7108" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7109" class="mjx-texatom" style=""><span id="MJXc-Node-7110" class="mjx-mrow"><span id="MJXc-Node-7111" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-7112" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7113" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-7114" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7115" class="mjx-texatom" style=""><span id="MJXc-Node-7116" class="mjx-mrow"><span id="MJXc-Node-7117" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-7118" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟩</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7119" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 2.975em;"><span id="MJXc-Node-7120" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7121" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟨</span></span><span id="MJXc-Node-7122" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7123" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7124" class="mjx-texatom" style=""><span id="MJXc-Node-7125" class="mjx-mrow"><span id="MJXc-Node-7126" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-7127" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7128" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-7129" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7130" class="mjx-texatom" style=""><span id="MJXc-Node-7131" class="mjx-mrow"><span id="MJXc-Node-7132" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-7133" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟩</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-7134" class="mjx-mtr" style="height: 1.594em;"><span id="MJXc-Node-7135" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-7136" class="mjx-mrow" style="margin-top: -0.139em;"><span id="MJXc-Node-7137" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7138" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-7139" class="mjx-mrow" style="margin-top: -0.139em;"><span id="MJXc-Node-7140" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-7141" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7142" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-7146" class="mjx-texatom" style=""><span id="MJXc-Node-7147" class="mjx-mrow"><span id="MJXc-Node-7148" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-7143" class="mjx-texatom" style=""><span id="MJXc-Node-7144" class="mjx-mrow"><span id="MJXc-Node-7145" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span></span><span id="MJXc-Node-7149" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7150" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-7151" class="mjx-mrow" style="margin-top: -0.139em;"><span id="MJXc-Node-7152" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟨</span></span><span id="MJXc-Node-7153" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7154" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7155" class="mjx-texatom" style=""><span id="MJXc-Node-7156" class="mjx-mrow"><span id="MJXc-Node-7157" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-7158" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7159" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-7160" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7161" class="mjx-texatom" style=""><span id="MJXc-Node-7162" class="mjx-mrow"><span id="MJXc-Node-7163" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-7164" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟩</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-7165" class="mjx-mtr" style="height: 1.409em;"><span id="MJXc-Node-7166" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-7167" class="mjx-mrow" style="margin-top: -0.139em;"><span id="MJXc-Node-7168" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7169" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-7170" class="mjx-mrow" style="margin-top: -0.139em;"><span id="MJXc-Node-7171" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7172" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-7173" class="mjx-mrow" style="margin-top: -0.139em;"><span id="MJXc-Node-7174" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-7175" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7176" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.314em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-7180" class="mjx-texatom" style=""><span id="MJXc-Node-7181" class="mjx-mrow"><span id="MJXc-Node-7182" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-7177" class="mjx-texatom" style=""><span id="MJXc-Node-7178" class="mjx-mrow"><span id="MJXc-Node-7179" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span></span><span id="MJXc-Node-7183" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-7184" class="mjx-mo" style="vertical-align: -1.22em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.34em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd></mtr><mtr><mtd><mfrac><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mrow><mo fence="false" stretchy="false">‖</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo fence="false" stretchy="false">‖</mo></mrow></mfrac></mtd><mtd><mfrac><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mrow><mo fence="false" stretchy="false">‖</mo><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mo fence="false" stretchy="false">‖</mo></mrow></mfrac></mtd><mtd><mfrac><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mrow><mo fence="false" stretchy="false">‖</mo><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mo fence="false" stretchy="false">‖</mo></mrow></mfrac></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>∗</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo fence="false" stretchy="false">‖</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo fence="false" stretchy="false">‖</mo></mtd><mtd><mo fence="false" stretchy="false">⟨</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo fence="false" stretchy="false">⟩</mo></mtd><mtd><mo fence="false" stretchy="false">⟨</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>,</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo fence="false" stretchy="false">⟩</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mo fence="false" stretchy="false">‖</mo><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mo fence="false" stretchy="false">‖</mo></mtd><mtd><mo fence="false" stretchy="false">⟨</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>,</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo fence="false" stretchy="false">⟩</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo fence="false" stretchy="false">‖</mo><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mo fence="false" stretchy="false">‖</mo></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-128">\begin{bmatrix}
| & | & | \\
a_{1} & a_{2} & a_{3} \\
| & | & |
\end{bmatrix}
=
\begin{bmatrix}
| & | & | \\
\frac{a_{1}}{\lVert a_{1} \rVert} & \frac{a^{\bot}_{2}}{\lVert a^{\bot}_{2} \rVert} & \frac{a^{\bot}_{3}}{\lVert a^{\bot}_{3} \rVert} \\
| & | & |
\end{bmatrix}
*
\begin{bmatrix}
\lVert a_{1} \rVert &  \langle a_{2}, q_{1} \rangle & \langle a_{3}, q_{1} \rangle \\
0 & \lVert a^{\bot}_{2} \rVert &  \langle a_{3}, q_{2} \rangle \\
0 & 0 & \lVert a^{\bot}_{3} \rVert
\end{bmatrix}</script>

<p>The formulas can be generalized for every <code class="language-plaintext highlighter-rouge">nxn</code> matrix.</p>

<p>In case you are wondering what represents the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-129-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-7185" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7186" class="mjx-mrow"><span id="MJXc-Node-7187" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟨</span></span><span id="MJXc-Node-7188" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7189" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7190" class="mjx-texatom" style=""><span id="MJXc-Node-7191" class="mjx-mrow"><span id="MJXc-Node-7192" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span></span></span></span></span><span id="MJXc-Node-7193" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7194" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-7195" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7196" class="mjx-texatom" style=""><span id="MJXc-Node-7197" class="mjx-mrow"><span id="MJXc-Node-7198" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.464em;">j</span></span></span></span></span></span><span id="MJXc-Node-7199" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟩</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">⟨</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>,</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub><mo fence="false" stretchy="false">⟩</mo></math></span></span><script type="math/tex" id="MathJax-Element-129">\langle a_{i}, q_{j} \rangle</script> notation. This is called the dot product of two vectors, and it’s calculated like this:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-130-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 21.214em; position: relative;"><span id="MJXc-Node-7200" class="mjx-math" aria-hidden="true" style="width: 100%;"><span id="MJXc-Node-7201" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -3.184em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-7202" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span><span id="MJXc-Node-7203" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-7204" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">[</span></span><span id="MJXc-Node-7205" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7206" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7207" class="mjx-texatom" style=""><span id="MJXc-Node-7208" class="mjx-mrow"><span id="MJXc-Node-7209" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-7210" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7211" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-7212" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7213" class="mjx-texatom" style=""><span id="MJXc-Node-7214" class="mjx-mrow"><span id="MJXc-Node-7215" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-7216" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7217" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-7218" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7219" class="mjx-texatom" style=""><span id="MJXc-Node-7220" class="mjx-mrow"><span id="MJXc-Node-7221" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-7222" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7223" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-7224" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-7225" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-7226" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7227" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-7228" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7229" class="mjx-texatom" style=""><span id="MJXc-Node-7230" class="mjx-mrow"><span id="MJXc-Node-7231" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span id="MJXc-Node-7232" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">]</span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-7233" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-7234" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span><span id="MJXc-Node-7235" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-7236" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">[</span></span><span id="MJXc-Node-7237" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7238" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7239" class="mjx-texatom" style=""><span id="MJXc-Node-7240" class="mjx-mrow"><span id="MJXc-Node-7241" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-7242" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7243" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-7244" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7245" class="mjx-texatom" style=""><span id="MJXc-Node-7246" class="mjx-mrow"><span id="MJXc-Node-7247" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-7248" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7249" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-7250" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7251" class="mjx-texatom" style=""><span id="MJXc-Node-7252" class="mjx-mrow"><span id="MJXc-Node-7253" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-7254" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7255" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-7256" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-7257" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-7258" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7259" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-7260" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7261" class="mjx-texatom" style=""><span id="MJXc-Node-7262" class="mjx-mrow"><span id="MJXc-Node-7263" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span id="MJXc-Node-7264" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">]</span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-7265" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-7266" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟨</span></span><span id="MJXc-Node-7267" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span><span id="MJXc-Node-7268" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7269" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span><span id="MJXc-Node-7270" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟩</span></span><span id="MJXc-Node-7271" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-7272" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-7273" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7274" class="mjx-texatom" style=""><span id="MJXc-Node-7275" class="mjx-mrow"><span id="MJXc-Node-7276" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-7277" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-7278" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-7279" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7280" class="mjx-texatom" style=""><span id="MJXc-Node-7281" class="mjx-mrow"><span id="MJXc-Node-7282" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-7283" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-7284" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-7285" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7286" class="mjx-texatom" style=""><span id="MJXc-Node-7287" class="mjx-mrow"><span id="MJXc-Node-7288" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-7289" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-7290" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-7291" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7292" class="mjx-texatom" style=""><span id="MJXc-Node-7293" class="mjx-mrow"><span id="MJXc-Node-7294" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-7295" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-7296" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-7297" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-7298" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-7299" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-7300" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7301" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7302" class="mjx-texatom" style=""><span id="MJXc-Node-7303" class="mjx-mrow"><span id="MJXc-Node-7304" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span id="MJXc-Node-7305" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-7306" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-7307" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7308" class="mjx-texatom" style=""><span id="MJXc-Node-7309" class="mjx-mrow"><span id="MJXc-Node-7310" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span><span id="MJXc-Node-7311" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-7312" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.716em; padding-bottom: 0.716em;">∑</span></span><span id="MJXc-Node-7313" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-7314" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7315" class="mjx-texatom" style=""><span id="MJXc-Node-7316" class="mjx-mrow"><span id="MJXc-Node-7317" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span></span></span></span></span><span id="MJXc-Node-7318" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-7319" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-7320" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7321" class="mjx-texatom" style=""><span id="MJXc-Node-7322" class="mjx-mrow"><span id="MJXc-Node-7323" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>a</mi><mo>=</mo><mo stretchy="false">[</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub><mo stretchy="false">]</mo><mspace linebreak="newline"></mspace><mi>b</mi><mo>=</mo><mo stretchy="false">[</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub><mo stretchy="false">]</mo><mspace linebreak="newline"></mspace><mo fence="false" stretchy="false">⟨</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo fence="false" stretchy="false">⟩</mo><mo>=</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>∗</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>∗</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>+</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>+</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub><mo>∗</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub><mo>=</mo><mo>∑</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>∗</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-130">a = [a_{1}, a_{2}, a_{3}, ..., a_{n}] \\
b = [b_{1}, b_{2}, b_{3}, ..., b_{n}] \\
\langle a, b \rangle = a_{1} * b_{1} + a_{2} * b_{2} + ... + a_{n} * b_{n} = \sum a_{i} * b_{i}</script>

<p>From a code perspective this can be implemented as:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Useful for QR decomposition</span>
<span class="c1">// Represents the (dot) product of two vectors:</span>
<span class="c1">// vector1 = m1col column from m1</span>
<span class="c1">// vector2 = m2col column from m2</span>
<span class="kt">double</span> <span class="nf">nml_vect_dot</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">m1col</span><span class="p">,</span> <span class="n">nml_mat</span> <span class="o">*</span><span class="n">m2</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">m2col</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">m1</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="o">!=</span><span class="n">m2</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_VECT_DOT_DIMENSIONS</span><span class="p">,</span> <span class="n">m1</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">m2</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">m1col</span> <span class="o">&gt;=</span> <span class="n">m1</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_GET_COLUMN</span><span class="p">,</span> <span class="n">m1col</span><span class="p">,</span> <span class="n">m1</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">m2col</span> <span class="o">&gt;=</span> <span class="n">m2</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_GET_COLUMN</span><span class="p">,</span> <span class="n">m2col</span><span class="p">,</span> <span class="n">m2</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">dot</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m1</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">dot</span> <span class="o">+=</span> <span class="n">m1</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">m1col</span><span class="p">]</span> <span class="o">*</span> <span class="n">m2</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">m2col</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">dot</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<p>In case you are wondering what represents the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-131-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-7324" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7325" class="mjx-mrow"><span id="MJXc-Node-7326" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-7327" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7328" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7329" class="mjx-texatom" style=""><span id="MJXc-Node-7330" class="mjx-mrow"><span id="MJXc-Node-7331" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.422em; padding-bottom: 0.296em;">i</span></span></span></span></span></span><span id="MJXc-Node-7332" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">‖</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo fence="false" stretchy="false">‖</mo></math></span></span><script type="math/tex" id="MathJax-Element-131">\lVert a_{i} \rVert</script> this is called the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-132-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-7333" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7334" class="mjx-mrow"><span id="MJXc-Node-7335" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7336" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.464em; padding-bottom: 0.296em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7337" class="mjx-texatom" style=""><span id="MJXc-Node-7338" class="mjx-mrow"><span id="MJXc-Node-7339" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-132">L_{2}</script> Euclidean norm and it’s computed by the formula:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-133-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-7340" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7341" class="mjx-mrow"><span id="MJXc-Node-7342" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-7343" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span><span id="MJXc-Node-7344" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-7345" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-7346" class="mjx-msqrt MJXc-space3"><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">√</span></span><span class="mjx-box" style="padding-top: 0.243em; border-top: 1.8px solid;"><span id="MJXc-Node-7347" class="mjx-mrow"><span id="MJXc-Node-7348" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7349" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-7353" class="mjx-texatom" style=""><span id="MJXc-Node-7354" class="mjx-mrow"><span id="MJXc-Node-7355" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-7350" class="mjx-texatom" style=""><span id="MJXc-Node-7351" class="mjx-mrow"><span id="MJXc-Node-7352" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-7356" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-7357" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-7358" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-7362" class="mjx-texatom" style=""><span id="MJXc-Node-7363" class="mjx-mrow"><span id="MJXc-Node-7364" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-7359" class="mjx-texatom" style=""><span id="MJXc-Node-7360" class="mjx-mrow"><span id="MJXc-Node-7361" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span></span><span id="MJXc-Node-7365" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-7366" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-7367" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-7368" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.338em;">.</span></span><span id="MJXc-Node-7369" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.296em; padding-bottom: 0.422em;">+</span></span><span id="MJXc-Node-7370" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7371" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.157em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-7375" class="mjx-texatom" style=""><span id="MJXc-Node-7376" class="mjx-mrow"><span id="MJXc-Node-7377" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-7372" class="mjx-texatom" style=""><span id="MJXc-Node-7373" class="mjx-mrow"><span id="MJXc-Node-7374" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">n</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo fence="false" stretchy="false">‖</mo><mi>a</mi><mo fence="false" stretchy="false">‖</mo><mo>=</mo><msqrt><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup><mo>+</mo><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup><mo>+</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>+</mo><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup></msqrt></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-133">\lVert a \rVert = \sqrt{a^{2}_{1} + a^{2}_{2} + ... + a^{2}_{n}}</script>

<p>From a code perspective this can be implemented as:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Calculates the l2 norm for a colum in the matrix</span>
<span class="kt">double</span> <span class="nf">nml_mat_col_l2norm</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">col</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">col</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">CANNOT_COLUMN_L2NORM</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="kt">double</span> <span class="n">doublesum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">doublesum</span> <span class="o">+=</span> <span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">]);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">doublesum</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Calculates the l2norm for each column</span>
<span class="c1">// Keeps results into 1 row matrix</span>
<span class="n">nml_mat</span> <span class="o">*</span><span class="nf">nml_mat_l2norm</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">);</span>
  <span class="kt">double</span> <span class="n">square_sum</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">square_sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">square_sum</span><span class="o">+=</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">r</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">square_sum</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<p>The code for the process of normalization is:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nt</span> <span class="nf">nml_mat_normalize_r</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">l2norms</span> <span class="o">=</span> <span class="n">nml_mat_l2norm</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">l2norms</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">NML_MIN_COEF</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">NML_FERROR</span><span class="p">(</span><span class="n">VECTOR_J_DEGENERATE</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
      <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">l2norms</span><span class="p">);</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">nml_mat_col_mult_r</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">l2norms</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
  <span class="p">}</span>
  <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">l2norms</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">nml_mat_qr</span> <span class="o">*</span><span class="nf">nml_mat_qr_new</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">nml_mat_qr</span> <span class="o">*</span><span class="n">qr</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">qr</span><span class="p">));</span>
  <span class="n">NP_CHECK</span><span class="p">(</span><span class="n">qr</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">qr</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>And the code for the QR algorithm described by this relantionship:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-134-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-7378" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7379" class="mjx-mrow"><span id="MJXc-Node-7380" class="mjx-mrow"><span id="MJXc-Node-7381" class="mjx-mo" style="vertical-align: -1.055em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.35em; margin-bottom: -0.101em; margin-top: 0px;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-7382" class="mjx-mtable" style="vertical-align: -1.724em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-7383" class="mjx-mtr" style="height: 1.274em;"><span id="MJXc-Node-7384" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 0.918em;"><span id="MJXc-Node-7385" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7386" class="mjx-texatom"><span id="MJXc-Node-7387" class="mjx-mrow"><span id="MJXc-Node-7388" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7389" class="mjx-mtd" style="padding: 0px 0.5em; width: 0.918em;"><span id="MJXc-Node-7390" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7391" class="mjx-texatom"><span id="MJXc-Node-7392" class="mjx-mrow"><span id="MJXc-Node-7393" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7394" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 0.918em;"><span id="MJXc-Node-7395" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7396" class="mjx-texatom"><span id="MJXc-Node-7397" class="mjx-mrow"><span id="MJXc-Node-7398" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-7399" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-7400" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-7401" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7402" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7403" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7404" class="mjx-texatom" style=""><span id="MJXc-Node-7405" class="mjx-mrow"><span id="MJXc-Node-7406" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7407" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-7408" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7409" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7410" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7411" class="mjx-texatom" style=""><span id="MJXc-Node-7412" class="mjx-mrow"><span id="MJXc-Node-7413" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7414" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-7415" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7416" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7417" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7418" class="mjx-texatom" style=""><span id="MJXc-Node-7419" class="mjx-mrow"><span id="MJXc-Node-7420" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-7421" class="mjx-mtr" style="height: 1.274em;"><span id="MJXc-Node-7422" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-7423" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7424" class="mjx-texatom"><span id="MJXc-Node-7425" class="mjx-mrow"><span id="MJXc-Node-7426" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7427" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-7428" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7429" class="mjx-texatom"><span id="MJXc-Node-7430" class="mjx-mrow"><span id="MJXc-Node-7431" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7432" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-7433" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7434" class="mjx-texatom"><span id="MJXc-Node-7435" class="mjx-mrow"><span id="MJXc-Node-7436" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-7437" class="mjx-mo" style="vertical-align: -1.055em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.35em; margin-bottom: -0.101em; margin-top: 0px;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-7438" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.086em; padding-bottom: 0.296em;">=</span></span><span id="MJXc-Node-7439" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-7440" class="mjx-mo" style="vertical-align: -1.549em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.446em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-7441" class="mjx-mtable" style="vertical-align: -2.218em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-7442" class="mjx-mtr" style="height: 1.274em;"><span id="MJXc-Node-7443" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.738em;"><span id="MJXc-Node-7444" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7445" class="mjx-texatom"><span id="MJXc-Node-7446" class="mjx-mrow"><span id="MJXc-Node-7447" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7448" class="mjx-mtd" style="padding: 0px 0.5em; width: 1.877em;"><span id="MJXc-Node-7449" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7450" class="mjx-texatom"><span id="MJXc-Node-7451" class="mjx-mrow"><span id="MJXc-Node-7452" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7453" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 1.877em;"><span id="MJXc-Node-7454" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7455" class="mjx-texatom"><span id="MJXc-Node-7456" class="mjx-mrow"><span id="MJXc-Node-7457" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-7458" class="mjx-mtr" style="height: 2.387em;"><span id="MJXc-Node-7459" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-7460" class="mjx-mrow" style="margin-top: 0.244em;"><span id="MJXc-Node-7461" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.498em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.118em; top: -1.183em;"><span id="MJXc-Node-7462" class="mjx-msubsup" style=""><span class="mjx-base"><span id="MJXc-Node-7463" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7464" class="mjx-texatom" style=""><span id="MJXc-Node-7465" class="mjx-mrow"><span id="MJXc-Node-7466" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.118em; bottom: -0.893em;"><span id="MJXc-Node-7467" class="mjx-mrow" style=""><span id="MJXc-Node-7468" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-7469" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7470" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7471" class="mjx-texatom" style=""><span id="MJXc-Node-7472" class="mjx-mrow"><span id="MJXc-Node-7473" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-7474" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 1.498em;"></span></span><span class="mjx-vsize" style="height: 1.468em; vertical-align: -0.631em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7475" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-7476" class="mjx-mrow" style="margin-top: 0.01em;"><span id="MJXc-Node-7477" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.637em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.314em; top: -1.744em;"><span id="MJXc-Node-7478" class="mjx-msubsup" style=""><span class="mjx-base"><span id="MJXc-Node-7479" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-7483" class="mjx-texatom" style=""><span id="MJXc-Node-7484" class="mjx-mrow"><span id="MJXc-Node-7485" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-7480" class="mjx-texatom" style=""><span id="MJXc-Node-7481" class="mjx-mrow"><span id="MJXc-Node-7482" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.314em; bottom: -1.037em;"><span id="MJXc-Node-7486" class="mjx-mrow" style=""><span id="MJXc-Node-7487" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-7488" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7489" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-7493" class="mjx-texatom" style=""><span id="MJXc-Node-7494" class="mjx-mrow"><span id="MJXc-Node-7495" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-7490" class="mjx-texatom" style=""><span id="MJXc-Node-7491" class="mjx-mrow"><span id="MJXc-Node-7492" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span></span><span id="MJXc-Node-7496" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 1.637em;"></span></span><span class="mjx-vsize" style="height: 1.966em; vertical-align: -0.733em;"></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7497" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-7498" class="mjx-mrow"><span id="MJXc-Node-7499" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.637em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.314em; top: -1.759em;"><span id="MJXc-Node-7500" class="mjx-msubsup" style=""><span class="mjx-base"><span id="MJXc-Node-7501" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.314em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-7505" class="mjx-texatom" style=""><span id="MJXc-Node-7506" class="mjx-mrow"><span id="MJXc-Node-7507" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-7502" class="mjx-texatom" style=""><span id="MJXc-Node-7503" class="mjx-mrow"><span id="MJXc-Node-7504" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.314em; bottom: -1.052em;"><span id="MJXc-Node-7508" class="mjx-mrow" style=""><span id="MJXc-Node-7509" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-7510" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7511" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.314em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-7515" class="mjx-texatom" style=""><span id="MJXc-Node-7516" class="mjx-mrow"><span id="MJXc-Node-7517" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-7512" class="mjx-texatom" style=""><span id="MJXc-Node-7513" class="mjx-mrow"><span id="MJXc-Node-7514" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span></span><span id="MJXc-Node-7518" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 1.637em;"></span></span><span class="mjx-vsize" style="height: 1.987em; vertical-align: -0.744em;"></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-7519" class="mjx-mtr" style="height: 1.274em;"><span id="MJXc-Node-7520" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-7521" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7522" class="mjx-texatom"><span id="MJXc-Node-7523" class="mjx-mrow"><span id="MJXc-Node-7524" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7525" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-7526" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7527" class="mjx-texatom"><span id="MJXc-Node-7528" class="mjx-mrow"><span id="MJXc-Node-7529" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7530" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-7531" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7532" class="mjx-texatom"><span id="MJXc-Node-7533" class="mjx-mrow"><span id="MJXc-Node-7534" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">|</span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-7535" class="mjx-mo" style="vertical-align: -1.549em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.446em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span><span id="MJXc-Node-7536" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.17em; padding-bottom: 0.296em;">∗</span></span><span id="MJXc-Node-7537" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-7538" class="mjx-mo" style="vertical-align: -1.22em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.34em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎣</span></span></span><span id="MJXc-Node-7539" class="mjx-mtable" style="vertical-align: -1.889em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-7540" class="mjx-mtr" style="height: 1.275em;"><span id="MJXc-Node-7541" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; width: 1.918em;"><span id="MJXc-Node-7542" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7543" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-7544" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7545" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7546" class="mjx-texatom" style=""><span id="MJXc-Node-7547" class="mjx-mrow"><span id="MJXc-Node-7548" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-7549" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7550" class="mjx-mtd" style="padding: 0px 0.5em; width: 2.975em;"><span id="MJXc-Node-7551" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7552" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟨</span></span><span id="MJXc-Node-7553" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7554" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7555" class="mjx-texatom" style=""><span id="MJXc-Node-7556" class="mjx-mrow"><span id="MJXc-Node-7557" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-7558" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7559" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-7560" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7561" class="mjx-texatom" style=""><span id="MJXc-Node-7562" class="mjx-mrow"><span id="MJXc-Node-7563" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-7564" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟩</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7565" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; width: 2.975em;"><span id="MJXc-Node-7566" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-7567" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟨</span></span><span id="MJXc-Node-7568" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7569" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7570" class="mjx-texatom" style=""><span id="MJXc-Node-7571" class="mjx-mrow"><span id="MJXc-Node-7572" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-7573" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7574" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-7575" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7576" class="mjx-texatom" style=""><span id="MJXc-Node-7577" class="mjx-mrow"><span id="MJXc-Node-7578" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">1</span></span></span></span></span></span><span id="MJXc-Node-7579" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟩</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-7580" class="mjx-mtr" style="height: 1.594em;"><span id="MJXc-Node-7581" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-7582" class="mjx-mrow" style="margin-top: -0.139em;"><span id="MJXc-Node-7583" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7584" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-7585" class="mjx-mrow" style="margin-top: -0.139em;"><span id="MJXc-Node-7586" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-7587" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7588" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-7592" class="mjx-texatom" style=""><span id="MJXc-Node-7593" class="mjx-mrow"><span id="MJXc-Node-7594" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-7589" class="mjx-texatom" style=""><span id="MJXc-Node-7590" class="mjx-mrow"><span id="MJXc-Node-7591" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span></span><span id="MJXc-Node-7595" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7596" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-7597" class="mjx-mrow" style="margin-top: -0.139em;"><span id="MJXc-Node-7598" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟨</span></span><span id="MJXc-Node-7599" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7600" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7601" class="mjx-texatom" style=""><span id="MJXc-Node-7602" class="mjx-mrow"><span id="MJXc-Node-7603" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span><span id="MJXc-Node-7604" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.166em; padding-bottom: 0.548em;">,</span></span><span id="MJXc-Node-7605" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-7606" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.464em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7607" class="mjx-texatom" style=""><span id="MJXc-Node-7608" class="mjx-mrow"><span id="MJXc-Node-7609" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">2</span></span></span></span></span></span><span id="MJXc-Node-7610" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">⟩</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-7611" class="mjx-mtr" style="height: 1.409em;"><span id="MJXc-Node-7612" class="mjx-mtd" style="padding: 0.2em 0.5em 0px 0px;"><span id="MJXc-Node-7613" class="mjx-mrow" style="margin-top: -0.139em;"><span id="MJXc-Node-7614" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7615" class="mjx-mtd" style="padding: 0.2em 0.5em 0px;"><span id="MJXc-Node-7616" class="mjx-mrow" style="margin-top: -0.139em;"><span id="MJXc-Node-7617" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-7618" class="mjx-mtd" style="padding: 0.2em 0px 0px 0.5em;"><span id="MJXc-Node-7619" class="mjx-mrow" style="margin-top: -0.139em;"><span id="MJXc-Node-7620" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span id="MJXc-Node-7621" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7622" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.212em; padding-bottom: 0.296em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.314em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-7626" class="mjx-texatom" style=""><span id="MJXc-Node-7627" class="mjx-mrow"><span id="MJXc-Node-7628" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.338em;">⊥</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-7623" class="mjx-texatom" style=""><span id="MJXc-Node-7624" class="mjx-mrow"><span id="MJXc-Node-7625" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.38em; padding-bottom: 0.38em;">3</span></span></span></span></span></span></span><span id="MJXc-Node-7629" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.464em; padding-bottom: 0.59em;">∥</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-7630" class="mjx-mo" style="vertical-align: -1.22em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.34em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.926em; padding-bottom: 0.926em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd></mtr><mtr><mtd><mfrac><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mrow><mo fence="false" stretchy="false">‖</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo fence="false" stretchy="false">‖</mo></mrow></mfrac></mtd><mtd><mfrac><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mrow><mo fence="false" stretchy="false">‖</mo><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mo fence="false" stretchy="false">‖</mo></mrow></mfrac></mtd><mtd><mfrac><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mrow><mo fence="false" stretchy="false">‖</mo><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mo fence="false" stretchy="false">‖</mo></mrow></mfrac></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>∗</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo fence="false" stretchy="false">‖</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo fence="false" stretchy="false">‖</mo></mtd><mtd><mo fence="false" stretchy="false">⟨</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo fence="false" stretchy="false">⟩</mo></mtd><mtd><mo fence="false" stretchy="false">⟨</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>,</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo fence="false" stretchy="false">⟩</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mo fence="false" stretchy="false">‖</mo><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mo fence="false" stretchy="false">‖</mo></mtd><mtd><mo fence="false" stretchy="false">⟨</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>,</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo fence="false" stretchy="false">⟩</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo fence="false" stretchy="false">‖</mo><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">⊥</mi></mrow></msubsup><mo fence="false" stretchy="false">‖</mo></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-134">\begin{bmatrix}
| & | & | \\
a_{1} & a_{2} & a_{3} \\
| & | & |
\end{bmatrix}
=
\begin{bmatrix}
| & | & | \\
\frac{a_{1}}{\lVert a_{1} \rVert} & \frac{a^{\bot}_{2}}{\lVert a^{\bot}_{2} \rVert} & \frac{a^{\bot}_{3}}{\lVert a^{\bot}_{3} \rVert} \\
| & | & |
\end{bmatrix}
*
\begin{bmatrix}
\lVert a_{1} \rVert &  \langle a_{2}, q_{1} \rangle & \langle a_{3}, q_{1} \rangle \\
0 & \lVert a^{\bot}_{2} \rVert &  \langle a_{3}, q_{2} \rangle \\
0 & 0 & \lVert a^{\bot}_{3} \rVert
\end{bmatrix}</script>

<p>is:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nml_mat_qr</span> <span class="o">*</span><span class="nf">nml_mat_qr_solve</span><span class="p">(</span><span class="n">nml_mat</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>

  <span class="n">nml_mat_qr</span> <span class="o">*</span><span class="n">qr</span> <span class="o">=</span> <span class="n">nml_mat_qr_new</span><span class="p">();</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">Q</span> <span class="o">=</span> <span class="n">nml_mat_cp</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">R</span> <span class="o">=</span> <span class="n">nml_mat_new</span><span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">);</span>

  <span class="kt">int</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">l2norm</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">rkj</span><span class="p">;</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">aj</span><span class="p">;</span>
  <span class="n">nml_mat</span> <span class="o">*</span><span class="n">qk</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">num_cols</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>    
    <span class="n">rkj</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
    <span class="n">aj</span> <span class="o">=</span> <span class="n">nml_mat_col_get</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
       <span class="n">rkj</span> <span class="o">=</span> <span class="n">nml_vect_dot</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span>
       <span class="n">R</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">rkj</span><span class="p">;</span>
       <span class="n">qk</span> <span class="o">=</span> <span class="n">nml_mat_col_get</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span>
       <span class="n">nml_mat_col_mult_r</span><span class="p">(</span><span class="n">qk</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rkj</span><span class="p">);</span>
       <span class="n">nml_mat_sub_r</span><span class="p">(</span><span class="n">aj</span><span class="p">,</span> <span class="n">qk</span><span class="p">);</span>
       <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">qk</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">Q</span><span class="o">-&gt;</span><span class="n">num_rows</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">Q</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">aj</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">l2norm</span> <span class="o">=</span> <span class="n">nml_mat_col_l2norm</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
    <span class="n">nml_mat_col_mult_r</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">l2norm</span><span class="p">);</span>
    <span class="n">R</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">l2norm</span><span class="p">;</span>
    <span class="n">nml_mat_free</span><span class="p">(</span><span class="n">aj</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">qr</span><span class="o">-&gt;</span><span class="n">Q</span> <span class="o">=</span> <span class="n">Q</span><span class="p">;</span>
  <span class="n">qr</span><span class="o">-&gt;</span><span class="n">R</span> <span class="o">=</span> <span class="n">R</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">qr</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div></div>

<h1 id="references">References<a class="header-link" href="https://www.andreinc.net/2021/01/20/writing-your-own-linear-algebra-matrix-library-in-c#references" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h1>

<ul>
  <li>https://stattrek.com/matrix-algebra/echelon-transform.aspx?tutorial=matrix</li>
  <li>http://lampx.tugraz.at/~hadley/num/ch2/2.3a.php</li>
  <li>https://www.youtube.com/watch?v=FAnNBw7d0vg</li>
  <li>https://en.wikipedia.org/wiki/Norm_(mathematics)</li>
  <li>https://en.wikipedia.org/wiki/Dot_product</li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-01-20T00:00:00+00:00">January 20, 2021</time></p>


      </footer>

      

      
    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Comments</h4>
      <section id="utterances-comments"><div class="utterances" style="height: 270px;">
    <iframe class="utterances-frame" title="Comments" scrolling="no" src="./Writing your own linear algebra matrix library in C _ andreinc_files/utterances.html" loading="lazy"></iframe>
  </div></section>
    
</div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    
      <li><a href="https://www.andreinc.net/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">© 2022 andreinc. Powered by <a href="https://jekyllrb.com/" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="./Writing your own linear algebra matrix library in C _ andreinc_files/main.min.js"></script>







    <script>
  'use strict';

  (function() {
    var commentContainer = document.querySelector('#utterances-comments');

    if (!commentContainer) {
      return;
    }

    var script = document.createElement('script');
    script.setAttribute('src', 'https://utteranc.es/client.js');
    script.setAttribute('repo', 'nomemory/andreinc-site');
    script.setAttribute('issue-term', 'pathname');
    script.setAttribute('theme', 'github-light');
    script.setAttribute('crossorigin', 'anonymous');

    commentContainer.appendChild(script);
  })();
</script>

  





  

</body></html>